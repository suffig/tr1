import{r as V,j as e,L as $}from"./index-CMY582Iw.js";import{u as g}from"./useSupabase-w2RECFox.js";class z{constructor(a,n,l,s){this.matches=a||[],this.players=n||[],this.bans=l||[],this.spielerDesSpiels=s||[],this.aekPlayers=(n||[]).filter(r=>r.team==="AEK"),this.realPlayers=(n||[]).filter(r=>r.team==="Real")}calculateTeamRecords(){const a={wins:0,losses:0},n={wins:0,losses:0};return this.matches.forEach(l=>{const s=l.goalsa||0,r=l.goalsb||0;s>r?(a.wins++,n.losses++):r>s&&(n.wins++,a.losses++)}),{aek:a,real:n}}calculateRecentForm(a=5){const n=this.matches.slice(-a),l=[],s=[];return n.forEach(r=>{const c=r.goalsa||0,i=r.goalsb||0;c>i?(l.push("W"),s.push("L")):i>c?(l.push("L"),s.push("W")):(l.push("D"),s.push("D"))}),{aek:l,real:s}}calculatePlayerStats(){return this.players.map(a=>{const n=this.countPlayerGoalsFromMatches(a.name,a.team),l=this.countPlayerMatches(a.name,a.team),s=this.bans.filter(i=>i.player_id===a.id),r=this.spielerDesSpiels.find(i=>i.name===a.name&&i.team===a.team),c=r&&r.count||0;return{...a,goals:n,matchesPlayed:l,sdsCount:c,goalsPerGame:l>0?(n/l).toFixed(2):"0.00",totalBans:s.length,disciplinaryScore:this.calculateDisciplinaryScore(s)}}).sort((a,n)=>(n.goals||0)-(a.goals||0))}countPlayerGoalsFromMatches(a,n){let l=0;return this.matches.forEach(s=>{n==="AEK"&&s.goalslista&&(Array.isArray(s.goalslista)?s.goalslista:typeof s.goalslista=="string"?JSON.parse(s.goalslista):[]).forEach(c=>{const i=typeof c=="string"?c:c.player,m=typeof c=="string"?1:c.count||1;i===a&&(l+=m)}),n==="Real"&&s.goalslistb&&(Array.isArray(s.goalslistb)?s.goalslistb:typeof s.goalslistb=="string"?JSON.parse(s.goalslistb):[]).forEach(c=>{const i=typeof c=="string"?c:c.player,m=typeof c=="string"?1:c.count||1;i===a&&(l+=m)})}),l}countPlayerMatches(a,n){return this.matches.length}calculateDisciplinaryScore(a){let n=0;return a.forEach(l=>{switch(l.type){case"Gelb-Rote Karte":n+=3;break;case"Rote Karte":n+=5;break;case"Verletzung":n+=1;break;default:n+=1}}),n}calculateAdvancedStats(){const a=this.matches.length,n=this.matches.reduce((l,s)=>l+(s.goalsa||0)+(s.goalsb||0),0);return{avgGoalsPerMatch:a>0?(n/a).toFixed(2):"0.00",totalMatches:a,totalGoals:n,aekTotalGoals:this.matches.reduce((l,s)=>l+(s.goalsa||0),0),realTotalGoals:this.matches.reduce((l,s)=>l+(s.goalsb||0),0),highestScoringMatch:a>0?Math.max(...this.matches.map(l=>(l.goalsa||0)+(l.goalsb||0))):0,cleanSheets:{aek:this.matches.filter(l=>l.goalsb===0).length,real:this.matches.filter(l=>l.goalsa===0).length}}}calculatePerformanceTrends(){const a={};return this.matches.forEach(n=>{const l=new Date(n.date),s=`${l.getFullYear()}-${String(l.getMonth()+1).padStart(2,"0")}`;a[s]||(a[s]={month:s,aekWins:0,realWins:0,totalGoals:0,matchCount:0});const r=n.goalsa||0,c=n.goalsb||0;a[s].totalGoals+=r+c,a[s].matchCount++,r>c?a[s].aekWins++:c>r&&a[s].realWins++}),a}}function _(){const[N,a]=V.useState("overview"),{data:n,loading:l}=g("matches","*"),{data:s,loading:r}=g("players","*"),{data:c,loading:i}=g("spieler_des_spiels","*"),{data:m,loading:G}=g("bans","*"),M=l||r||i||G,x=new z(n,s,m,c),j=x.calculateTeamRecords(),p=x.calculateRecentForm(5),v=x.calculatePlayerStats(),o=x.calculateAdvancedStats(),P=x.calculatePerformanceTrends(),h=(n==null?void 0:n.length)||0,E=(s==null?void 0:s.length)||0,y=(s==null?void 0:s.filter(t=>t.team==="AEK"))||[],S=(s==null?void 0:s.filter(t=>t.team==="Real"))||[],w=y.reduce((t,d)=>t+(d.value||0),0),k=S.reduce((t,d)=>t+(d.value||0),0),F=w+k,u=j.aek.wins,b=j.real.wins,T=t=>t.map((d,D)=>e.jsx("span",{className:`inline-block w-6 h-6 text-xs font-bold rounded-full text-center leading-6 mx-0.5 ${d==="W"?"bg-green-500 text-white":d==="L"?"bg-red-500 text-white":"bg-gray-400 text-white"}`,children:d},D)),f=t=>`${(t/1e6).toFixed(1)}M â‚¬`,R=[{id:"overview",label:"Ãœbersicht",icon:"ðŸ“Š"},{id:"players",label:"Spieler",icon:"ðŸ‘¥"},{id:"teams",label:"Teams",icon:"ðŸ†"},{id:"trends",label:"Trends",icon:"ðŸ“ˆ"}];if(M)return e.jsx($,{message:"Lade Statistiken..."});const A=()=>e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[e.jsxs("div",{className:"modern-card text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-primary",children:h}),e.jsx("div",{className:"text-sm text-text-muted",children:"Spiele"})]}),e.jsxs("div",{className:"modern-card text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-primary",children:o.totalGoals}),e.jsx("div",{className:"text-sm text-text-muted",children:"Tore"})]}),e.jsxs("div",{className:"modern-card text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-primary",children:E}),e.jsx("div",{className:"text-sm text-text-muted",children:"Spieler"})]}),e.jsxs("div",{className:"modern-card text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-primary",children:o.avgGoalsPerMatch}),e.jsx("div",{className:"text-sm text-text-muted",children:"âŒ€ Tore/Spiel"})]})]}),e.jsxs("div",{className:"grid md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"modern-card border-l-4 border-blue-400",children:[e.jsx("h3",{className:"font-bold text-lg mb-4 text-blue-600",children:"AEK Athen"}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Siege:"}),e.jsx("span",{className:"font-semibold text-green-600",children:u})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Niederlagen:"}),e.jsx("span",{className:"font-semibold text-red-600",children:j.aek.losses})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Marktwert:"}),e.jsx("span",{className:"font-semibold",children:f(w)})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Zu Null:"}),e.jsx("span",{className:"font-semibold",children:o.cleanSheets.aek})]}),e.jsxs("div",{className:"mt-3",children:[e.jsx("div",{className:"text-sm text-text-muted mb-1",children:"Form (letzte 5):"}),e.jsx("div",{className:"flex",children:T(p.aek)})]})]})]}),e.jsxs("div",{className:"modern-card border-l-4 border-red-400",children:[e.jsx("h3",{className:"font-bold text-lg mb-4 text-red-600",children:"Real Madrid"}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Siege:"}),e.jsx("span",{className:"font-semibold text-green-600",children:b})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Niederlagen:"}),e.jsx("span",{className:"font-semibold text-red-600",children:j.real.losses})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Marktwert:"}),e.jsx("span",{className:"font-semibold",children:f(k)})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Zu Null:"}),e.jsx("span",{className:"font-semibold",children:o.cleanSheets.real})]}),e.jsxs("div",{className:"mt-3",children:[e.jsx("div",{className:"text-sm text-text-muted mb-1",children:"Form (letzte 5):"}),e.jsx("div",{className:"flex",children:T(p.real)})]})]})]})]}),e.jsxs("div",{className:"modern-card",children:[e.jsx("h3",{className:"font-bold text-lg mb-4",children:"ðŸ† Top-TorschÃ¼tzen"}),e.jsx("div",{className:"space-y-2",children:v.slice(0,5).map((t,d)=>e.jsxs("div",{className:"flex items-center justify-between py-2 border-b border-border-light last:border-b-0",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("span",{className:`w-6 h-6 rounded-full flex items-center justify-center text-xs font-bold ${d===0?"bg-yellow-500 text-white":d===1?"bg-gray-400 text-white":d===2?"bg-orange-600 text-white":"bg-gray-200 text-gray-600"}`,children:d+1}),e.jsxs("div",{children:[e.jsx("div",{className:"font-medium",children:t.name}),e.jsx("div",{className:"text-sm text-text-muted",children:t.team})]})]}),e.jsxs("div",{className:"text-right",children:[e.jsxs("div",{className:"font-bold",children:[t.goals," Tore"]}),e.jsxs("div",{className:"text-sm text-text-muted",children:[t.goalsPerGame," âŒ€"]})]})]},t.id))})]})]}),C=()=>e.jsxs("div",{className:"modern-card",children:[e.jsx("h3",{className:"font-bold text-lg mb-4",children:"ðŸ“Š Spielerstatistiken"}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full text-sm",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"border-b border-border-light",children:[e.jsx("th",{className:"text-left py-2",children:"Spieler"}),e.jsx("th",{className:"text-left py-2",children:"Team"}),e.jsx("th",{className:"text-center py-2",children:"Tore"}),e.jsx("th",{className:"text-center py-2",children:"âŒ€/Spiel"}),e.jsx("th",{className:"text-center py-2",children:"SdS"}),e.jsx("th",{className:"text-center py-2",children:"Sperren"}),e.jsx("th",{className:"text-right py-2",children:"Marktwert"})]})}),e.jsx("tbody",{children:v.map((t,d)=>e.jsxs("tr",{className:"border-b border-border-light hover:bg-bg-secondary",children:[e.jsx("td",{className:"py-2 font-medium",children:t.name}),e.jsx("td",{className:"py-2",children:e.jsx("span",{className:`px-2 py-1 rounded text-xs font-medium ${t.team==="AEK"?"bg-blue-100 text-blue-800":"bg-red-100 text-red-800"}`,children:t.team})}),e.jsx("td",{className:"py-2 text-center font-bold",children:t.goals}),e.jsx("td",{className:"py-2 text-center",children:t.goalsPerGame}),e.jsx("td",{className:"py-2 text-center",children:t.sdsCount}),e.jsx("td",{className:"py-2 text-center",children:t.totalBans}),e.jsx("td",{className:"py-2 text-right",children:f(t.value)})]},t.id))})]})})]}),W=()=>e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"modern-card",children:[e.jsx("h3",{className:"font-bold text-lg mb-4",children:"âš–ï¸ Team-Vergleich"}),e.jsxs("div",{className:"grid md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"space-y-3",children:[e.jsx("h4",{className:"font-semibold text-blue-600",children:"AEK Athen"}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Spieler:"}),e.jsx("span",{className:"font-medium",children:y.length})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Tore gesamt:"}),e.jsx("span",{className:"font-medium",children:o.aekTotalGoals})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Siege:"}),e.jsx("span",{className:"font-medium",children:u})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Siegquote:"}),e.jsxs("span",{className:"font-medium",children:[h>0?(u/h*100).toFixed(1):0,"%"]})]})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("h4",{className:"font-semibold text-red-600",children:"Real Madrid"}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Spieler:"}),e.jsx("span",{className:"font-medium",children:S.length})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Tore gesamt:"}),e.jsx("span",{className:"font-medium",children:o.realTotalGoals})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Siege:"}),e.jsx("span",{className:"font-medium",children:b})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Siegquote:"}),e.jsxs("span",{className:"font-medium",children:[h>0?(b/h*100).toFixed(1):0,"%"]})]})]})]})]})]}),e.jsxs("div",{className:"modern-card",children:[e.jsx("h3",{className:"font-bold text-lg mb-4",children:"ðŸ“ˆ Erweiterte Statistiken"}),e.jsxs("div",{className:"grid md:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"text-center p-4 bg-bg-secondary rounded-lg",children:[e.jsx("div",{className:"text-2xl font-bold text-primary",children:o.highestScoringMatch}),e.jsx("div",{className:"text-sm text-text-muted",children:"Tore in einem Spiel"})]}),e.jsxs("div",{className:"text-center p-4 bg-bg-secondary rounded-lg",children:[e.jsx("div",{className:"text-2xl font-bold text-primary",children:f(F)}),e.jsx("div",{className:"text-sm text-text-muted",children:"Gesamtmarktwert"})]}),e.jsxs("div",{className:"text-center p-4 bg-bg-secondary rounded-lg",children:[e.jsx("div",{className:"text-2xl font-bold text-primary",children:Math.abs(u-b)}),e.jsx("div",{className:"text-sm text-text-muted",children:"Siegesdifferenz"})]})]})]})]}),K=()=>e.jsxs("div",{className:"modern-card",children:[e.jsx("h3",{className:"font-bold text-lg mb-4",children:"ðŸ“ˆ Performance-Trends"}),e.jsx("div",{className:"space-y-4",children:Object.values(P).reverse().map(t=>e.jsxs("div",{className:"flex items-center justify-between py-3 border-b border-border-light last:border-b-0",children:[e.jsx("div",{className:"font-medium",children:t.month}),e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsxs("div",{className:"text-sm",children:[e.jsxs("span",{className:"text-blue-600 font-medium",children:["AEK: ",t.aekWins]}),e.jsx("span",{className:"mx-2",children:"vs"}),e.jsxs("span",{className:"text-red-600 font-medium",children:["Real: ",t.realWins]})]}),e.jsxs("div",{className:"text-sm text-text-muted",children:[t.matchCount," Spiele, ",t.totalGoals," Tore"]}),e.jsxs("div",{className:"text-sm font-medium",children:["âŒ€ ",(t.totalGoals/t.matchCount).toFixed(1)," Tore/Spiel"]})]})]},t.month))})]}),L=()=>{switch(N){case"players":return C();case"teams":return W();case"trends":return K();default:return A()}};return e.jsxs("div",{className:"p-4 pb-20",children:[e.jsxs("div",{className:"mb-6",children:[e.jsx("h2",{className:"text-2xl font-bold text-text-primary mb-2",children:"ðŸ“Š Statistiken"}),e.jsx("p",{className:"text-text-muted",children:"Umfassende Analyse von Spielen, Spielern und Teams"})]}),e.jsx("div",{className:"flex overflow-x-auto space-x-2 mb-6 pb-2",children:R.map(t=>e.jsxs("button",{onClick:()=>a(t.id),className:`flex items-center space-x-2 px-4 py-2 rounded-lg whitespace-nowrap transition-colors ${N===t.id?"bg-primary text-white":"bg-bg-secondary text-text-muted hover:bg-bg-tertiary"}`,children:[e.jsx("span",{children:t.icon}),e.jsx("span",{className:"font-medium",children:t.label})]},t.id))}),L()]})}export{_ as default};
