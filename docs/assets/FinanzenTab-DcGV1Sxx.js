import{r as w,j as e,L as F}from"./index-3EBv8MB_.js";import{u as g}from"./useSupabase-BruVFaHn.js";function G(){const[i,k]=w.useState("AEK"),[p,S]=w.useState(new Set),{data:j,loading:T}=g("finances","*"),{data:c,loading:E}=g("transactions","*",{order:{column:"id",ascending:!1}}),{data:f,loading:A}=g("matches","*",{order:{column:"id",ascending:!1}}),K=T||E||A,m=s=>j?j.find(t=>t.team===s)||{balance:0,debt:0}:{balance:0,debt:0},M=s=>c?c.filter(t=>t.team===s):[],r=s=>new Intl.NumberFormat("de-DE",{style:"currency",currency:"EUR"}).format(s),N=s=>{switch(s){case"Preisgeld":case"SdS Bonus":case"Sonstiges":return"text-primary-green";case"Strafe":case"Spielerkauf":return"text-accent-red";case"Spielerverkauf":return"text-primary-green";default:return"text-text-primary"}},v=s=>{switch(s){case"Preisgeld":return"🏆";case"Sonstiges":return"📈";case"Strafe":return"📉";case"Spielerkauf":return"👤";case"Spielerverkauf":return"💰";case"SdS Bonus":return"⭐";case"Echtgeld-Ausgleich":return"💳";default:return"💰"}},D=s=>{const t=[{container:"border-blue-400 bg-blue-50 dark:bg-blue-700",header:"text-blue-800 dark:text-blue-100",accent:"blue-500"},{container:"border-green-600 bg-green-100 dark:bg-green-600",header:"text-green-800 dark:text-green-300",accent:"green-600"},{container:"border-red-500 bg-red-50 dark:bg-red-500",header:"text-red-800 dark:text-red-100",accent:"red-500"},{container:"border-purple-500 bg-purple-100 dark:bg-purple-500",header:"text-purple-700 dark:text-purple-100",accent:"purple-500"},{container:"border-yellow-400 bg-yellow-100 dark:bg-yellow-900",header:"text-yellow-800 dark:text-yellow-300",accent:"yellow-400"}],d=(s-1)%t.length;return t[d]},$=s=>{const t=new Set(p);t.has(s)?t.delete(s):t.add(s),S(t)},z=()=>{if(!c||!f)return{matchGroups:[],nonMatchTransactions:[]};const s=[...f].sort((a,l)=>new Date(l.date)-new Date(a.date)),t=[],d=[],b=new Set(s.map(a=>a.id));for(const a of s){const l=c.filter(n=>n.match_id===a.id);l.length&&t.push({match:a,transactions:l})}return c.forEach(a=>{(!a.match_id||!b.has(a.match_id))&&d.push(a)}),{matchGroups:t,nonMatchTransactions:d}};if(K)return e.jsx(F,{message:"Lade Finanzen..."});const o=m("AEK"),h=m("Real"),L=o.balance+h.balance,C=m(i),y=M(i),{matchGroups:u,nonMatchTransactions:x}=z();return e.jsxs("div",{className:"p-4 pb-20",children:[e.jsxs("div",{className:"mb-6",children:[e.jsx("h2",{className:"text-xl font-semibold text-text-primary mb-2",children:"Finanzen"}),e.jsx("p",{className:"text-text-muted",children:"Team-Budgets und Transaktionsübersicht"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-6",children:[e.jsxs("div",{className:"modern-card text-center border-l-4 border-blue-400",children:[e.jsxs("div",{className:"flex items-center justify-center mb-2",children:[e.jsx("span",{className:"text-2xl mr-2",children:"🔵"}),e.jsx("h3",{className:"font-semibold text-blue-600",children:"AEK Athen"})]}),e.jsxs("div",{className:"space-y-1 text-sm",children:[e.jsxs("div",{children:["Kontostand: ",e.jsx("span",{className:"font-bold text-blue-600",children:r(o.balance)})]}),e.jsxs("div",{children:["Schulden: ",e.jsx("span",{className:"font-bold text-blue-600",children:r(o.debt||0)})]})]})]}),e.jsxs("div",{className:"modern-card text-center border-l-4 border-red-400",children:[e.jsxs("div",{className:"flex items-center justify-center mb-2",children:[e.jsx("span",{className:"text-2xl mr-2",children:"🔴"}),e.jsx("h3",{className:"font-semibold text-red-600",children:"Real Madrid"})]}),e.jsxs("div",{className:"space-y-1 text-sm",children:[e.jsxs("div",{children:["Kontostand: ",e.jsx("span",{className:"font-bold text-red-600",children:r(h.balance)})]}),e.jsxs("div",{children:["Schulden: ",e.jsx("span",{className:"font-bold text-red-600",children:r(h.debt||0)})]})]})]}),e.jsxs("div",{className:"modern-card text-center border-l-4 border-primary-green",children:[e.jsxs("div",{className:"flex items-center justify-center mb-2",children:[e.jsx("span",{className:"text-2xl mr-2",children:"💰"}),e.jsx("h3",{className:"font-semibold text-primary-green",children:"Gesamt"})]}),e.jsx("div",{className:"text-2xl font-bold text-text-primary",children:r(L)}),e.jsx("div",{className:"text-sm text-text-muted",children:"Gesamtkapital"})]})]}),e.jsxs("div",{className:"mb-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-text-primary mb-4",children:"Match-Transaktionen"}),u.length>0?e.jsx("div",{className:"space-y-3",children:u.map(({match:s,transactions:t},d)=>{const b=u.length-d,a=D(b),l=p.has(s.id);return e.jsxs("div",{className:`border-2 ${a.container} rounded-lg shadow-lg`,children:[e.jsxs("button",{onClick:()=>$(s.id),className:"w-full p-3 flex items-center justify-between cursor-pointer hover:bg-opacity-80 transition-all duration-200 rounded-t-lg",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:`w-3 h-3 bg-${a.accent} rounded-full mr-2 flex-shrink-0`}),e.jsxs("div",{className:"text-left",children:[e.jsxs("div",{className:`text-lg font-extrabold ${a.header}`,children:["AEK ",s.goalsa||0,":",s.goalsb||0," Real"]}),e.jsx("div",{className:`text-xs font-normal opacity-90 ${a.header}`,children:new Date(s.date).toLocaleDateString("de-DE")})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("div",{className:`text-xs bg-${a.accent} text-white px-2 py-1 rounded-full font-semibold`,children:[t.length," Transaktion",t.length!==1?"en":""]}),e.jsx("span",{className:`text-lg font-bold ${a.header} transition-transform duration-200 ${l?"rotate-90":""}`,children:"▶"})]})]}),!l&&e.jsx("div",{className:"p-3 pt-0",children:e.jsx("div",{className:"space-y-2",children:t.map(n=>e.jsx("div",{className:"bg-white bg-opacity-50 rounded-lg p-3 border border-white border-opacity-30",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex items-start space-x-3",children:[e.jsx("div",{className:"text-xl",children:v(n.type)}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center space-x-2 mb-1",children:[e.jsx("h5",{className:"font-medium text-text-primary",children:n.info||"Transaktion"}),e.jsx("span",{className:`text-sm font-medium ${n.amount>0?"text-primary-green":"text-accent-red"}`,children:n.type})]}),e.jsxs("div",{className:"flex items-center space-x-2 text-xs text-text-muted",children:[e.jsxs("span",{className:n.team==="AEK"?"text-blue-600":"text-red-600",children:[n.team==="AEK"?"🔵":"🔴"," ",n.team]}),n.date&&e.jsx("span",{children:new Date(n.date).toLocaleDateString("de-DE")})]})]})]}),e.jsx("div",{className:"text-right",children:e.jsxs("div",{className:`text-lg font-bold ${N(n.type)}`,children:[n.amount<0?"-":"+",r(Math.abs(n.amount||0))]})})]})},n.id))})})]},s.id)})}):e.jsxs("div",{className:"modern-card text-center py-8",children:[e.jsx("div",{className:"text-4xl mb-4",children:"⚽"}),e.jsx("h4",{className:"text-lg font-medium text-text-primary mb-2",children:"Keine Match-Transaktionen"}),e.jsx("p",{className:"text-text-muted",children:"Es wurden noch keine match-bezogenen Transaktionen erfasst."})]})]}),x.length>0&&e.jsxs("div",{className:"mb-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-text-primary mb-4",children:"Sonstige Transaktionen"}),e.jsxs("div",{className:"border-2 border-slate-500 bg-slate-100 rounded-lg shadow-lg",children:[e.jsx("div",{className:"p-3 border-b border-slate-300",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"w-3 h-3 bg-slate-400 rounded-full mr-2 flex-shrink-0"}),e.jsxs("div",{children:[e.jsx("div",{className:"text-lg font-extrabold text-slate-700",children:"Sonstige Transaktionen"}),e.jsx("div",{className:"text-xs font-normal opacity-90 text-slate-600",children:"Nicht match-bezogene Buchungen"})]})]}),e.jsxs("div",{className:"text-xs bg-slate-400 text-slate-900 px-2 py-1 rounded-full font-semibold",children:[x.length," Buchung",x.length!==1?"en":""]})]})}),e.jsx("div",{className:"p-3",children:e.jsx("div",{className:"space-y-2",children:x.map(s=>e.jsx("div",{className:"bg-white rounded-lg p-3 border border-slate-200",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex items-start space-x-3",children:[e.jsx("div",{className:"text-xl",children:v(s.type)}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center space-x-2 mb-1",children:[e.jsx("h5",{className:"font-medium text-text-primary",children:s.info||"Transaktion"}),e.jsx("span",{className:`text-sm font-medium ${s.amount>0?"text-primary-green":"text-accent-red"}`,children:s.type})]}),e.jsxs("div",{className:"flex items-center space-x-2 text-xs text-text-muted",children:[e.jsxs("span",{className:s.team==="AEK"?"text-blue-600":"text-red-600",children:[s.team==="AEK"?"🔵":"🔴"," ",s.team]}),s.date&&e.jsx("span",{children:new Date(s.date).toLocaleDateString("de-DE")})]})]})]}),e.jsx("div",{className:"text-right",children:e.jsxs("div",{className:`text-lg font-bold ${N(s.type)}`,children:[s.amount<0?"-":"+",r(Math.abs(s.amount||0))]})})]})},s.id))})})]})]}),e.jsxs("div",{className:"mb-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-text-primary mb-3",children:"Team-spezifische Ansicht"}),e.jsx("div",{className:"flex gap-2 mb-4",children:["AEK","Real"].map(s=>e.jsx("button",{onClick:()=>k(s),className:`px-4 py-2 rounded-lg font-medium transition-all ${i===s?s==="AEK"?"bg-blue-600 text-white":"bg-red-600 text-white":"bg-bg-secondary text-text-muted hover:bg-bg-tertiary border border-border-light"}`,children:s==="AEK"?"🔵 AEK Athen":"🔴 Real Madrid"},s))})]}),e.jsxs("div",{className:"modern-card mb-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("h4",{className:"font-semibold text-text-primary",children:[i==="AEK"?"🔵 AEK Athen":"🔴 Real Madrid"," - Details"]}),e.jsxs("div",{className:"text-right",children:[e.jsx("div",{className:"text-lg font-bold text-text-primary",children:r(C.balance)}),e.jsx("div",{className:"text-sm text-text-muted",children:"Aktueller Kontostand"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"text-center p-3 bg-primary-green/10 rounded-lg",children:[e.jsx("div",{className:"text-lg font-bold text-primary-green",children:y.filter(s=>s.amount>0).length}),e.jsx("div",{className:"text-sm text-text-muted",children:"Einnahmen"})]}),e.jsxs("div",{className:"text-center p-3 bg-accent-red/10 rounded-lg",children:[e.jsx("div",{className:"text-lg font-bold text-accent-red",children:y.filter(s=>s.amount<0).length}),e.jsx("div",{className:"text-sm text-text-muted",children:"Ausgaben"})]})]})]}),e.jsx("div",{className:"mt-6 modern-card bg-blue-50 border-blue-200",children:e.jsxs("div",{className:"flex items-start",children:[e.jsx("div",{className:"text-blue-600 mr-3",children:e.jsx("i",{className:"fas fa-info-circle"})}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold text-blue-800 mb-1",children:"Hinweis"}),e.jsx("p",{className:"text-blue-700 text-sm",children:"Um neue Transaktionen hinzuzufügen, nutzen Sie den Verwaltungsbereich."})]})]})})]})}export{G as default};
