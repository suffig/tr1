const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/matches-Bz0wv9ua.js","assets/dataManager-B859Fmxm.js"])))=>i.map(i=>d[i]);
import{s as C,u as F,r as M,j as e,z as R,a as H,L as ee,_ as re}from"./index-C_aIP5qB.js";import{B as q}from"./banTypes-DuNOJEIt.js";class U{static async submitMatch(i){const{date:l,teama:s="AEK",teamb:r="Real",goalsa:o,goalsb:h,goalslista:N=[],goalslistb:w=[],ownGoalsA:x=0,ownGoalsB:c=0,yellowa:y=0,reda:T=0,yellowb:A=0,redb:d=0,manofthematch:S,editId:k=null}=i;try{const{prizeaek:$,prizereal:p,winner:t,loser:u}=this.calculatePrizeMoney(o,h,y,T,A,d);k&&await this.deleteMatchTransactions(k);const a=[...N],m=[...w];x>0&&m.push({count:x,player:"Eigentore_AEK"}),c>0&&a.push({count:c,player:"Eigentore_Real"});const v={date:l,teama:s,teamb:r,goalsa:parseInt(o)||0,goalsb:parseInt(h)||0,goalslista:N,goalslistb:w,yellowa:parseInt(y)||0,reda:parseInt(T)||0,yellowb:parseInt(A)||0,redb:parseInt(d)||0,manofthematch:S||null,prizeaek:$,prizereal:p},E=await C.insert("matches",v);if(E.error)throw new Error(`Match insert failed: ${E.error.message}`);const D=E.data.id,z=new Date().toISOString().slice(0,10);if(a.length>0){const _=a.filter(B=>typeof B=="object"&&B.player?!B.player.startsWith("Eigentore_"):!B.startsWith("Eigentore_"));await this.updatePlayersGoals(_,"AEK")}if(m.length>0){const _=m.filter(B=>typeof B=="object"&&B.player?!B.player.startsWith("Eigentore_"):!B.startsWith("Eigentore_"));await this.updatePlayersGoals(_,"Real")}return S&&await this.updatePlayerOfTheMatchStats(S),await this.processFinancialTransactions({matchId:D,date:z,prizeaek:$,prizereal:p,manofthematch:S,winner:t,loser:u}),await this.decrementBansAfterMatch(),{success:!0,matchId:D,message:`Match ${s} vs ${r} (${o}:${h}) erfolgreich hinzugefügt`}}catch($){throw console.error("Error in submitMatch:",$),new Error(`Fehler beim Speichern des Matches: ${$.message}`)}}static calculatePrizeMoney(i,l,s,r,o,h){let N=0,w=0,x=null,c=null;return i>l?(x="AEK",c="Real"):i<l&&(x="Real",c="AEK"),x&&c&&(x==="AEK"?(N=1e6-l*5e4-s*2e4-r*5e4,w=-(5e5+i*5e4+o*2e4+h*5e4)):(w=1e6-i*5e4-o*2e4-h*5e4,N=-(5e5+l*5e4+s*2e4+r*5e4))),{prizeaek:N,prizereal:w,winner:x,loser:c}}static async updatePlayersGoals(i,l){const s={};if(i.length>0&&typeof i[0]=="object"&&i[0].player!==void 0)i.forEach(r=>{r.player&&!r.player.startsWith("Eigentore_")&&(s[r.player]=(s[r.player]||0)+(r.count||1))});else for(const r of i)!r||!r.trim()||r.startsWith("Eigentore_")||(s[r]=(s[r]||0)+1);for(const[r,o]of Object.entries(s))try{const h=await C.select("players","id, goals",{eq:{name:r,team:l}});if(h.data&&h.data.length>0){const N=h.data[0],w=(N.goals||0)+o;await C.update("players",{goals:w},N.id)}}catch(h){console.warn(`Failed to update goals for player ${r}:`,h)}}static async updatePlayerOfTheMatchStats(i){try{const l=await C.select("players","team",{eq:{name:i}});if(!l.data||l.data.length===0){console.warn(`Player ${i} not found for SdS stats`);return}const s=l.data[0].team,r=await C.select("spieler_des_spiels","*",{eq:{name:i,team:s}});if(r.data&&r.data.length>0){const o=r.data[0];await C.update("spieler_des_spiels",{count:o.count+1},o.id)}else await C.insert("spieler_des_spiels",{name:i,team:s,count:1})}catch(l){console.warn(`Failed to update SdS stats for ${i}:`,l)}}static async processFinancialTransactions({matchId:i,date:l,prizeaek:s,prizereal:r,manofthematch:o,winner:h,loser:N}){const w=await this.getTeamFinance("AEK"),x=await this.getTeamFinance("Real");let c=w.balance||0,y=x.balance||0;const T=o?await this.getSdSBonus(o,"AEK"):0,A=o?await this.getSdSBonus(o,"Real"):0;T>0&&(c+=T,await this.insertTransaction({date:l,type:"SdS Bonus",team:"AEK",amount:T,match_id:i,info:"SdS Bonus"}),await this.updateTeamBalance("AEK",c)),A>0&&(y+=A,await this.insertTransaction({date:l,type:"SdS Bonus",team:"Real",amount:A,match_id:i,info:"SdS Bonus"}),await this.updateTeamBalance("Real",y)),s!==0&&(c+=s,c<0&&(c=0),await this.insertTransaction({date:l,type:"Preisgeld",team:"AEK",amount:s,match_id:i,info:"Preisgeld"}),await this.updateTeamBalance("AEK",c)),r!==0&&(y+=r,y<0&&(y=0),await this.insertTransaction({date:l,type:"Preisgeld",team:"Real",amount:r,match_id:i,info:"Preisgeld"}),await this.updateTeamBalance("Real",y)),h&&N&&await this.processEchtgeldAusgleich({date:l,matchId:i,winner:h,loser:N,aekBalance:c,realBalance:y,prizeaek:s,prizereal:r,sdsBonusAek:T>0?1:0,sdsBonusReal:A>0?1:0,manofthematch:o})}static async getTeamFinance(i){const l=await C.select("finances","*",{eq:{team:i}});return l.data&&l.data.length>0?l.data[0]:{balance:0,debt:0}}static async getSdSBonus(i,l){const s=await C.select("players","team",{eq:{name:i}});return s.data&&s.data.length>0&&s.data[0].team===l?1e5:0}static async insertTransaction(i){return await C.insert("transactions",i)}static async updateTeamBalance(i,l){const s=await C.select("finances","id",{eq:{team:i}});return s.data&&s.data.length>0?await C.update("finances",{balance:l},s.data[0].id):await C.insert("finances",{team:i,balance:l,debt:0})}static async processEchtgeldAusgleich({date:i,matchId:l,winner:s,loser:r,aekBalance:o,realBalance:h,prizeaek:N,prizereal:w,sdsBonusAek:x,sdsBonusReal:c,manofthematch:y}){const T=await this.getTeamFinance("AEK"),A=await this.getTeamFinance("Real"),d={AEK:T.debt||0,Real:A.debt||0},S=(z,_,B)=>{let P=z;B&&(P+=1e5);let O=(Math.abs(_)-P)/1e5;return O<0&&(O=0),5+Math.round(O)},k=S(o,N,x),$=S(h,w,c),p=r==="AEK"?k:$,t=d[s],u=d[r],a=Math.min(t,p*1),m=Math.max(0,t-a),v=p*1-a,E=u+Math.max(0,v),D=await C.select("finances","id",{eq:{team:s}});if(D.data&&D.data.length>0&&await C.update("finances",{debt:m},D.data[0].id),v>0){await this.insertTransaction({date:i,type:"Echtgeld-Ausgleich",team:r,amount:Math.max(0,v),match_id:l,info:"Echtgeld-Ausgleich"});const z=await C.select("finances","id",{eq:{team:r}});z.data&&z.data.length>0&&await C.update("finances",{debt:E},z.data[0].id)}a>0&&await this.insertTransaction({date:i,type:"Echtgeld-Ausgleich (getilgt)",team:s,amount:-a,match_id:l,info:"Echtgeld-Ausgleich (getilgt)"})}static async deleteMatchTransactions(i){const l=await C.select("transactions","*",{eq:{match_id:i}});if(l.data)for(const s of l.data)await C.delete("transactions",s.id);await C.delete("matches",i)}static async decrementBansAfterMatch(){try{const i=await C.select("bans","*");if(!i.data)return;for(const l of i.data)if(l.matchesserved<l.totalgames){const s=l.matchesserved+1;await C.update("bans",{matchesserved:s},l.id)}}catch(i){console.warn("Failed to decrement bans:",i)}}}function ne(){const{data:f}=F("players","*"),[i,l]=M.useState(!1),[s,r]=M.useState({teama:"AEK",teamb:"Real",date:new Date().toISOString().split("T")[0],goalsa:0,goalsb:0,goalslista:[],goalslistb:[],ownGoalsA:0,ownGoalsB:0,yellowa:0,reda:0,yellowb:0,redb:0,prizeaek:0,prizereal:0,manofthematch:"",motmTeamFilter:"all"}),[o,h]=M.useState(!1),N=(t,u,a)=>t.reduce((v,E)=>v+E.count,0)+a,w=t=>{r(u=>{const a={...u,...t};a.goalsa=N(a.goalslista,a.ownGoalsA,a.ownGoalsB),a.goalsb=N(a.goalslistb,a.ownGoalsB,a.ownGoalsA);const{prizeaek:m,prizereal:v}=U.calculatePrizeMoney(a.goalsa,a.goalsb,a.yellowa,a.reda,a.yellowb,a.redb);return a.prizeaek=m,a.prizereal=v,a})},x=(t,u)=>{w({[t]:u})},c=async t=>{t.preventDefault(),h(!0);try{const u=await U.submitMatch({date:s.date,teama:s.teama.trim(),teamb:s.teamb.trim(),goalsa:s.goalsa,goalsb:s.goalsb,goalslista:s.goalslista,goalslistb:s.goalslistb,ownGoalsA:s.ownGoalsA,ownGoalsB:s.ownGoalsB,yellowa:parseInt(s.yellowa)||0,reda:parseInt(s.reda)||0,yellowb:parseInt(s.yellowb)||0,redb:parseInt(s.redb)||0,manofthematch:s.manofthematch||null});r({teama:"AEK",teamb:"Real",date:new Date().toISOString().split("T")[0],goalsa:0,goalsb:0,goalslista:[],goalslistb:[],ownGoalsA:0,ownGoalsB:0,yellowa:0,reda:0,yellowb:0,redb:0,prizeaek:0,prizereal:0,manofthematch:"",motmTeamFilter:"all"}),l(!1),R.success(u.message)}catch(u){console.error("Match submission error:",u),R.error(u.message||"Fehler beim Hinzufügen des Spiels")}finally{h(!1)}},y=()=>!(!s.date||s.goalsa===s.goalsb||!s.manofthematch||s.manofthematch.trim()===""),T=t=>f?f.filter(u=>u.team===t):[],A=()=>f?s.motmTeamFilter==="all"?f:f.filter(t=>t.team===s.motmTeamFilter):[],d=(t,u)=>{const a=t==="AEK"?"goalslista":"goalslistb";w({[a]:s[a].map(m=>m.player===u?{...m,count:m.count+1}:m).concat(s[a].find(m=>m.player===u)?[]:[{player:u,count:1}])})},S=(t,u)=>{const a=t==="AEK"?"goalslista":"goalslistb";w({[a]:s[a].map(m=>m.player===u?{...m,count:Math.max(0,m.count-1)}:m).filter(m=>m.count>0)})},k=(t,u)=>{const a=t==="AEK"?"ownGoalsA":"ownGoalsB",m=Math.max(0,s[a]+u);w({[a]:m})},$=(t,u)=>{if(!u)return;const a=t==="AEK"?"goalslista":"goalslistb",m=s[a].find(v=>v.player===u);w(m?{[a]:s[a].map(v=>v.player===u?{...v,count:v.count+1}:v)}:{[a]:[...s[a],{player:u,count:1}]})},p=(t,u)=>{const a=t==="AEK"?"goalslista":"goalslistb";w({[a]:s[a].filter(m=>m.player!==u)})};return e.jsxs("div",{className:"p-4",children:[e.jsxs("div",{className:"mb-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-text-primary mb-2",children:"Neues Spiel hinzufügen"}),e.jsx("p",{className:"text-text-muted text-sm",children:"Fügen Sie ein neues Spiel zur Datenbank hinzu."})]}),e.jsx("div",{className:"modern-card",children:e.jsxs("div",{className:"text-center py-8",children:[e.jsx("div",{className:"text-4xl mb-4",children:"⚽"}),e.jsx("h4",{className:"text-lg font-medium text-text-primary mb-2",children:"Spiel hinzufügen"}),e.jsx("p",{className:"text-text-muted mb-6",children:"Klicken Sie auf den Button, um ein neues Spiel zu erfassen."}),e.jsxs("button",{onClick:()=>l(!0),className:"btn-primary",children:[e.jsx("i",{className:"fas fa-plus mr-2"}),"Neues Spiel erfassen"]})]})}),i&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-[60] p-2 sm:p-4",children:e.jsx("div",{className:"bg-bg-secondary rounded-lg w-full max-w-lg modal-content",children:e.jsxs("div",{className:"p-4 sm:p-6",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsx("h3",{className:"text-xl font-semibold text-text-primary",children:"Neues Spiel"}),e.jsx("button",{onClick:()=>l(!1),className:"text-text-muted hover:text-text-primary text-2xl",disabled:o,children:"×"})]}),e.jsxs("form",{onSubmit:c,className:"space-y-4",children:[e.jsx("div",{className:"bg-gray-50 rounded-lg p-4 border",children:e.jsxs("div",{className:"text-center",children:[e.jsx("h4",{className:"text-lg font-semibold text-gray-700 mb-2",children:"⚽ Spielpaarung"}),e.jsxs("div",{className:"flex items-center justify-center space-x-4",children:[e.jsx("div",{className:"bg-blue-100 text-blue-800 px-4 py-2 rounded-lg font-medium",children:"AEK Athen"}),e.jsx("div",{className:"text-gray-500 font-bold text-xl",children:"vs"}),e.jsx("div",{className:"bg-red-100 text-red-800 px-4 py-2 rounded-lg font-medium",children:"Real Madrid"})]})]})}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text-primary mb-2",children:"Datum *"}),e.jsx("input",{type:"date",value:s.date,onChange:t=>x("date",t.target.value),className:"form-input",required:!0,disabled:o})]}),e.jsxs("div",{className:"border-t pt-4",children:[e.jsx("h4",{className:"text-sm font-medium text-text-primary mb-3",children:"⚽ Live Torwertung"}),e.jsxs("div",{className:"bg-gray-50 rounded-lg p-4 mb-4 text-center",children:[e.jsxs("div",{className:"text-2xl font-bold text-gray-700",children:[s.goalsa," : ",s.goalsb]}),e.jsxs("div",{className:"text-sm text-gray-500 mt-1",children:["AEK Athen ",s.goalsa," - ",s.goalsb," Real Madrid"]})]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4 sm:gap-6",children:[e.jsxs("div",{className:"space-y-3",children:[e.jsx("div",{className:"text-center",children:e.jsx("h5",{className:"text-sm font-medium text-blue-600 mb-3",children:"⚽ AEK Athen Torschützen"})}),e.jsx("div",{className:"space-y-2",children:s.goalslista.map((t,u)=>e.jsxs("div",{className:"flex items-center justify-between bg-blue-50 rounded-lg p-2",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"text-sm font-medium text-gray-700",children:t.player}),e.jsxs("div",{className:"text-xs text-gray-500",children:[t.count," Tor",t.count!==1?"e":""]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("button",{type:"button",onClick:()=>S("AEK",t.player),className:"w-8 h-8 bg-red-500 hover:bg-red-600 text-white rounded-full flex items-center justify-center text-sm font-bold transition-colors",disabled:o,children:"−"}),e.jsx("span",{className:"w-8 text-center font-bold text-lg text-gray-700",children:t.count}),e.jsx("button",{type:"button",onClick:()=>d("AEK",t.player),className:"w-8 h-8 bg-green-500 hover:bg-green-600 text-white rounded-full flex items-center justify-center text-sm font-bold transition-colors",disabled:o,children:"+"}),e.jsx("button",{type:"button",onClick:()=>p("AEK",t.player),className:"w-8 h-8 bg-gray-500 hover:bg-gray-600 text-white rounded-full flex items-center justify-center text-xs font-bold transition-colors",disabled:o,title:"Torschütze entfernen",children:"✕"})]})]},`aek-${t.player}-${u}`))}),e.jsx("div",{className:"border-t pt-2",children:e.jsxs("select",{onChange:t=>{t.target.value&&($("AEK",t.target.value),t.target.value="")},className:"w-full form-input bg-blue-100 border-blue-300 text-blue-800",disabled:o,children:[e.jsx("option",{value:"",children:"+ Torschütze hinzufügen"}),T("AEK").map(t=>e.jsxs("option",{value:t.name,children:[t.name," (",t.position,")"]},t.id))]})}),e.jsxs("div",{className:"flex items-center justify-between bg-orange-50 rounded-lg p-2 border border-orange-200",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"text-sm font-medium text-gray-700",children:"Eigentore"}),e.jsx("div",{className:"text-xs text-gray-500",children:"Zählen für Real Madrid"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("button",{type:"button",onClick:()=>k("AEK",-1),className:"w-8 h-8 bg-red-500 hover:bg-red-600 text-white rounded-full flex items-center justify-center text-sm font-bold transition-colors",disabled:o||s.ownGoalsA===0,children:"−"}),e.jsx("span",{className:"w-8 text-center font-bold text-lg text-gray-700",children:s.ownGoalsA}),e.jsx("button",{type:"button",onClick:()=>k("AEK",1),className:"w-8 h-8 bg-green-500 hover:bg-green-600 text-white rounded-full flex items-center justify-center text-sm font-bold transition-colors",disabled:o,children:"+"})]})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("div",{className:"text-center",children:e.jsx("h5",{className:"text-sm font-medium text-red-600 mb-3",children:"⚽ Real Madrid Torschützen"})}),e.jsx("div",{className:"space-y-2",children:s.goalslistb.map((t,u)=>e.jsxs("div",{className:"flex items-center justify-between bg-red-50 rounded-lg p-2",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"text-sm font-medium text-gray-700",children:t.player}),e.jsxs("div",{className:"text-xs text-gray-500",children:[t.count," Tor",t.count!==1?"e":""]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("button",{type:"button",onClick:()=>S("Real",t.player),className:"w-8 h-8 bg-red-500 hover:bg-red-600 text-white rounded-full flex items-center justify-center text-sm font-bold transition-colors",disabled:o,children:"−"}),e.jsx("span",{className:"w-8 text-center font-bold text-lg text-gray-700",children:t.count}),e.jsx("button",{type:"button",onClick:()=>d("Real",t.player),className:"w-8 h-8 bg-green-500 hover:bg-green-600 text-white rounded-full flex items-center justify-center text-sm font-bold transition-colors",disabled:o,children:"+"}),e.jsx("button",{type:"button",onClick:()=>p("Real",t.player),className:"w-8 h-8 bg-gray-500 hover:bg-gray-600 text-white rounded-full flex items-center justify-center text-xs font-bold transition-colors",disabled:o,title:"Torschütze entfernen",children:"✕"})]})]},`real-${t.player}-${u}`))}),e.jsx("div",{className:"border-t pt-2",children:e.jsxs("select",{onChange:t=>{t.target.value&&($("Real",t.target.value),t.target.value="")},className:"w-full form-input bg-red-100 border-red-300 text-red-800",disabled:o,children:[e.jsx("option",{value:"",children:"+ Torschütze hinzufügen"}),T("Real").map(t=>e.jsxs("option",{value:t.name,children:[t.name," (",t.position,")"]},t.id))]})}),e.jsxs("div",{className:"flex items-center justify-between bg-orange-50 rounded-lg p-2 border border-orange-200",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"text-sm font-medium text-gray-700",children:"Eigentore"}),e.jsx("div",{className:"text-xs text-gray-500",children:"Zählen für AEK Athen"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("button",{type:"button",onClick:()=>k("Real",-1),className:"w-8 h-8 bg-red-500 hover:bg-red-600 text-white rounded-full flex items-center justify-center text-sm font-bold transition-colors",disabled:o||s.ownGoalsB===0,children:"−"}),e.jsx("span",{className:"w-8 text-center font-bold text-lg text-gray-700",children:s.ownGoalsB}),e.jsx("button",{type:"button",onClick:()=>k("Real",1),className:"w-8 h-8 bg-green-500 hover:bg-green-600 text-white rounded-full flex items-center justify-center text-sm font-bold transition-colors",disabled:o,children:"+"})]})]})]})]})]}),e.jsxs("div",{className:"border-t pt-4",children:[e.jsx("h4",{className:"text-sm font-medium text-text-primary mb-3",children:"🟨🟥 Karten"}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-3",children:[e.jsx("p",{className:"text-xs text-blue-600 font-medium",children:"Heimteam"}),e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs text-text-muted mb-1",children:"🟨 Gelbe Karten"}),e.jsx("input",{type:"number",min:"0",value:s.yellowa,onChange:t=>x("yellowa",t.target.value),className:"form-input",disabled:o})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs text-text-muted mb-1",children:"🟥 Rote Karten"}),e.jsx("input",{type:"number",min:"0",value:s.reda,onChange:t=>x("reda",t.target.value),className:"form-input",disabled:o})]})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("p",{className:"text-xs text-red-600 font-medium",children:"Gastteam"}),e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs text-text-muted mb-1",children:"🟨 Gelbe Karten"}),e.jsx("input",{type:"number",min:"0",value:s.yellowb,onChange:t=>x("yellowb",t.target.value),className:"form-input",disabled:o})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs text-text-muted mb-1",children:"🟥 Rote Karten"}),e.jsx("input",{type:"number",min:"0",value:s.redb,onChange:t=>x("redb",t.target.value),className:"form-input",disabled:o})]})]})]})]})]}),e.jsxs("div",{className:"border-t pt-4",children:[e.jsx("h4",{className:"text-sm font-medium text-text-primary mb-3",children:"⭐ Spieler des Spiels"}),e.jsxs("div",{className:"mb-3",children:[e.jsx("label",{className:"block text-xs text-text-muted mb-2",children:"Team Filter:"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{type:"button",onClick:()=>x("motmTeamFilter","all"),className:`px-3 py-1 rounded-lg text-xs font-medium transition-colors ${s.motmTeamFilter==="all"?"bg-gray-600 text-white":"bg-gray-200 text-gray-700 hover:bg-gray-300"}`,disabled:o,children:"Alle"}),e.jsx("button",{type:"button",onClick:()=>x("motmTeamFilter","AEK"),className:`px-3 py-1 rounded-lg text-xs font-medium transition-colors ${s.motmTeamFilter==="AEK"?"bg-blue-600 text-white":"bg-blue-100 text-blue-700 hover:bg-blue-200"}`,disabled:o,children:"AEK"}),e.jsx("button",{type:"button",onClick:()=>x("motmTeamFilter","Real"),className:`px-3 py-1 rounded-lg text-xs font-medium transition-colors ${s.motmTeamFilter==="Real"?"bg-red-600 text-white":"bg-red-100 text-red-700 hover:bg-red-200"}`,disabled:o,children:"Real"})]})]}),e.jsxs("select",{value:s.manofthematch,onChange:t=>x("manofthematch",t.target.value),className:"form-input",disabled:o,children:[e.jsx("option",{value:"",children:"Keinen Spieler auswählen"}),A().map(t=>e.jsxs("option",{value:t.name,children:[t.name," (",t.team," - ",t.position,")"]},t.id))]}),!f||f.length===0&&e.jsx("p",{className:"text-xs text-text-muted mt-1",children:"Keine Spieler verfügbar. Bitte fügen Sie erst Spieler hinzu."})]}),e.jsxs("div",{className:"border-t pt-4",children:[e.jsx("h4",{className:"text-sm font-medium text-text-primary mb-3",children:"💰 Preisgelder (automatisch berechnet)"}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text-primary mb-2",children:"Preisgeld AEK (€)"}),e.jsx("input",{type:"number",value:s.prizeaek,className:"form-input bg-gray-100",placeholder:"Automatisch berechnet",disabled:!0,readOnly:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text-primary mb-2",children:"Preisgeld Real (€)"}),e.jsx("input",{type:"number",value:s.prizereal,className:"form-input bg-gray-100",placeholder:"Automatisch berechnet",disabled:!0,readOnly:!0})]})]}),e.jsx("p",{className:"text-xs text-text-muted mt-2",children:"Basierend auf Ergebnis und Karten: Gewinner 1M€ - (Verlierer-Tore × 50k€) - (Karten × 20k€/50k€)"})]}),s.goalsa===s.goalsb&&(s.goalsa>0||s.goalsb>0)&&e.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-3",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"text-red-600 mr-2",children:"⚠️"}),e.jsxs("div",{children:[e.jsx("h5",{className:"font-medium text-red-800",children:"Unentschieden nicht erlaubt"}),e.jsx("p",{className:"text-sm text-red-700",children:"Ein Team muss gewinnen. Unentschieden sind in dieser App nicht möglich."})]})]})}),!s.manofthematch&&(s.goalsa>0||s.goalsb>0)&&e.jsx("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-3",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"text-yellow-600 mr-2",children:"⭐"}),e.jsxs("div",{children:[e.jsx("h5",{className:"font-medium text-yellow-800",children:"Spieler des Spiels erforderlich"}),e.jsx("p",{className:"text-sm text-yellow-700",children:"Bitte wählen Sie einen Spieler des Spiels aus, bevor Sie das Match speichern."})]})]})}),e.jsxs("div",{className:"flex gap-3 pt-4",children:[e.jsx("button",{type:"button",onClick:()=>l(!1),className:"flex-1 px-4 py-2 border border-border-light rounded-lg text-text-secondary hover:bg-bg-tertiary transition-colors",disabled:o,children:"Abbrechen"}),e.jsx("button",{type:"submit",disabled:!y()||o,className:"flex-1 btn-primary disabled:opacity-50 disabled:cursor-not-allowed",children:o?e.jsxs("div",{className:"flex items-center justify-center",children:[e.jsx("div",{className:"spinner w-4 h-4 mr-2"}),"Speichern..."]}):"Speichern"})]})]})]})})}),e.jsx("div",{className:"mt-6 modern-card bg-blue-50 border-blue-200",children:e.jsxs("div",{className:"flex items-start",children:[e.jsx("div",{className:"text-blue-600 mr-3",children:e.jsx("i",{className:"fas fa-info-circle"})}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold text-blue-800 mb-1",children:"Wichtige Hinweise"}),e.jsxs("ul",{className:"text-blue-700 text-sm space-y-1",children:[e.jsxs("li",{children:["• ",e.jsx("strong",{children:"Kein Unentschieden:"})," Ein Team muss immer gewinnen - Unentschieden sind nicht erlaubt"]}),e.jsxs("li",{children:["• ",e.jsx("strong",{children:"Spieler des Spiels Pflicht:"})," Für jedes Spiel muss ein Spieler des Spiels ausgewählt werden"]}),e.jsx("li",{children:"• Nach dem Hinzufügen können Sie das Spiel in der Spiele-Übersicht einsehen und bearbeiten"})]})]})]})})]})}const G=[{value:"AEK",label:"AEK Athen",color:"blue",icon:"🔵"},{value:"Real",label:"Real Madrid",color:"red",icon:"🔴"},{value:"Ehemalige",label:"Ehemalige",color:"gray",icon:"⚫"}],I=f=>{const i=G.find(l=>l.value===f);return i?`${i.icon} ${i.label}`:f};function ie(){const{data:f}=F("players","*"),[i,l]=M.useState(!1),[s,r]=M.useState(""),[o,h]=M.useState({player_id:"",type:"",reason:"",customDuration:1}),[N,w]=M.useState(!1),x=(d,S)=>{h(k=>({...k,[d]:S})),d==="team"&&h(k=>({...k,player_id:""}))},c=()=>!f||!s?[]:f.filter(d=>d.team===s),y=async d=>{var S;d.preventDefault(),w(!0);try{const k=f==null?void 0:f.find(m=>m.id===parseInt(o.player_id)),$=q.find(m=>m.value===o.type);if(!k)throw new Error("Spieler nicht gefunden");if(!$)throw new Error("Sperrart nicht gefunden");const t=(S=(await C.select("bans","*",{eq:{player_id:k.id}})).data)==null?void 0:S.find(m=>(m.matchesserved||0)<(m.totalgames||0));if(t)throw new Error(`Spieler "${k.name}" ist bereits gesperrt (${t.totalgames-t.matchesserved} Spiele verbleibend)`);const u=$.fixedDuration?$.duration:o.customDuration,a=await C.insert("bans",{player_id:k.id,team:k.team,type:$.value,totalgames:u,matchesserved:0,reason:o.reason||$.value});if(a.error)throw new Error(`Ban insert failed: ${a.error.message}`);h({player_id:"",type:"",reason:"",customDuration:1}),r(""),l(!1),R.success(`Sperre für "${k.name}" erfolgreich hinzugefügt!`)}catch(k){console.error("Ban submission error:",k),R.error(k.message||"Fehler beim Hinzufügen der Sperre")}finally{w(!1)}},T=s&&o.player_id&&o.type,A=q.find(d=>d.value===o.type);return e.jsxs("div",{className:"p-4",children:[e.jsxs("div",{className:"mb-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-text-primary mb-2",children:"Neue Sperre hinzufügen"}),e.jsx("p",{className:"text-text-muted text-sm",children:"Erstellen Sie eine neue Spielersperre in der Datenbank."})]}),e.jsx("div",{className:"modern-card",children:e.jsxs("div",{className:"text-center py-8",children:[e.jsx("div",{className:"text-4xl mb-4",children:"🚫"}),e.jsx("h4",{className:"text-lg font-medium text-text-primary mb-2",children:"Sperre hinzufügen"}),e.jsx("p",{className:"text-text-muted mb-6",children:"Klicken Sie auf den Button, um eine neue Spielersperre zu erfassen."}),e.jsxs("button",{onClick:()=>l(!0),className:"btn-primary",children:[e.jsx("i",{className:"fas fa-plus mr-2"}),"Neue Sperre erfassen"]})]})}),i&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-[60] p-4",children:e.jsx("div",{className:"bg-bg-secondary rounded-lg max-w-md w-full modal-content",children:e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsx("h3",{className:"text-xl font-semibold text-text-primary",children:"Neue Sperre"}),e.jsx("button",{onClick:()=>l(!1),className:"text-text-muted hover:text-text-primary text-2xl",disabled:N,children:"×"})]}),e.jsxs("form",{onSubmit:y,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text-primary mb-2",children:"Team *"}),e.jsxs("select",{value:s,onChange:d=>{r(d.target.value),h(S=>({...S,player_id:""}))},className:"form-input",required:!0,disabled:N,children:[e.jsx("option",{value:"",children:"Team wählen"}),G.filter(d=>d.value!=="Ehemalige").map(d=>e.jsx("option",{value:d.value,children:I(d.value)},d.value))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text-primary mb-2",children:"Spieler *"}),e.jsxs("select",{value:o.player_id,onChange:d=>x("player_id",d.target.value),className:"form-input",required:!0,disabled:N||!s,children:[e.jsx("option",{value:"",children:s?"Spieler wählen":"Bitte zuerst Team wählen"}),c().map(d=>e.jsxs("option",{value:d.id,children:[d.name," (",d.position,")"]},d.id))]}),s&&c().length===0&&e.jsx("p",{className:"text-xs text-text-muted mt-1",children:"Keine Spieler im gewählten Team verfügbar."})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text-primary mb-2",children:"Sperrart *"}),e.jsxs("select",{value:o.type,onChange:d=>x("type",d.target.value),className:"form-input",required:!0,disabled:N,children:[e.jsx("option",{value:"",children:"Sperrart wählen"}),q.map(d=>e.jsxs("option",{value:d.value,children:[d.icon," ",d.label,d.fixedDuration?` (${d.duration} Spiel${d.duration!==1?"e":""})`:` (1-${d.maxDuration} Spiele)`]},d.value))]})]}),A&&!A.fixedDuration&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text-primary mb-2",children:"Anzahl Spiele *"}),e.jsx("select",{value:o.customDuration,onChange:d=>x("customDuration",parseInt(d.target.value)),className:"form-input",required:!0,disabled:N,children:Array.from({length:A.maxDuration},(d,S)=>S+1).map(d=>e.jsxs("option",{value:d,children:[d," Spiel",d!==1?"e":""]},d))}),e.jsxs("p",{className:"text-xs text-text-muted mt-1",children:["Wählen Sie zwischen ",A.minDuration," und ",A.maxDuration," Spielen"]})]}),A&&A.fixedDuration&&e.jsx("div",{className:"p-3 bg-blue-50 rounded-lg border border-blue-200",children:e.jsxs("p",{className:"text-sm text-blue-800",children:[e.jsx("i",{className:"fas fa-info-circle mr-2"}),"Gelb-Rote Karten haben immer eine feste Sperre von 1 Spiel."]})}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text-primary mb-2",children:"Zusätzlicher Grund (optional)"}),e.jsx("input",{type:"text",value:o.reason,onChange:d=>x("reason",d.target.value),className:"form-input",placeholder:"Weitere Details zur Sperre...",disabled:N})]}),e.jsxs("div",{className:"flex gap-3 pt-4",children:[e.jsx("button",{type:"button",onClick:()=>l(!1),className:"flex-1 px-4 py-2 border border-border-light rounded-lg text-text-secondary hover:bg-bg-tertiary transition-colors",disabled:N,children:"Abbrechen"}),e.jsx("button",{type:"submit",disabled:!T||N||!f||f.length===0,className:"flex-1 btn-primary disabled:opacity-50 disabled:cursor-not-allowed",children:N?e.jsxs("div",{className:"flex items-center justify-center",children:[e.jsx("div",{className:"spinner w-4 h-4 mr-2"}),"Speichern..."]}):"Speichern"})]})]})]})})}),e.jsxs("div",{className:"mt-6 modern-card",children:[e.jsx("h4",{className:"font-semibold text-text-primary mb-3",children:"Verfügbare Sperrarten"}),e.jsx("div",{className:"space-y-2",children:q.map(d=>e.jsxs("div",{className:"flex justify-between items-center p-3 bg-bg-secondary rounded-lg",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx("span",{className:"text-xl mr-2",children:d.icon}),e.jsx("span",{className:"font-medium text-text-primary",children:d.label})]}),e.jsx("span",{className:"text-sm text-text-muted",children:d.fixedDuration?`${d.duration} Spiel${d.duration!==1?"e":""} (fest)`:`1-${d.maxDuration} Spiele (variabel)`})]},d.value))})]}),e.jsx("div",{className:"mt-6 modern-card bg-yellow-50 border-yellow-200",children:e.jsxs("div",{className:"flex items-start",children:[e.jsx("div",{className:"text-yellow-600 mr-3",children:e.jsx("i",{className:"fas fa-info-circle"})}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold text-yellow-800 mb-1",children:"Hinweis"}),e.jsx("p",{className:"text-yellow-700 text-sm",children:"Nach dem Hinzufügen können Sie die Sperre in der Sperren-Übersicht einsehen und verwalten."})]})]})})]})}const J=[{value:"TH",label:"Torwart (TH)"},{value:"IV",label:"Innenverteidiger (IV)"},{value:"AV",label:"Außenverteidiger (AV)"},{value:"ZM",label:"Zentrales Mittelfeld (ZM)"},{value:"OM",label:"Offensives Mittelfeld (OM)"},{value:"ST",label:"Stürmer (ST)"}];function ce(){const[f,i]=M.useState(!1),[l,s]=M.useState({name:"",team:"",position:"",goals:0,value:0}),[r,o]=M.useState(!1),h=(x,c)=>{s(y=>({...y,[x]:c}))},N=async x=>{x.preventDefault(),o(!0);try{const c=await C.select("players","*",{eq:{name:l.name.trim(),team:l.team.trim()}});if(c.data&&c.data.length>0)throw new Error(`Spieler "${l.name}" existiert bereits im Team "${l.team}"`);const y=await C.insert("players",{name:l.name.trim(),team:l.team.trim(),position:l.position.trim().toUpperCase(),goals:parseInt(l.goals)||0,value:parseFloat(l.value)||0});if(y.error)throw new Error(`Player insert failed: ${y.error.message}`);s({name:"",team:"",position:"",goals:0,value:0}),i(!1),R.success(`Spieler "${l.name}" erfolgreich hinzugefügt!`)}catch(c){console.error("Player submission error:",c),R.error(c.message||"Fehler beim Hinzufügen des Spielers")}finally{o(!1)}},w=l.name&&l.team&&l.position&&l.value!=="";return e.jsxs("div",{className:"p-4",children:[e.jsxs("div",{className:"mb-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-text-primary mb-2",children:"Neuen Spieler hinzufügen"}),e.jsx("p",{className:"text-text-muted text-sm",children:"Fügen Sie einen neuen Spieler zur Datenbank hinzu."})]}),e.jsx("div",{className:"modern-card",children:e.jsxs("div",{className:"text-center py-8",children:[e.jsx("div",{className:"text-4xl mb-4",children:"👤"}),e.jsxs("h4",{className:"text-lg font-medium text-text-primary mb-2",children:[e.jsx("i",{className:"fas fa-user-plus mr-2"}),"Spieler hinzufügen"]}),e.jsx("p",{className:"text-text-muted mb-6",children:"Klicken Sie auf den Button, um einen neuen Spieler zu erfassen."}),e.jsxs("button",{onClick:()=>i(!0),className:"btn-primary",children:[e.jsx("i",{className:"fas fa-plus mr-2"}),"Neuen Spieler erfassen"]})]})}),f&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-[60] p-4",children:e.jsx("div",{className:"bg-bg-secondary rounded-lg max-w-md w-full modal-content",children:e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsx("h3",{className:"text-xl font-semibold text-text-primary",children:"Neuer Spieler"}),e.jsx("button",{onClick:()=>i(!1),className:"text-text-muted hover:text-text-primary text-2xl",disabled:r,children:"×"})]}),e.jsxs("form",{onSubmit:N,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text-primary mb-2",children:"Spielername *"}),e.jsx("input",{type:"text",value:l.name,onChange:x=>h("name",x.target.value),className:"form-input",placeholder:"z.B. Max Mustermann",required:!0,disabled:r})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text-primary mb-2",children:"Team *"}),e.jsxs("select",{value:l.team,onChange:x=>h("team",x.target.value),className:"form-input",required:!0,disabled:r,children:[e.jsx("option",{value:"",children:"Team wählen"}),G.map(x=>e.jsx("option",{value:x.value,children:I(x.value)},x.value))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text-primary mb-2",children:"Position *"}),e.jsxs("select",{value:l.position,onChange:x=>h("position",x.target.value),className:"form-input",required:!0,disabled:r,children:[e.jsx("option",{value:"",children:"Position wählen"}),J.map(x=>e.jsx("option",{value:x.value,children:x.label},x.value))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text-primary mb-2",children:"Marktwert (Millionen €) *"}),e.jsx("input",{type:"number",min:"0",step:"0.1",value:l.value,onChange:x=>h("value",x.target.value),className:"form-input",placeholder:"0.0",disabled:r}),e.jsx("p",{className:"text-xs text-text-muted mt-1",children:"Marktwert in Millionen Euro (z.B. 1.5 für 1.5M €)"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text-primary mb-2",children:"Anzahl Tore"}),e.jsx("input",{type:"number",min:"0",value:l.goals,onChange:x=>h("goals",x.target.value),className:"form-input",placeholder:"0",disabled:r})]}),e.jsxs("div",{className:"flex gap-3 pt-4",children:[e.jsx("button",{type:"button",onClick:()=>i(!1),className:"flex-1 px-4 py-2 border border-border-light rounded-lg text-text-secondary hover:bg-bg-tertiary transition-colors",disabled:r,children:"Abbrechen"}),e.jsx("button",{type:"submit",disabled:!w||r,className:"flex-1 btn-primary disabled:opacity-50 disabled:cursor-not-allowed",children:r?e.jsxs("div",{className:"flex items-center justify-center",children:[e.jsx("div",{className:"spinner w-4 h-4 mr-2"}),"Speichern..."]}):"Speichern"})]})]})]})})}),e.jsxs("div",{className:"mt-6 modern-card",children:[e.jsx("h4",{className:"font-semibold text-text-primary mb-3",children:"Verfügbare Teams"}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-2",children:G.map(x=>e.jsxs("div",{className:"p-3 bg-bg-secondary rounded-lg text-center",children:[e.jsx("span",{className:`font-medium ${x.color==="blue"?"text-blue-600":x.color==="red"?"text-red-600":"text-gray-600"}`,children:I(x.value)}),e.jsxs("div",{className:"text-xs text-text-muted mt-1",children:["(",x.value,")"]})]},x.value))})]}),e.jsxs("div",{className:"mt-6 modern-card",children:[e.jsx("h4",{className:"font-semibold text-text-primary mb-3",children:"Verfügbare Positionen"}),e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-2",children:J.map(x=>e.jsx("div",{className:"p-3 bg-bg-secondary rounded-lg text-center",children:e.jsx("span",{className:"font-medium text-text-primary text-sm",children:x.label})},x.value))})]}),e.jsx("div",{className:"mt-6 modern-card bg-green-50 border-green-200",children:e.jsxs("div",{className:"flex items-start",children:[e.jsx("div",{className:"text-green-600 mr-3",children:e.jsx("i",{className:"fas fa-info-circle"})}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold text-green-800 mb-1",children:"Hinweis"}),e.jsx("p",{className:"text-green-700 text-sm",children:"Nach dem Hinzufügen können Sie den Spieler in der Kader-Übersicht einsehen und verwalten."})]})]})})]})}const Q=[{value:"Preisgeld",label:"Preisgeld",icon:"🏆"},{value:"Strafe",label:"Strafe",icon:"📉"},{value:"Spielerkauf",label:"Spielerkauf",icon:"👤"},{value:"Spielerverkauf",label:"Spielerverkauf",icon:"💰"},{value:"Echtgeld-Ausgleich",label:"Echtgeld-Ausgleich",icon:"💳"},{value:"SdS Bonus",label:"Spieler des Spiels Bonus",icon:"⭐"},{value:"Sonstiges",label:"Sonstiges",icon:"📈"}];function de(){const[f,i]=M.useState(!1),[l,s]=M.useState({team:"",type:"",amount:"",info:"",date:new Date().toISOString().split("T")[0]}),[r,o]=M.useState(!1),h=(c,y)=>{s(T=>({...T,[c]:y}))},N=async c=>{c.preventDefault(),o(!0);try{const y=parseFloat(l.amount),T=await C.insert("transactions",{date:l.date,type:l.type.trim(),team:l.team.trim(),amount:y,info:l.info.trim(),match_id:null});if(T.error)throw new Error(`Transaction insert failed: ${T.error.message}`);await w(l.team.trim(),l.type.trim(),y),s({team:"",type:"",amount:"",info:"",date:new Date().toISOString().split("T")[0]}),i(!1),R.success("Transaktion erfolgreich hinzugefügt!")}catch(y){console.error("Transaction submission error:",y),R.error(y.message||"Fehler beim Hinzufügen der Transaktion")}finally{o(!1)}},w=async(c,y,T)=>{try{const A=await C.select("finances","*",{eq:{team:c}});let d=A.data&&A.data.length>0?A.data[0]:{team:c,balance:0,debt:0},S={};if(y==="Echtgeld-Ausgleich")S.debt=(d.debt||0)+T;else{let k=(d.balance||0)+T;k<0&&(k=0),S.balance=k}d.id?await C.update("finances",S,d.id):await C.insert("finances",{team:c,balance:S.balance||0,debt:S.debt||0})}catch(A){console.warn("Failed to update finances:",A)}},x=l.team&&l.type&&l.amount&&l.date;return e.jsxs("div",{className:"p-4",children:[e.jsxs("div",{className:"mb-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-text-primary mb-2",children:"Neue Transaktion hinzufügen"}),e.jsx("p",{className:"text-text-muted text-sm",children:"Erfassen Sie eine neue finanzielle Transaktion."})]}),e.jsx("div",{className:"modern-card",children:e.jsxs("div",{className:"text-center py-8",children:[e.jsx("div",{className:"text-4xl mb-4",children:"💰"}),e.jsx("h4",{className:"text-lg font-medium text-text-primary mb-2",children:"Transaktion hinzufügen"}),e.jsx("p",{className:"text-text-muted mb-6",children:"Klicken Sie auf den Button, um eine neue Transaktion zu erfassen."}),e.jsxs("button",{onClick:()=>i(!0),className:"btn-primary",children:[e.jsx("i",{className:"fas fa-plus mr-2"}),"Neue Transaktion erfassen"]})]})}),f&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-[60] p-4",children:e.jsx("div",{className:"bg-bg-secondary rounded-lg max-w-md w-full modal-content",children:e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsx("h3",{className:"text-xl font-semibold text-text-primary",children:"Neue Transaktion"}),e.jsx("button",{onClick:()=>i(!1),className:"text-text-muted hover:text-text-primary text-2xl",disabled:r,children:"×"})]}),e.jsxs("form",{onSubmit:N,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text-primary mb-2",children:"Team *"}),e.jsxs("select",{value:l.team,onChange:c=>h("team",c.target.value),className:"form-input",required:!0,disabled:r,children:[e.jsx("option",{value:"",children:"Team wählen"}),G.filter(c=>c.value!=="Ehemalige").map(c=>e.jsx("option",{value:c.value,children:I(c.value)},c.value))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text-primary mb-2",children:"Transaktionsart *"}),e.jsxs("select",{value:l.type,onChange:c=>h("type",c.target.value),className:"form-input",required:!0,disabled:r,children:[e.jsx("option",{value:"",children:"Typ wählen"}),Q.map(c=>e.jsxs("option",{value:c.value,children:[c.icon," ",c.label]},c.value))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text-primary mb-2",children:"Betrag (€) *"}),e.jsx("input",{type:"number",step:"0.01",value:l.amount,onChange:c=>h("amount",c.target.value),className:"form-input",placeholder:"0.00",required:!0,disabled:r}),e.jsx("p",{className:"text-xs text-text-muted mt-1",children:"Negative Werte für Ausgaben, positive für Einnahmen"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text-primary mb-2",children:"Beschreibung"}),e.jsx("input",{type:"text",value:l.info,onChange:c=>h("info",c.target.value),className:"form-input",placeholder:"Zusätzliche Informationen...",disabled:r})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text-primary mb-2",children:"Datum *"}),e.jsx("input",{type:"date",value:l.date,onChange:c=>h("date",c.target.value),className:"form-input",required:!0,disabled:r})]}),e.jsxs("div",{className:"flex gap-3 pt-4",children:[e.jsx("button",{type:"button",onClick:()=>i(!1),className:"flex-1 px-4 py-2 border border-border-light rounded-lg text-text-secondary hover:bg-bg-tertiary transition-colors",disabled:r,children:"Abbrechen"}),e.jsx("button",{type:"submit",disabled:!x||r,className:"flex-1 btn-primary disabled:opacity-50 disabled:cursor-not-allowed",children:r?e.jsxs("div",{className:"flex items-center justify-center",children:[e.jsx("div",{className:"spinner w-4 h-4 mr-2"}),"Speichern..."]}):"Speichern"})]})]})]})})}),e.jsxs("div",{className:"mt-6 modern-card",children:[e.jsx("h4",{className:"font-semibold text-text-primary mb-3",children:"Transaktionsarten"}),e.jsx("div",{className:"grid grid-cols-2 gap-2",children:Q.map(c=>e.jsxs("div",{className:"p-3 bg-bg-secondary rounded-lg text-center",children:[e.jsx("div",{className:"text-2xl mb-2",children:c.icon}),e.jsx("span",{className:"font-medium text-text-primary",children:c.label})]},c.value))})]}),e.jsxs("div",{className:"mt-6 modern-card",children:[e.jsx("h4",{className:"font-semibold text-text-primary mb-3",children:"Verfügbare Teams"}),e.jsx("div",{className:"grid grid-cols-2 gap-2",children:G.filter(c=>c.value!=="Ehemalige").map(c=>e.jsxs("div",{className:"p-3 bg-bg-secondary rounded-lg text-center",children:[e.jsx("span",{className:`font-medium ${c.color==="blue"?"text-blue-600":"text-red-600"}`,children:I(c.value)}),e.jsxs("div",{className:"text-xs text-text-muted mt-1",children:["(",c.value,")"]})]},c.value))})]}),e.jsx("div",{className:"mt-6 modern-card bg-blue-50 border-blue-200",children:e.jsxs("div",{className:"flex items-start",children:[e.jsx("div",{className:"text-blue-600 mr-3",children:e.jsx("i",{className:"fas fa-info-circle"})}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold text-blue-800 mb-1",children:"Hinweis"}),e.jsx("p",{className:"text-blue-700 text-sm",children:"Nach dem Hinzufügen können Sie die Transaktion in der Finanzen-Übersicht einsehen."})]})]})})]})}function oe(){var Z;const[f,i]=M.useState("players"),[l,s]=M.useState(!1),[r,o]=M.useState(""),{data:h,refetch:N}=F("players","*",{order:{column:"id",ascending:!1}}),{data:w,refetch:x}=F("matches","*",{order:{column:"date",ascending:!1}}),{data:c,refetch:y}=F("bans","*",{order:{column:"id",ascending:!1}}),{data:T,refetch:A}=F("transactions","*",{order:{column:"date",ascending:!1}}),{remove:d}=H("players"),{remove:S}=H("bans"),{remove:k}=H("transactions"),$=[{id:"players",label:"Spieler löschen",icon:"fas fa-users"},{id:"matches",label:"Spiele löschen",icon:"fas fa-futbol"},{id:"bans",label:"Sperren löschen",icon:"fas fa-ban"},{id:"transactions",label:"Transaktionen löschen",icon:"fas fa-euro-sign"}],p=n=>{i(n),o("")},t=()=>{switch(f){case"players":return{total:(h==null?void 0:h.length)||0,filtered:D(h).length};case"matches":return{total:(w==null?void 0:w.length)||0,filtered:z(w).length};case"bans":return{total:(c==null?void 0:c.length)||0,filtered:_(c).length};case"transactions":return{total:(T==null?void 0:T.length)||0,filtered:B(T).length};default:return{total:0,filtered:0}}},u=async n=>{const b=(c==null?void 0:c.filter(g=>g.player_id===n.id||g.player_name===n.name))||[];let j=`Sind Sie sicher, dass Sie ${n.name} (${n.team}) löschen möchten?`;if(b.length>0&&(j+=`

Achtung: ${b.length} zugehörige Sperre(n) werden ebenfalls gelöscht.`),n.goals&&n.goals>0&&(j+=`
Der Spieler hat ${n.goals} Tor(e) erzielt.`),!!confirm(j)){s(!0);try{await d(n.id),R.success(`Spieler ${n.name} erfolgreich gelöscht`),N(),b.length>0&&y()}catch(g){R.error("Fehler beim Löschen des Spielers: "+g.message)}finally{s(!1)}}},a=async n=>{const b=(T==null?void 0:T.filter(K=>K.match_id===n.id))||[],j=`AEK ${n.goalsa||0} - ${n.goalsb||0} Real`;let g=`Sind Sie sicher, dass Sie das Spiel vom ${new Date(n.date).toLocaleDateString("de-DE")} (${j}) löschen möchten?`;if(b.length>0&&(g+=`

Achtung: ${b.length} zugehörige Transaktion(en) werden ebenfalls gelöscht.`),n.manofthematch&&(g+=`
Spieler des Spiels: ${n.manofthematch}`),!!confirm(g)){s(!0);try{const{deleteMatch:K}=await re(async()=>{const{deleteMatch:L}=await import("./matches-Bz0wv9ua.js");return{deleteMatch:L}},__vite__mapDeps([0,1]));await K(n.id),R.success("Spiel erfolgreich gelöscht"),x(),b.length>0&&A()}catch(K){R.error("Fehler beim Löschen des Spiels: "+K.message)}finally{s(!1)}}},m=async n=>{var K;const b=n.player_name||(n.player_id&&h?(K=h.find(L=>L.id===n.player_id))==null?void 0:K.name:"Unbekannter Spieler"),j=Math.max(0,(n.totalgames||0)-(n.matchesserved||0));let g=`Sind Sie sicher, dass Sie die Sperre für ${b} löschen möchten?`;if(g+=`
Sperrtyp: ${n.type}`,j>0?g+=`
Noch ${j} Spiel(e) verbleibend`:g+=`
Sperre bereits abgesessen`,n.reason&&(g+=`
Grund: ${n.reason}`),!!confirm(g)){s(!0);try{await S(n.id),R.success(`Sperre für ${b} erfolgreich gelöscht`),y()}catch(L){R.error("Fehler beim Löschen der Sperre: "+L.message)}finally{s(!1)}}},v=async n=>{const b=n.match_id&&w?w.find(g=>g.id===n.match_id):null;let j=`Sind Sie sicher, dass Sie die Transaktion "${n.type}" löschen möchten?`;if(j+=`
Betrag: ${n.amount>0?"+":""}${n.amount}M € (${n.team})`,n.date&&(j+=`
Datum: ${new Date(n.date).toLocaleDateString("de-DE")}`),n.info&&(j+=`
Info: ${n.info}`),b&&(j+=`
Zugehöriges Spiel: ${new Date(b.date).toLocaleDateString("de-DE")} (AEK ${b.goalsa||0} - ${b.goalsb||0} Real)`),!!confirm(j)){s(!0);try{await k(n.id),R.success("Transaktion erfolgreich gelöscht"),A()}catch(g){R.error("Fehler beim Löschen der Transaktion: "+g.message)}finally{s(!1)}}},E=n=>{const b=G.find(j=>j.value===n);return b?b.icon:"⚫"},D=n=>r?(n||[]).filter(b=>{var j,g,K;return((j=b.name)==null?void 0:j.toLowerCase().includes(r.toLowerCase()))||((g=b.team)==null?void 0:g.toLowerCase().includes(r.toLowerCase()))||((K=b.position)==null?void 0:K.toLowerCase().includes(r.toLowerCase()))}):n||[],z=n=>r?(n||[]).filter(b=>{var j;return new Date(b.date).toLocaleDateString("de-DE").includes(r)||((j=b.manofthematch)==null?void 0:j.toLowerCase().includes(r.toLowerCase()))}):n||[],_=n=>r?(n||[]).filter(b=>{var g,K,L,W;const j=b.player_name||(b.player_id&&h?(g=h.find(le=>le.id===b.player_id))==null?void 0:g.name:"");return(j==null?void 0:j.toLowerCase().includes(r.toLowerCase()))||((K=b.type)==null?void 0:K.toLowerCase().includes(r.toLowerCase()))||((L=b.team)==null?void 0:L.toLowerCase().includes(r.toLowerCase()))||((W=b.reason)==null?void 0:W.toLowerCase().includes(r.toLowerCase()))}):n||[],B=n=>r?(n||[]).filter(b=>{var j,g,K,L;return((j=b.type)==null?void 0:j.toLowerCase().includes(r.toLowerCase()))||((g=b.team)==null?void 0:g.toLowerCase().includes(r.toLowerCase()))||((K=b.info)==null?void 0:K.toLowerCase().includes(r.toLowerCase()))||((L=b.amount)==null?void 0:L.toString().includes(r))}):n||[],P=()=>{const n=D(h);return!n||n.length===0?e.jsx("p",{className:"text-text-muted text-center py-4",children:r?"Keine Spieler gefunden":"Keine Spieler vorhanden"}):e.jsx("div",{className:"space-y-2",children:n.map(b=>e.jsxs("div",{className:"flex items-center justify-between p-3 bg-bg-tertiary rounded-lg",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("span",{className:"text-lg",children:E(b.team)}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-text-primary",children:b.name}),e.jsxs("p",{className:"text-sm text-text-muted",children:[b.team," • ",b.position,b.goals!==void 0&&e.jsxs("span",{className:"ml-2",children:["• ",b.goals," Tore"]})]})]})]}),e.jsxs("button",{onClick:()=>u(b),disabled:l,className:"btn-secondary btn-sm text-accent-red hover:bg-red-50 disabled:opacity-50",children:[e.jsx("i",{className:"fas fa-trash mr-1"}),"Löschen"]})]},b.id))})},O=()=>{const n=z(w);return!n||n.length===0?e.jsx("p",{className:"text-text-muted text-center py-4",children:r?"Keine Spiele gefunden":"Keine Spiele vorhanden"}):e.jsx("div",{className:"space-y-2",children:n.map(b=>e.jsxs("div",{className:"flex items-center justify-between p-3 bg-bg-tertiary rounded-lg",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-text-primary",children:new Date(b.date).toLocaleDateString("de-DE")}),e.jsxs("p",{className:"text-sm text-text-muted",children:["AEK ",b.goalsa||0," - ",b.goalsb||0," Real"]}),b.manofthematch&&e.jsxs("p",{className:"text-xs text-text-muted mt-1",children:[e.jsx("i",{className:"fas fa-star mr-1"}),"SdS: ",b.manofthematch]})]}),e.jsxs("button",{onClick:()=>a(b),disabled:l,className:"btn-secondary btn-sm text-accent-red hover:bg-red-50 disabled:opacity-50",children:[e.jsx("i",{className:"fas fa-trash mr-1"}),"Löschen"]})]},b.id))})},te=()=>{const n=_(c);if(!n||n.length===0)return e.jsx("p",{className:"text-text-muted text-center py-4",children:r?"Keine Sperren gefunden":"Keine Sperren vorhanden"});const b=g=>{if(g.player_name)return g.player_name;if(g.player_id&&h){const K=h.find(L=>L.id===g.player_id);return K?K.name:"Unbekannter Spieler"}return"Unbekannter Spieler"},j=g=>{const K=(g.totalgames||0)-(g.matchesserved||0);return Math.max(0,K)};return e.jsx("div",{className:"space-y-2",children:n.map(g=>e.jsxs("div",{className:"flex items-center justify-between p-3 bg-bg-tertiary rounded-lg",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("span",{className:"text-lg",children:E(g.team)}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-text-primary",children:b(g)}),e.jsxs("p",{className:"text-sm text-text-muted",children:[g.type," • ",g.totalgames||0," Spiele",j(g)>0?` (${j(g)} verbleibend)`:" (abgesessen)"]}),g.reason&&e.jsxs("p",{className:"text-xs text-text-muted mt-1",children:["Grund: ",g.reason]})]})]}),e.jsxs("button",{onClick:()=>m(g),disabled:l,className:"btn-secondary btn-sm text-accent-red hover:bg-red-50 disabled:opacity-50",children:[e.jsx("i",{className:"fas fa-trash mr-1"}),"Löschen"]})]},g.id))})},se=()=>{const n=B(T);if(!n||n.length===0)return e.jsx("p",{className:"text-text-muted text-center py-4",children:r?"Keine Transaktionen gefunden":"Keine Transaktionen vorhanden"});const b=j=>{if(!j.match_id||!w)return null;const g=w.find(K=>K.id===j.match_id);return g?`Match: ${new Date(g.date).toLocaleDateString("de-DE")} (AEK ${g.goalsa||0} - ${g.goalsb||0} Real)`:null};return e.jsx("div",{className:"space-y-2",children:n.map(j=>e.jsxs("div",{className:"flex items-center justify-between p-3 bg-bg-tertiary rounded-lg",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("span",{className:"text-lg",children:E(j.team)}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h4",{className:"font-medium text-text-primary",children:j.type}),e.jsxs("p",{className:"text-sm text-text-muted",children:[e.jsxs("span",{className:j.amount>0?"text-green-600":"text-red-600",children:[j.amount>0?"+":"",j.amount,"M €"]}),j.date&&e.jsxs("span",{className:"ml-2",children:["• ",new Date(j.date).toLocaleDateString("de-DE")]})]}),j.info&&e.jsx("p",{className:"text-xs text-text-muted mt-1",children:j.info}),b(j)&&e.jsxs("p",{className:"text-xs text-blue-600 mt-1",children:[e.jsx("i",{className:"fas fa-futbol mr-1"}),b(j)]})]})]}),e.jsxs("button",{onClick:()=>v(j),disabled:l,className:"btn-secondary btn-sm text-accent-red hover:bg-red-50 disabled:opacity-50",children:[e.jsx("i",{className:"fas fa-trash mr-1"}),"Löschen"]})]},j.id))})},ae=()=>{switch(f){case"players":return P();case"matches":return O();case"bans":return te();case"transactions":return se();default:return P()}};return e.jsxs("div",{className:"p-4",children:[e.jsxs("div",{className:"mb-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-text-primary mb-2",children:"Daten löschen"}),e.jsx("p",{className:"text-text-muted text-sm",children:"Verwalten Sie die Löschung von Spielern, Spielen, Sperren und Transaktionen."})]}),e.jsx("div",{className:"grid grid-cols-2 gap-2 mb-6",children:$.map(n=>e.jsxs("button",{onClick:()=>p(n.id),className:`p-3 rounded-lg text-sm font-medium transition-colors ${f===n.id?"bg-accent-red text-white":"bg-bg-tertiary text-text-secondary hover:text-text-primary hover:bg-bg-hover"}`,children:[e.jsx("i",{className:`${n.icon} mr-2`}),n.label]},n.id))}),e.jsxs("div",{className:"mb-4",children:[e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:"text",placeholder:`${(Z=$.find(n=>n.id===f))==null?void 0:Z.label.replace(" löschen","")} durchsuchen...`,value:r,onChange:n=>o(n.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-accent-red focus:border-transparent text-text-primary bg-bg-secondary"}),e.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:e.jsx("i",{className:"fas fa-search text-text-muted"})}),r&&e.jsx("button",{onClick:()=>o(""),className:"absolute inset-y-0 right-0 pr-3 flex items-center text-text-muted hover:text-text-primary",children:e.jsx("i",{className:"fas fa-times"})})]}),e.jsxs("div",{className:"flex justify-between items-center mt-2",children:[r&&e.jsxs("p",{className:"text-xs text-text-muted",children:[e.jsx("i",{className:"fas fa-filter mr-1"}),"Gefiltert nach: “",r,"”"]}),e.jsx("p",{className:"text-xs text-text-muted ml-auto",children:(()=>{const n=t();return r?`${n.filtered} von ${n.total} Einträgen`:`${n.total} Einträge`})()})]})]}),e.jsxs("div",{className:"modern-card",children:[l&&e.jsx(ee,{message:"Lösche..."}),!l&&ae()]}),e.jsx("div",{className:"mt-6 modern-card bg-red-50 border-red-200",children:e.jsxs("div",{className:"flex items-start",children:[e.jsx("div",{className:"text-red-600 mr-3",children:e.jsx("i",{className:"fas fa-exclamation-triangle"})}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold text-red-800 mb-1",children:"Achtung"}),e.jsx("p",{className:"text-red-700 text-sm",children:"Das Löschen von Daten ist permanent und kann nicht rückgängig gemacht werden. Bitte überprüfen Sie Ihre Auswahl sorgfältig, bevor Sie fortfahren."})]})]})})]})}function me({data:f=[],searchFields:i=[],filterOptions:l=[],onResults:s,placeholder:r="Suchen...",showCount:o=!0,searchExtractor:h}){const[N,w]=M.useState(""),[x,c]=M.useState({}),[y,T]=M.useState(""),[A,d]=M.useState("asc"),S=M.useRef(null),k=M.useMemo(()=>{let a=[...f];if(N.trim()){const m=N.toLowerCase().trim();a=a.filter(v=>{if(h){const E=h(v);return E&&E.toLowerCase().includes(m)}return i.some(E=>{const D=V(v,E);return D&&D.toString().toLowerCase().includes(m)})})}return Object.entries(x).forEach(([m,v])=>{if(v&&v!=="all"){const E=l.find(D=>D.key===m);E&&E.filterFn?a=a.filter(D=>E.filterFn(D,v)):a=a.filter(D=>V(D,m)===v)}}),y&&a.sort((m,v)=>{const E=V(m,y),D=V(v,y);let z=0;return typeof E=="number"&&typeof D=="number"?z=E-D:E instanceof Date&&D instanceof Date?z=E.getTime()-D.getTime():z=String(E).localeCompare(String(D)),A==="desc"?-z:z}),a},[f,N,x,y,A,i,l,h]);M.useEffect(()=>{s&&JSON.stringify(k)!==S.current&&(S.current=JSON.stringify(k),s(k))},[k,s]);const $=(a,m)=>{c(v=>({...v,[a]:m}))},p=a=>{y===a?d(A==="asc"?"desc":"asc"):(T(a),d("asc"))},t=()=>{w(""),c({}),T(""),d("asc")},u=N||Object.values(x).some(a=>a&&a!=="all")||y;return e.jsxs("div",{className:"bg-bg-primary border border-border-light rounded-lg shadow-sm mb-4",children:[e.jsx("div",{className:"p-4 border-b border-border-light",children:e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center",children:e.jsx("span",{className:"text-text-secondary","aria-hidden":"true",children:"🔍"})}),e.jsx("input",{type:"text",value:N,onChange:a=>w(a.target.value),placeholder:`${r} (Strg+K für globale Suche)`,className:"w-full pl-10 pr-20 py-2 bg-bg-secondary border border-border-light rounded-lg text-text-primary placeholder-text-secondary focus:outline-none focus:ring-2 focus:ring-primary-green focus:border-transparent"}),e.jsxs("div",{className:"absolute inset-y-0 right-0 flex items-center gap-1 pr-3",children:[e.jsx("button",{onClick:()=>{const a=new CustomEvent("global-search-toggle");window.dispatchEvent(a)},className:"text-text-secondary hover:text-primary-green transition-colors p-1 rounded",title:"Globale Suche öffnen (Strg+K)",children:e.jsx("span",{"aria-hidden":"true",children:"🌐"})}),N&&e.jsx("button",{onClick:()=>w(""),className:"text-text-secondary hover:text-text-primary transition-colors p-1 rounded",title:"Suchfeld leeren",children:e.jsx("span",{"aria-hidden":"true",children:"✕"})})]})]})}),(l.length>0||y)&&e.jsx("div",{className:"p-4 border-b border-border-light",children:e.jsxs("div",{className:"flex flex-wrap gap-2 items-center",children:[l.map(a=>e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("label",{className:"text-sm font-medium text-text-primary",children:[a.label,":"]}),e.jsxs("select",{value:x[a.key]||"",onChange:m=>$(a.key,m.target.value),className:"px-3 py-1 bg-bg-secondary border border-border-light rounded text-sm text-text-primary focus:outline-none focus:ring-2 focus:ring-primary-green",children:[e.jsx("option",{value:"",children:"Alle"}),a.options.map(m=>e.jsx("option",{value:m.value,children:m.label},m.value))]})]},a.key)),i.length>0&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("label",{className:"text-sm font-medium text-text-primary",children:"Sortieren:"}),e.jsxs("select",{value:y,onChange:a=>T(a.target.value),className:"px-3 py-1 bg-bg-secondary border border-border-light rounded text-sm text-text-primary focus:outline-none focus:ring-2 focus:ring-primary-green",children:[e.jsx("option",{value:"",children:"Standard"}),i.map(a=>e.jsx("option",{value:a,children:Y(a)},a))]}),y&&e.jsx("button",{onClick:()=>p(y),className:"px-2 py-1 bg-bg-secondary border border-border-light rounded text-sm text-text-primary hover:bg-bg-tertiary transition-colors duration-200",title:`Sortierung: ${A==="asc"?"Aufsteigend":"Absteigend"}`,children:A==="asc"?"↑":"↓"})]}),u&&e.jsx("button",{onClick:t,className:"px-3 py-1 bg-red-100 text-red-800 border border-red-200 rounded text-sm hover:bg-red-200 transition-colors duration-200",children:"Filter zurücksetzen"})]})}),o&&e.jsx("div",{className:"px-4 py-2 bg-bg-secondary border-b border-border-light",children:e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsx("span",{className:"text-text-secondary",children:k.length===f.length?`${f.length} Einträge`:`${k.length} von ${f.length} Einträgen`}),u&&e.jsxs("div",{className:"flex items-center gap-2",children:[N&&e.jsxs("span",{className:"bg-primary-green bg-opacity-10 text-primary-green px-2 py-1 rounded text-xs",children:['🔍 "',N,'"']}),Object.entries(x).filter(([,a])=>a&&a!=="all").map(([a,m])=>{const v=l.find(D=>D.key===a),E=v==null?void 0:v.options.find(D=>D.value===m);return e.jsxs("span",{className:"bg-blue-100 text-blue-800 px-2 py-1 rounded text-xs",children:[v==null?void 0:v.label,": ",(E==null?void 0:E.label)||m]},a)}),y&&e.jsxs("span",{className:"bg-yellow-100 text-yellow-800 px-2 py-1 rounded text-xs",children:["📊 ",Y(y)," ",A==="asc"?"↑":"↓"]})]})]})})]})}function V(f,i){return!f||!i?"":i.split(".").reduce((l,s)=>l&&l[s]!==void 0?l[s]:"",f)}function Y(f){return{name:"Name",team:"Team",position:"Position",value:"Wert",date:"Datum",goalsa:"AEK Tore",goalsb:"Real Tore",type:"Typ",amount:"Betrag",description:"Beschreibung",totalgames:"Gesamt Spiele",matchesserved:"Gespielte Spiele"}[f]||f.charAt(0).toUpperCase()+f.slice(1)}function X({onNavigate:f}){const[i,l]=M.useState("players"),[s,r]=M.useState([]),{data:o,loading:h}=F("players","*"),{data:N,loading:w}=F("matches","*",{order:{column:"date",ascending:!1}}),{data:x,loading:c}=F("transactions","*",{order:{column:"date",ascending:!1}}),{data:y,loading:T}=F("bans","*",{order:{column:"id",ascending:!1}}),A=h||w||c||T,d=[{id:"players",label:"Spieler",icon:"fas fa-users",data:o||[],searchFields:["name","position","team","value"],filterOptions:[{key:"team",label:"Team",options:[{value:"AEK",label:"AEK Athen"},{value:"Real",label:"Real Madrid"},{value:"Ehemalige",label:"Ehemalige"}]},{key:"position",label:"Position",options:[{value:"TH",label:"Torwart"},{value:"IV",label:"Innenverteidiger"},{value:"LV",label:"Linksverteidiger"},{value:"RV",label:"Rechtsverteidiger"},{value:"ZDM",label:"Defensives Mittelfeld"},{value:"ZM",label:"Zentrales Mittelfeld"},{value:"ZOM",label:"Offensives Mittelfeld"},{value:"LM",label:"Linkes Mittelfeld"},{value:"RM",label:"Rechtes Mittelfeld"},{value:"LF",label:"Linker Flügel"},{value:"RF",label:"Rechter Flügel"},{value:"ST",label:"Stürmer"}]}]},{id:"matches",label:"Spiele",icon:"fas fa-futbol",data:N||[],searchFields:["date","goalsa","goalsb","goalscorers","manofthematch","teama","teamb"],filterOptions:[],searchExtractor:p=>{const t=[];if(p.date&&t.push(new Date(p.date).toLocaleDateString("de-DE")),p.teama&&t.push(p.teama),p.teamb&&t.push(p.teamb),p.goalsa!==void 0&&t.push(p.goalsa.toString()),p.goalsb!==void 0&&t.push(p.goalsb.toString()),p.goalslista)try{const u=typeof p.goalslista=="string"?JSON.parse(p.goalslista):p.goalslista;Array.isArray(u)&&u.forEach(a=>{typeof a=="string"?t.push(a):a&&a.player&&t.push(a.player)})}catch{}if(p.goalslistb)try{const u=typeof p.goalslistb=="string"?JSON.parse(p.goalslistb):p.goalslistb;Array.isArray(u)&&u.forEach(a=>{typeof a=="string"?t.push(a):a&&a.player&&t.push(a.player)})}catch{}return p.manofthematch&&(t.push(p.manofthematch),t.push("Spieler des Spiels"),t.push("SdS")),t.join(" ").toLowerCase()}},{id:"transactions",label:"Transaktionen",icon:"fas fa-euro-sign",data:x||[],searchFields:["type","description","amount","date"],filterOptions:[{key:"type",label:"Typ",options:[{value:"transfer",label:"Transfer"},{value:"preis",label:"Preisgeld"},{value:"strafe",label:"Strafe"},{value:"sonstige",label:"Sonstige"}],filterFn:(p,t)=>{var m,v;const u=((m=p.type)==null?void 0:m.toLowerCase())||"",a=((v=p.description)==null?void 0:v.toLowerCase())||"";switch(t){case"transfer":return u.includes("transfer")||a.includes("transfer");case"preis":return u.includes("preis")||a.includes("preis")||p.amount>0;case"strafe":return u.includes("strafe")||a.includes("strafe");case"sonstige":return!u.includes("transfer")&&!u.includes("preis")&&!u.includes("strafe");default:return!0}}}]},{id:"bans",label:"Sperren",icon:"fas fa-ban",data:y||[],searchFields:["player_name","team","type","reason"],filterOptions:[{key:"team",label:"Team",options:[{value:"AEK",label:"AEK Athen"},{value:"Real",label:"Real Madrid"}]},{key:"type",label:"Typ",options:[{value:"Gelbe Karte",label:"Gelbe Karte"},{value:"Gelb-Rote Karte",label:"Gelb-Rote Karte"},{value:"Rote Karte",label:"Rote Karte"},{value:"Verletzung",label:"Verletzung"}]}]}],S=d.find(p=>p.id===i),k=(p,t)=>{switch(t){case"players":f==null||f("squad");break;case"matches":f==null||f("matches");break;case"transactions":f==null||f("finances");break;case"bans":f==null||f("bans");break}},$=()=>{const p=s.length>0?s:S.data;return p.length===0?e.jsxs("div",{className:"p-6 text-center text-text-secondary",children:[e.jsx("i",{className:`${S.icon} text-4xl mb-2`}),e.jsxs("p",{children:["Keine ",S.label.toLowerCase()," gefunden"]})]}):e.jsx("div",{className:"divide-y divide-border-light",children:p.map(t=>e.jsxs("button",{onClick:()=>k(t,i),className:"w-full p-4 hover:bg-bg-secondary transition-colors text-left focus:outline-none focus:ring-2 focus:ring-primary-green focus:ring-inset",children:[i==="players"&&e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"font-medium text-text-primary",children:t.name}),e.jsxs("p",{className:"text-sm text-text-secondary",children:[t.position," • ",t.team," • ",t.value||0,"M €"]}),(t.goals||0)>0&&e.jsxs("p",{className:"text-xs text-primary-green",children:["⚽ ",t.goals||0," Tore"]})]}),e.jsxs("div",{className:"text-right ml-4",children:[e.jsxs("div",{className:"text-lg font-bold text-primary-green",children:[t.value||0,"M €"]}),e.jsx("div",{className:"text-xs text-text-muted",children:"Zum Spieler →"})]})]}),i==="matches"&&e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"font-medium text-text-primary",children:new Date(t.date).toLocaleDateString("de-DE")}),e.jsxs("p",{className:"text-sm text-text-secondary",children:[t.teama||"AEK"," ",t.goalsa||0," - ",t.goalsb||0," ",t.teamb||"Real"]}),(()=>{const u=[];try{if(t.goalslista){const a=typeof t.goalslista=="string"?JSON.parse(t.goalslista):t.goalslista;Array.isArray(a)&&a.forEach(m=>{const v=typeof m=="string"?m:m==null?void 0:m.player;v&&u.push(`${v} (AEK)`)})}if(t.goalslistb){const a=typeof t.goalslistb=="string"?JSON.parse(t.goalslistb):t.goalslistb;Array.isArray(a)&&a.forEach(m=>{const v=typeof m=="string"?m:m==null?void 0:m.player;v&&u.push(`${v} (Real)`)})}}catch{}return u.length>0?e.jsxs("p",{className:"text-xs text-text-muted mt-1",children:["⚽ ",u.slice(0,3).join(", "),u.length>3?"...":""]}):null})(),t.manofthematch&&e.jsxs("p",{className:"text-xs text-yellow-600 mt-1",children:["⭐ SdS: ",t.manofthematch]})]}),e.jsxs("div",{className:"text-right ml-4",children:[e.jsxs("div",{className:"text-lg font-bold text-primary-green",children:[(t.goalsa||0)+(t.goalsb||0)," Tore"]}),e.jsx("div",{className:"text-xs text-text-muted",children:"Zum Spiel →"})]})]}),i==="transactions"&&e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"font-medium text-text-primary",children:t.type||"Transaktion"}),e.jsx("p",{className:"text-sm text-text-secondary",children:t.description||"Keine Beschreibung"}),e.jsx("p",{className:"text-xs text-text-secondary",children:new Date(t.date).toLocaleDateString("de-DE")})]}),e.jsxs("div",{className:"text-right ml-4",children:[e.jsxs("div",{className:`text-lg font-bold ${(t.amount||0)>=0?"text-green-600":"text-red-600"}`,children:[(t.amount||0)>0?"+":"",t.amount||0,"€"]}),e.jsx("div",{className:"text-xs text-text-muted",children:"Zu Finanzen →"})]})]}),i==="bans"&&e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"font-medium text-text-primary",children:t.player_name}),e.jsxs("p",{className:"text-sm text-text-secondary",children:[t.team," • ",t.type]}),t.reason&&e.jsx("p",{className:"text-xs text-text-secondary",children:t.reason})]}),e.jsxs("div",{className:"text-right ml-4",children:[e.jsxs("div",{className:"text-sm text-accent-red",children:[t.duration||1," Spiel",(t.duration||1)!==1?"e":""]}),e.jsx("div",{className:"text-xs text-text-muted",children:"Zu Sperren →"})]})]})]},t.id))})};return A?e.jsx(ee,{message:"Lade Daten..."}):e.jsxs("div",{className:"p-4 space-y-4",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-text-primary mb-1",children:"🔍 Globale Suche"}),e.jsx("p",{className:"text-text-muted text-sm",children:"Durchsuche alle Daten zentral an einem Ort"})]}),e.jsx("div",{className:"icon-only-nav flex overflow-x-auto space-x-2 pb-2",children:d.map(p=>e.jsxs("button",{onClick:()=>{l(p.id),r([])},className:`search-nav-button flex items-center space-x-2 px-4 py-2 rounded-lg whitespace-nowrap transition-colors ${i===p.id?"bg-primary-green text-white":"bg-bg-secondary text-text-muted hover:bg-bg-tertiary"}`,title:p.label,"aria-label":p.label,children:[e.jsx("i",{className:p.icon}),e.jsx("span",{className:"font-medium hidden sm:inline",children:p.label}),e.jsxs("span",{className:"text-xs opacity-75",children:["(",p.data.length,")"]})]},p.id))}),e.jsx(me,{data:S.data,searchFields:S.searchFields,filterOptions:S.filterOptions,searchExtractor:S.searchExtractor,onResults:r,placeholder:`${S.label} durchsuchen...`}),e.jsxs("div",{className:"modern-card",children:[e.jsx("div",{className:"p-4 border-b border-border-light",children:e.jsxs("h4",{className:"font-medium text-text-primary",children:[s.length>0?"Suchergebnisse":`Alle ${S.label}`,e.jsxs("span",{className:"text-text-secondary ml-2",children:["(",s.length>0?s.length:S.data.length,")"]})]})}),$()]})]})}function he({onLogout:f,onNavigate:i}){const[l,s]=M.useState("search"),r=[{id:"search",label:"Globale Suche",icon:"fas fa-search"},{id:"matches",label:"Spiele hinzufügen",icon:"fas fa-futbol"},{id:"bans",label:"Sperren hinzufügen",icon:"fas fa-ban"},{id:"players",label:"Spieler hinzufügen",icon:"fas fa-users"},{id:"transactions",label:"Transaktionen hinzufügen",icon:"fas fa-euro-sign"},{id:"delete",label:"Daten löschen",icon:"fas fa-trash"}],o=()=>{switch(l){case"search":return e.jsx(X,{onNavigate:i});case"matches":return e.jsx(ne,{});case"bans":return e.jsx(ie,{});case"players":return e.jsx(ce,{});case"transactions":return e.jsx(de,{});case"delete":return e.jsx(oe,{});default:return e.jsx(X,{onNavigate:i})}};return e.jsxs("div",{className:"flex flex-col h-full",children:[e.jsxs("div",{className:"p-4 bg-bg-secondary border-b border-border-light flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-semibold text-text-primary mb-1",children:"Verwaltung"}),e.jsx("p",{className:"text-text-muted text-sm",children:"Hinzufügen und verwalten von Daten"})]}),e.jsxs("button",{onClick:f,className:"flex items-center px-3 py-2 bg-accent-red text-white rounded-lg hover:bg-red-600 transition-colors focus:outline-none focus:ring-2 focus:ring-red-500 focus:ring-opacity-50","aria-label":"Abmelden",children:[e.jsx("i",{className:"fas fa-sign-out-alt mr-2"}),e.jsx("span",{className:"text-sm",children:"Logout"})]})]}),e.jsx("div",{className:"bg-bg-secondary border-b border-border-light",children:e.jsx("div",{className:"flex overflow-x-auto",children:r.map(h=>e.jsxs("button",{onClick:()=>s(h.id),className:`flex-shrink-0 px-4 py-3 text-sm font-medium transition-colors whitespace-nowrap ${l===h.id?"text-primary-green border-b-2 border-primary-green bg-bg-primary":"text-text-secondary hover:text-text-primary hover:bg-bg-hover"}`,children:[e.jsx("i",{className:`${h.icon} mr-2`}),h.label]},h.id))})}),e.jsx("div",{className:"flex-1 overflow-y-auto",children:o()})]})}export{he as default};
