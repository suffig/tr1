const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/matches-Bz0wv9ua.js","assets/dataManager-B859Fmxm.js"])))=>i.map(i=>d[i]);
import{s as w,u as G,r as D,j as e,z as M,a as V,L as se,_ as ae}from"./index-CkuXuksq.js";import{B as O}from"./banTypes-DuNOJEIt.js";class Z{static async submitMatch(d){const{date:s,teama:t="AEK",teamb:a="Real",goalsa:i,goalsb:h,goalslista:j=[],goalslistb:p=[],ownGoalsA:o=0,ownGoalsB:r=0,yellowa:v=0,reda:y=0,yellowb:k=0,redb:c=0,manofthematch:T,editId:S=null}=d;try{const{prizeaek:E,prizereal:B,winner:l,loser:b}=this.calculatePrizeMoney(i,h,v,y,k,c);S&&await this.deleteMatchTransactions(S);const x=[...j],g=[...p];o>0&&g.push({count:o,player:"Eigentore_AEK"}),r>0&&x.push({count:r,player:"Eigentore_Real"});const C={date:s,teama:t,teamb:a,goalsa:parseInt(i)||0,goalsb:parseInt(h)||0,goalslista:j,goalslistb:p,yellowa:parseInt(v)||0,reda:parseInt(y)||0,yellowb:parseInt(k)||0,redb:parseInt(c)||0,manofthematch:T||null,prizeaek:E,prizereal:B},K=await w.insert("matches",C);if(K.error)throw new Error(`Match insert failed: ${K.error.message}`);const F=K.data.id,_=new Date().toISOString().slice(0,10);if(x.length>0){const R=x.filter(z=>typeof z=="object"&&z.player?!z.player.startsWith("Eigentore_"):!z.startsWith("Eigentore_"));await this.updatePlayersGoals(R,"AEK")}if(g.length>0){const R=g.filter(z=>typeof z=="object"&&z.player?!z.player.startsWith("Eigentore_"):!z.startsWith("Eigentore_"));await this.updatePlayersGoals(R,"Real")}return T&&await this.updatePlayerOfTheMatchStats(T),await this.processFinancialTransactions({matchId:F,date:_,prizeaek:E,prizereal:B,manofthematch:T,winner:l,loser:b}),await this.decrementBansAfterMatch(),{success:!0,matchId:F,message:`Match ${t} vs ${a} (${i}:${h}) erfolgreich hinzugefügt`}}catch(E){throw console.error("Error in submitMatch:",E),new Error(`Fehler beim Speichern des Matches: ${E.message}`)}}static calculatePrizeMoney(d,s,t,a,i,h){let j=0,p=0,o=null,r=null;return d>s?(o="AEK",r="Real"):d<s&&(o="Real",r="AEK"),o&&r&&(o==="AEK"?(j=1e6-s*5e4-t*2e4-a*5e4,p=-(5e5+d*5e4+i*2e4+h*5e4)):(p=1e6-d*5e4-i*2e4-h*5e4,j=-(5e5+s*5e4+t*2e4+a*5e4))),{prizeaek:j,prizereal:p,winner:o,loser:r}}static async updatePlayersGoals(d,s){const t={};if(d.length>0&&typeof d[0]=="object"&&d[0].player!==void 0)d.forEach(a=>{a.player&&!a.player.startsWith("Eigentore_")&&(t[a.player]=(t[a.player]||0)+(a.count||1))});else for(const a of d)!a||!a.trim()||a.startsWith("Eigentore_")||(t[a]=(t[a]||0)+1);for(const[a,i]of Object.entries(t))try{const h=await w.select("players","id, goals",{eq:{name:a,team:s}});if(h.data&&h.data.length>0){const j=h.data[0],p=(j.goals||0)+i;await w.update("players",{goals:p},j.id)}}catch(h){console.warn(`Failed to update goals for player ${a}:`,h)}}static async updatePlayerOfTheMatchStats(d){try{const s=await w.select("players","team",{eq:{name:d}});if(!s.data||s.data.length===0){console.warn(`Player ${d} not found for SdS stats`);return}const t=s.data[0].team,a=await w.select("spieler_des_spiels","*",{eq:{name:d,team:t}});if(a.data&&a.data.length>0){const i=a.data[0];await w.update("spieler_des_spiels",{count:i.count+1},i.id)}else await w.insert("spieler_des_spiels",{name:d,team:t,count:1})}catch(s){console.warn(`Failed to update SdS stats for ${d}:`,s)}}static async processFinancialTransactions({matchId:d,date:s,prizeaek:t,prizereal:a,manofthematch:i,winner:h,loser:j}){const p=await this.getTeamFinance("AEK"),o=await this.getTeamFinance("Real");let r=p.balance||0,v=o.balance||0;const y=i?await this.getSdSBonus(i,"AEK"):0,k=i?await this.getSdSBonus(i,"Real"):0;y>0&&(r+=y,await this.insertTransaction({date:s,type:"SdS Bonus",team:"AEK",amount:y,match_id:d,info:"SdS Bonus"}),await this.updateTeamBalance("AEK",r)),k>0&&(v+=k,await this.insertTransaction({date:s,type:"SdS Bonus",team:"Real",amount:k,match_id:d,info:"SdS Bonus"}),await this.updateTeamBalance("Real",v)),t!==0&&(r+=t,r<0&&(r=0),await this.insertTransaction({date:s,type:"Preisgeld",team:"AEK",amount:t,match_id:d,info:"Preisgeld"}),await this.updateTeamBalance("AEK",r)),a!==0&&(v+=a,v<0&&(v=0),await this.insertTransaction({date:s,type:"Preisgeld",team:"Real",amount:a,match_id:d,info:"Preisgeld"}),await this.updateTeamBalance("Real",v)),h&&j&&await this.processEchtgeldAusgleich({date:s,matchId:d,winner:h,loser:j,aekBalance:r,realBalance:v,prizeaek:t,prizereal:a,sdsBonusAek:y>0?1:0,sdsBonusReal:k>0?1:0,manofthematch:i})}static async getTeamFinance(d){const s=await w.select("finances","*",{eq:{team:d}});return s.data&&s.data.length>0?s.data[0]:{balance:0,debt:0}}static async getSdSBonus(d,s){const t=await w.select("players","team",{eq:{name:d}});return t.data&&t.data.length>0&&t.data[0].team===s?1e5:0}static async insertTransaction(d){return await w.insert("transactions",d)}static async updateTeamBalance(d,s){const t=await w.select("finances","id",{eq:{team:d}});return t.data&&t.data.length>0?await w.update("finances",{balance:s},t.data[0].id):await w.insert("finances",{team:d,balance:s,debt:0})}static async processEchtgeldAusgleich({date:d,matchId:s,winner:t,loser:a,aekBalance:i,realBalance:h,prizeaek:j,prizereal:p,sdsBonusAek:o,sdsBonusReal:r,manofthematch:v}){const y=await this.getTeamFinance("AEK"),k=await this.getTeamFinance("Real"),c={AEK:y.debt||0,Real:k.debt||0},T=(_,R,z)=>{let P=_;z&&(P+=1e5);let I=(Math.abs(R)-P)/1e5;return I<0&&(I=0),5+Math.round(I)},S=T(i,j,o),E=T(h,p,r),B=a==="AEK"?S:E,l=c[t],b=c[a],x=Math.min(l,B*1),g=Math.max(0,l-x),C=B*1-x,K=b+Math.max(0,C),F=await w.select("finances","id",{eq:{team:t}});if(F.data&&F.data.length>0&&await w.update("finances",{debt:g},F.data[0].id),C>0){await this.insertTransaction({date:d,type:"Echtgeld-Ausgleich",team:a,amount:Math.max(0,C),match_id:s,info:"Echtgeld-Ausgleich"});const _=await w.select("finances","id",{eq:{team:a}});_.data&&_.data.length>0&&await w.update("finances",{debt:K},_.data[0].id)}x>0&&await this.insertTransaction({date:d,type:"Echtgeld-Ausgleich (getilgt)",team:t,amount:-x,match_id:s,info:"Echtgeld-Ausgleich (getilgt)"})}static async deleteMatchTransactions(d){const s=await w.select("transactions","*",{eq:{match_id:d}});if(s.data)for(const t of s.data)await w.delete("transactions",t.id);await w.delete("matches",d)}static async decrementBansAfterMatch(){try{const d=await w.select("bans","*");if(!d.data)return;for(const s of d.data)if(s.matchesserved<s.totalgames){const t=s.matchesserved+1;await w.update("bans",{matchesserved:t},s.id)}}catch(d){console.warn("Failed to decrement bans:",d)}}}function U(){const{data:N}=G("players","*"),[d,s]=D.useState(!1),[t,a]=D.useState({teama:"AEK",teamb:"Real",date:new Date().toISOString().split("T")[0],goalsa:0,goalsb:0,goalslista:[],goalslistb:[],ownGoalsA:0,ownGoalsB:0,yellowa:0,reda:0,yellowb:0,redb:0,prizeaek:0,prizereal:0,manofthematch:"",motmTeamFilter:"all"}),[i,h]=D.useState(!1),j=(l,b,x)=>l.reduce((C,K)=>C+K.count,0)+x,p=l=>{a(b=>{const x={...b,...l};x.goalsa=j(x.goalslista,x.ownGoalsA,x.ownGoalsB),x.goalsb=j(x.goalslistb,x.ownGoalsB,x.ownGoalsA);const{prizeaek:g,prizereal:C}=Z.calculatePrizeMoney(x.goalsa,x.goalsb,x.yellowa,x.reda,x.yellowb,x.redb);return x.prizeaek=g,x.prizereal=C,x})},o=(l,b)=>{p({[l]:b})},r=async l=>{l.preventDefault(),h(!0);try{const b=await Z.submitMatch({date:t.date,teama:t.teama.trim(),teamb:t.teamb.trim(),goalsa:t.goalsa,goalsb:t.goalsb,goalslista:t.goalslista,goalslistb:t.goalslistb,ownGoalsA:t.ownGoalsA,ownGoalsB:t.ownGoalsB,yellowa:parseInt(t.yellowa)||0,reda:parseInt(t.reda)||0,yellowb:parseInt(t.yellowb)||0,redb:parseInt(t.redb)||0,manofthematch:t.manofthematch||null});a({teama:"AEK",teamb:"Real",date:new Date().toISOString().split("T")[0],goalsa:0,goalsb:0,goalslista:[],goalslistb:[],ownGoalsA:0,ownGoalsB:0,yellowa:0,reda:0,yellowb:0,redb:0,prizeaek:0,prizereal:0,manofthematch:"",motmTeamFilter:"all"}),s(!1),M.success(b.message)}catch(b){console.error("Match submission error:",b),M.error(b.message||"Fehler beim Hinzufügen des Spiels")}finally{h(!1)}},v=t.date,y=l=>N?N.filter(b=>b.team===l):[],k=()=>N?t.motmTeamFilter==="all"?N:N.filter(l=>l.team===t.motmTeamFilter):[],c=(l,b)=>{const x=l==="AEK"?"goalslista":"goalslistb";p({[x]:t[x].map(g=>g.player===b?{...g,count:g.count+1}:g).concat(t[x].find(g=>g.player===b)?[]:[{player:b,count:1}])})},T=(l,b)=>{const x=l==="AEK"?"goalslista":"goalslistb";p({[x]:t[x].map(g=>g.player===b?{...g,count:Math.max(0,g.count-1)}:g).filter(g=>g.count>0)})},S=(l,b)=>{const x=l==="AEK"?"ownGoalsA":"ownGoalsB",g=Math.max(0,t[x]+b);p({[x]:g})},E=(l,b)=>{if(!b)return;const x=l==="AEK"?"goalslista":"goalslistb",g=t[x].find(C=>C.player===b);p(g?{[x]:t[x].map(C=>C.player===b?{...C,count:C.count+1}:C)}:{[x]:[...t[x],{player:b,count:1}]})},B=(l,b)=>{const x=l==="AEK"?"goalslista":"goalslistb";p({[x]:t[x].filter(g=>g.player!==b)})};return e.jsxs("div",{className:"p-4",children:[e.jsxs("div",{className:"mb-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-text-primary mb-2",children:"Neues Spiel hinzufügen"}),e.jsx("p",{className:"text-text-muted text-sm",children:"Fügen Sie ein neues Spiel zur Datenbank hinzu."})]}),e.jsx("div",{className:"modern-card",children:e.jsxs("div",{className:"text-center py-8",children:[e.jsx("div",{className:"text-4xl mb-4",children:"⚽"}),e.jsx("h4",{className:"text-lg font-medium text-text-primary mb-2",children:"Spiel hinzufügen"}),e.jsx("p",{className:"text-text-muted mb-6",children:"Klicken Sie auf den Button, um ein neues Spiel zu erfassen."}),e.jsxs("button",{onClick:()=>s(!0),className:"btn-primary",children:[e.jsx("i",{className:"fas fa-plus mr-2"}),"Neues Spiel erfassen"]})]})}),d&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-[60] p-2 sm:p-4",children:e.jsx("div",{className:"bg-bg-secondary rounded-lg w-full max-w-lg modal-content",children:e.jsxs("div",{className:"p-4 sm:p-6",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsx("h3",{className:"text-xl font-semibold text-text-primary",children:"Neues Spiel"}),e.jsx("button",{onClick:()=>s(!1),className:"text-text-muted hover:text-text-primary text-2xl",disabled:i,children:"×"})]}),e.jsxs("form",{onSubmit:r,className:"space-y-4",children:[e.jsx("div",{className:"bg-gray-50 rounded-lg p-4 border",children:e.jsxs("div",{className:"text-center",children:[e.jsx("h4",{className:"text-lg font-semibold text-gray-700 mb-2",children:"⚽ Spielpaarung"}),e.jsxs("div",{className:"flex items-center justify-center space-x-4",children:[e.jsx("div",{className:"bg-blue-100 text-blue-800 px-4 py-2 rounded-lg font-medium",children:"AEK Athen"}),e.jsx("div",{className:"text-gray-500 font-bold text-xl",children:"vs"}),e.jsx("div",{className:"bg-red-100 text-red-800 px-4 py-2 rounded-lg font-medium",children:"Real Madrid"})]})]})}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text-primary mb-2",children:"Datum *"}),e.jsx("input",{type:"date",value:t.date,onChange:l=>o("date",l.target.value),className:"form-input",required:!0,disabled:i})]}),e.jsxs("div",{className:"border-t pt-4",children:[e.jsx("h4",{className:"text-sm font-medium text-text-primary mb-3",children:"⚽ Live Torwertung"}),e.jsxs("div",{className:"bg-gray-50 rounded-lg p-4 mb-4 text-center",children:[e.jsxs("div",{className:"text-2xl font-bold text-gray-700",children:[t.goalsa," : ",t.goalsb]}),e.jsxs("div",{className:"text-sm text-gray-500 mt-1",children:["AEK Athen ",t.goalsa," - ",t.goalsb," Real Madrid"]})]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4 sm:gap-6",children:[e.jsxs("div",{className:"space-y-3",children:[e.jsx("div",{className:"text-center",children:e.jsx("h5",{className:"text-sm font-medium text-blue-600 mb-3",children:"⚽ AEK Athen Torschützen"})}),e.jsx("div",{className:"space-y-2",children:t.goalslista.map((l,b)=>e.jsxs("div",{className:"flex items-center justify-between bg-blue-50 rounded-lg p-2",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"text-sm font-medium text-gray-700",children:l.player}),e.jsxs("div",{className:"text-xs text-gray-500",children:[l.count," Tor",l.count!==1?"e":""]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("button",{type:"button",onClick:()=>T("AEK",l.player),className:"w-8 h-8 bg-red-500 hover:bg-red-600 text-white rounded-full flex items-center justify-center text-sm font-bold transition-colors",disabled:i,children:"−"}),e.jsx("span",{className:"w-8 text-center font-bold text-lg text-gray-700",children:l.count}),e.jsx("button",{type:"button",onClick:()=>c("AEK",l.player),className:"w-8 h-8 bg-green-500 hover:bg-green-600 text-white rounded-full flex items-center justify-center text-sm font-bold transition-colors",disabled:i,children:"+"}),e.jsx("button",{type:"button",onClick:()=>B("AEK",l.player),className:"w-8 h-8 bg-gray-500 hover:bg-gray-600 text-white rounded-full flex items-center justify-center text-xs font-bold transition-colors",disabled:i,title:"Torschütze entfernen",children:"✕"})]})]},`aek-${l.player}-${b}`))}),e.jsx("div",{className:"border-t pt-2",children:e.jsxs("select",{onChange:l=>{l.target.value&&(E("AEK",l.target.value),l.target.value="")},className:"w-full form-input bg-blue-100 border-blue-300 text-blue-800",disabled:i,children:[e.jsx("option",{value:"",children:"+ Torschütze hinzufügen"}),y("AEK").map(l=>e.jsxs("option",{value:l.name,children:[l.name," (",l.position,")"]},l.id))]})}),e.jsxs("div",{className:"flex items-center justify-between bg-orange-50 rounded-lg p-2 border border-orange-200",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"text-sm font-medium text-gray-700",children:"Eigentore"}),e.jsx("div",{className:"text-xs text-gray-500",children:"Zählen für Real Madrid"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("button",{type:"button",onClick:()=>S("AEK",-1),className:"w-8 h-8 bg-red-500 hover:bg-red-600 text-white rounded-full flex items-center justify-center text-sm font-bold transition-colors",disabled:i||t.ownGoalsA===0,children:"−"}),e.jsx("span",{className:"w-8 text-center font-bold text-lg text-gray-700",children:t.ownGoalsA}),e.jsx("button",{type:"button",onClick:()=>S("AEK",1),className:"w-8 h-8 bg-green-500 hover:bg-green-600 text-white rounded-full flex items-center justify-center text-sm font-bold transition-colors",disabled:i,children:"+"})]})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("div",{className:"text-center",children:e.jsx("h5",{className:"text-sm font-medium text-red-600 mb-3",children:"⚽ Real Madrid Torschützen"})}),e.jsx("div",{className:"space-y-2",children:t.goalslistb.map((l,b)=>e.jsxs("div",{className:"flex items-center justify-between bg-red-50 rounded-lg p-2",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"text-sm font-medium text-gray-700",children:l.player}),e.jsxs("div",{className:"text-xs text-gray-500",children:[l.count," Tor",l.count!==1?"e":""]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("button",{type:"button",onClick:()=>T("Real",l.player),className:"w-8 h-8 bg-red-500 hover:bg-red-600 text-white rounded-full flex items-center justify-center text-sm font-bold transition-colors",disabled:i,children:"−"}),e.jsx("span",{className:"w-8 text-center font-bold text-lg text-gray-700",children:l.count}),e.jsx("button",{type:"button",onClick:()=>c("Real",l.player),className:"w-8 h-8 bg-green-500 hover:bg-green-600 text-white rounded-full flex items-center justify-center text-sm font-bold transition-colors",disabled:i,children:"+"}),e.jsx("button",{type:"button",onClick:()=>B("Real",l.player),className:"w-8 h-8 bg-gray-500 hover:bg-gray-600 text-white rounded-full flex items-center justify-center text-xs font-bold transition-colors",disabled:i,title:"Torschütze entfernen",children:"✕"})]})]},`real-${l.player}-${b}`))}),e.jsx("div",{className:"border-t pt-2",children:e.jsxs("select",{onChange:l=>{l.target.value&&(E("Real",l.target.value),l.target.value="")},className:"w-full form-input bg-red-100 border-red-300 text-red-800",disabled:i,children:[e.jsx("option",{value:"",children:"+ Torschütze hinzufügen"}),y("Real").map(l=>e.jsxs("option",{value:l.name,children:[l.name," (",l.position,")"]},l.id))]})}),e.jsxs("div",{className:"flex items-center justify-between bg-orange-50 rounded-lg p-2 border border-orange-200",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"text-sm font-medium text-gray-700",children:"Eigentore"}),e.jsx("div",{className:"text-xs text-gray-500",children:"Zählen für AEK Athen"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("button",{type:"button",onClick:()=>S("Real",-1),className:"w-8 h-8 bg-red-500 hover:bg-red-600 text-white rounded-full flex items-center justify-center text-sm font-bold transition-colors",disabled:i||t.ownGoalsB===0,children:"−"}),e.jsx("span",{className:"w-8 text-center font-bold text-lg text-gray-700",children:t.ownGoalsB}),e.jsx("button",{type:"button",onClick:()=>S("Real",1),className:"w-8 h-8 bg-green-500 hover:bg-green-600 text-white rounded-full flex items-center justify-center text-sm font-bold transition-colors",disabled:i,children:"+"})]})]})]})]})]}),e.jsxs("div",{className:"border-t pt-4",children:[e.jsx("h4",{className:"text-sm font-medium text-text-primary mb-3",children:"🟨🟥 Karten"}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-3",children:[e.jsx("p",{className:"text-xs text-blue-600 font-medium",children:"Heimteam"}),e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs text-text-muted mb-1",children:"🟨 Gelbe Karten"}),e.jsx("input",{type:"number",min:"0",value:t.yellowa,onChange:l=>o("yellowa",l.target.value),className:"form-input",disabled:i})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs text-text-muted mb-1",children:"🟥 Rote Karten"}),e.jsx("input",{type:"number",min:"0",value:t.reda,onChange:l=>o("reda",l.target.value),className:"form-input",disabled:i})]})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("p",{className:"text-xs text-red-600 font-medium",children:"Gastteam"}),e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs text-text-muted mb-1",children:"🟨 Gelbe Karten"}),e.jsx("input",{type:"number",min:"0",value:t.yellowb,onChange:l=>o("yellowb",l.target.value),className:"form-input",disabled:i})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs text-text-muted mb-1",children:"🟥 Rote Karten"}),e.jsx("input",{type:"number",min:"0",value:t.redb,onChange:l=>o("redb",l.target.value),className:"form-input",disabled:i})]})]})]})]})]}),e.jsxs("div",{className:"border-t pt-4",children:[e.jsx("h4",{className:"text-sm font-medium text-text-primary mb-3",children:"⭐ Spieler des Spiels"}),e.jsxs("div",{className:"mb-3",children:[e.jsx("label",{className:"block text-xs text-text-muted mb-2",children:"Team Filter:"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{type:"button",onClick:()=>o("motmTeamFilter","all"),className:`px-3 py-1 rounded-lg text-xs font-medium transition-colors ${t.motmTeamFilter==="all"?"bg-gray-600 text-white":"bg-gray-200 text-gray-700 hover:bg-gray-300"}`,disabled:i,children:"Alle"}),e.jsx("button",{type:"button",onClick:()=>o("motmTeamFilter","AEK"),className:`px-3 py-1 rounded-lg text-xs font-medium transition-colors ${t.motmTeamFilter==="AEK"?"bg-blue-600 text-white":"bg-blue-100 text-blue-700 hover:bg-blue-200"}`,disabled:i,children:"AEK"}),e.jsx("button",{type:"button",onClick:()=>o("motmTeamFilter","Real"),className:`px-3 py-1 rounded-lg text-xs font-medium transition-colors ${t.motmTeamFilter==="Real"?"bg-red-600 text-white":"bg-red-100 text-red-700 hover:bg-red-200"}`,disabled:i,children:"Real"})]})]}),e.jsxs("select",{value:t.manofthematch,onChange:l=>o("manofthematch",l.target.value),className:"form-input",disabled:i,children:[e.jsx("option",{value:"",children:"Keinen Spieler auswählen"}),k().map(l=>e.jsxs("option",{value:l.name,children:[l.name," (",l.team," - ",l.position,")"]},l.id))]}),!N||N.length===0&&e.jsx("p",{className:"text-xs text-text-muted mt-1",children:"Keine Spieler verfügbar. Bitte fügen Sie erst Spieler hinzu."})]}),e.jsxs("div",{className:"border-t pt-4",children:[e.jsx("h4",{className:"text-sm font-medium text-text-primary mb-3",children:"💰 Preisgelder (automatisch berechnet)"}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text-primary mb-2",children:"Preisgeld AEK (€)"}),e.jsx("input",{type:"number",value:t.prizeaek,className:"form-input bg-gray-100",placeholder:"Automatisch berechnet",disabled:!0,readOnly:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text-primary mb-2",children:"Preisgeld Real (€)"}),e.jsx("input",{type:"number",value:t.prizereal,className:"form-input bg-gray-100",placeholder:"Automatisch berechnet",disabled:!0,readOnly:!0})]})]}),e.jsx("p",{className:"text-xs text-text-muted mt-2",children:"Basierend auf Ergebnis und Karten: Gewinner 1M€ - (Verlierer-Tore × 50k€) - (Karten × 20k€/50k€)"})]}),e.jsxs("div",{className:"flex gap-3 pt-4",children:[e.jsx("button",{type:"button",onClick:()=>s(!1),className:"flex-1 px-4 py-2 border border-border-light rounded-lg text-text-secondary hover:bg-bg-tertiary transition-colors",disabled:i,children:"Abbrechen"}),e.jsx("button",{type:"submit",disabled:!v||i,className:"flex-1 btn-primary disabled:opacity-50 disabled:cursor-not-allowed",children:i?e.jsxs("div",{className:"flex items-center justify-center",children:[e.jsx("div",{className:"spinner w-4 h-4 mr-2"}),"Speichern..."]}):"Speichern"})]})]})]})})}),e.jsx("div",{className:"mt-6 modern-card bg-blue-50 border-blue-200",children:e.jsxs("div",{className:"flex items-start",children:[e.jsx("div",{className:"text-blue-600 mr-3",children:e.jsx("i",{className:"fas fa-info-circle"})}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold text-blue-800 mb-1",children:"Hinweis"}),e.jsx("p",{className:"text-blue-700 text-sm",children:"Nach dem Hinzufügen können Sie das Spiel in der Spiele-Übersicht einsehen und bearbeiten."})]})]})})]})}const L=[{value:"AEK",label:"AEK Athen",color:"blue",icon:"🔵"},{value:"Real",label:"Real Madrid",color:"red",icon:"🔴"},{value:"Ehemalige",label:"Ehemalige",color:"gray",icon:"⚫"}],q=N=>{const d=L.find(s=>s.value===N);return d?`${d.icon} ${d.label}`:N};function le(){const{data:N}=G("players","*"),[d,s]=D.useState(!1),[t,a]=D.useState(""),[i,h]=D.useState({player_id:"",type:"",reason:"",customDuration:1}),[j,p]=D.useState(!1),o=(c,T)=>{h(S=>({...S,[c]:T})),c==="team"&&h(S=>({...S,player_id:""}))},r=()=>!N||!t?[]:N.filter(c=>c.team===t),v=async c=>{var T;c.preventDefault(),p(!0);try{const S=N==null?void 0:N.find(g=>g.id===parseInt(i.player_id)),E=O.find(g=>g.value===i.type);if(!S)throw new Error("Spieler nicht gefunden");if(!E)throw new Error("Sperrart nicht gefunden");const l=(T=(await w.select("bans","*",{eq:{player_id:S.id}})).data)==null?void 0:T.find(g=>(g.matchesserved||0)<(g.totalgames||0));if(l)throw new Error(`Spieler "${S.name}" ist bereits gesperrt (${l.totalgames-l.matchesserved} Spiele verbleibend)`);const b=E.fixedDuration?E.duration:i.customDuration,x=await w.insert("bans",{player_id:S.id,team:S.team,type:E.value,totalgames:b,matchesserved:0,reason:i.reason||E.value});if(x.error)throw new Error(`Ban insert failed: ${x.error.message}`);h({player_id:"",type:"",reason:"",customDuration:1}),a(""),s(!1),M.success(`Sperre für "${S.name}" erfolgreich hinzugefügt!`)}catch(S){console.error("Ban submission error:",S),M.error(S.message||"Fehler beim Hinzufügen der Sperre")}finally{p(!1)}},y=t&&i.player_id&&i.type,k=O.find(c=>c.value===i.type);return e.jsxs("div",{className:"p-4",children:[e.jsxs("div",{className:"mb-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-text-primary mb-2",children:"Neue Sperre hinzufügen"}),e.jsx("p",{className:"text-text-muted text-sm",children:"Erstellen Sie eine neue Spielersperre in der Datenbank."})]}),e.jsx("div",{className:"modern-card",children:e.jsxs("div",{className:"text-center py-8",children:[e.jsx("div",{className:"text-4xl mb-4",children:"🚫"}),e.jsx("h4",{className:"text-lg font-medium text-text-primary mb-2",children:"Sperre hinzufügen"}),e.jsx("p",{className:"text-text-muted mb-6",children:"Klicken Sie auf den Button, um eine neue Spielersperre zu erfassen."}),e.jsxs("button",{onClick:()=>s(!0),className:"btn-primary",children:[e.jsx("i",{className:"fas fa-plus mr-2"}),"Neue Sperre erfassen"]})]})}),d&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-[60] p-4",children:e.jsx("div",{className:"bg-bg-secondary rounded-lg max-w-md w-full modal-content",children:e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsx("h3",{className:"text-xl font-semibold text-text-primary",children:"Neue Sperre"}),e.jsx("button",{onClick:()=>s(!1),className:"text-text-muted hover:text-text-primary text-2xl",disabled:j,children:"×"})]}),e.jsxs("form",{onSubmit:v,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text-primary mb-2",children:"Team *"}),e.jsxs("select",{value:t,onChange:c=>{a(c.target.value),h(T=>({...T,player_id:""}))},className:"form-input",required:!0,disabled:j,children:[e.jsx("option",{value:"",children:"Team wählen"}),L.filter(c=>c.value!=="Ehemalige").map(c=>e.jsx("option",{value:c.value,children:q(c.value)},c.value))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text-primary mb-2",children:"Spieler *"}),e.jsxs("select",{value:i.player_id,onChange:c=>o("player_id",c.target.value),className:"form-input",required:!0,disabled:j||!t,children:[e.jsx("option",{value:"",children:t?"Spieler wählen":"Bitte zuerst Team wählen"}),r().map(c=>e.jsxs("option",{value:c.id,children:[c.name," (",c.position,")"]},c.id))]}),t&&r().length===0&&e.jsx("p",{className:"text-xs text-text-muted mt-1",children:"Keine Spieler im gewählten Team verfügbar."})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text-primary mb-2",children:"Sperrart *"}),e.jsxs("select",{value:i.type,onChange:c=>o("type",c.target.value),className:"form-input",required:!0,disabled:j,children:[e.jsx("option",{value:"",children:"Sperrart wählen"}),O.map(c=>e.jsxs("option",{value:c.value,children:[c.icon," ",c.label,c.fixedDuration?` (${c.duration} Spiel${c.duration!==1?"e":""})`:` (1-${c.maxDuration} Spiele)`]},c.value))]})]}),k&&!k.fixedDuration&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text-primary mb-2",children:"Anzahl Spiele *"}),e.jsx("select",{value:i.customDuration,onChange:c=>o("customDuration",parseInt(c.target.value)),className:"form-input",required:!0,disabled:j,children:Array.from({length:k.maxDuration},(c,T)=>T+1).map(c=>e.jsxs("option",{value:c,children:[c," Spiel",c!==1?"e":""]},c))}),e.jsxs("p",{className:"text-xs text-text-muted mt-1",children:["Wählen Sie zwischen ",k.minDuration," und ",k.maxDuration," Spielen"]})]}),k&&k.fixedDuration&&e.jsx("div",{className:"p-3 bg-blue-50 rounded-lg border border-blue-200",children:e.jsxs("p",{className:"text-sm text-blue-800",children:[e.jsx("i",{className:"fas fa-info-circle mr-2"}),"Gelb-Rote Karten haben immer eine feste Sperre von 1 Spiel."]})}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text-primary mb-2",children:"Zusätzlicher Grund (optional)"}),e.jsx("input",{type:"text",value:i.reason,onChange:c=>o("reason",c.target.value),className:"form-input",placeholder:"Weitere Details zur Sperre...",disabled:j})]}),e.jsxs("div",{className:"flex gap-3 pt-4",children:[e.jsx("button",{type:"button",onClick:()=>s(!1),className:"flex-1 px-4 py-2 border border-border-light rounded-lg text-text-secondary hover:bg-bg-tertiary transition-colors",disabled:j,children:"Abbrechen"}),e.jsx("button",{type:"submit",disabled:!y||j||!N||N.length===0,className:"flex-1 btn-primary disabled:opacity-50 disabled:cursor-not-allowed",children:j?e.jsxs("div",{className:"flex items-center justify-center",children:[e.jsx("div",{className:"spinner w-4 h-4 mr-2"}),"Speichern..."]}):"Speichern"})]})]})]})})}),e.jsxs("div",{className:"mt-6 modern-card",children:[e.jsx("h4",{className:"font-semibold text-text-primary mb-3",children:"Verfügbare Sperrarten"}),e.jsx("div",{className:"space-y-2",children:O.map(c=>e.jsxs("div",{className:"flex justify-between items-center p-3 bg-bg-secondary rounded-lg",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx("span",{className:"text-xl mr-2",children:c.icon}),e.jsx("span",{className:"font-medium text-text-primary",children:c.label})]}),e.jsx("span",{className:"text-sm text-text-muted",children:c.fixedDuration?`${c.duration} Spiel${c.duration!==1?"e":""} (fest)`:`1-${c.maxDuration} Spiele (variabel)`})]},c.value))})]}),e.jsx("div",{className:"mt-6 modern-card bg-yellow-50 border-yellow-200",children:e.jsxs("div",{className:"flex items-start",children:[e.jsx("div",{className:"text-yellow-600 mr-3",children:e.jsx("i",{className:"fas fa-info-circle"})}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold text-yellow-800 mb-1",children:"Hinweis"}),e.jsx("p",{className:"text-yellow-700 text-sm",children:"Nach dem Hinzufügen können Sie die Sperre in der Sperren-Übersicht einsehen und verwalten."})]})]})})]})}const Q=[{value:"TH",label:"Torwart (TH)"},{value:"IV",label:"Innenverteidiger (IV)"},{value:"AV",label:"Außenverteidiger (AV)"},{value:"ZM",label:"Zentrales Mittelfeld (ZM)"},{value:"OM",label:"Offensives Mittelfeld (OM)"},{value:"ST",label:"Stürmer (ST)"}];function ne(){const[N,d]=D.useState(!1),[s,t]=D.useState({name:"",team:"",position:"",goals:0,value:0}),[a,i]=D.useState(!1),h=(o,r)=>{t(v=>({...v,[o]:r}))},j=async o=>{o.preventDefault(),i(!0);try{const r=await w.select("players","*",{eq:{name:s.name.trim(),team:s.team.trim()}});if(r.data&&r.data.length>0)throw new Error(`Spieler "${s.name}" existiert bereits im Team "${s.team}"`);const v=await w.insert("players",{name:s.name.trim(),team:s.team.trim(),position:s.position.trim().toUpperCase(),goals:parseInt(s.goals)||0,value:parseFloat(s.value)||0});if(v.error)throw new Error(`Player insert failed: ${v.error.message}`);t({name:"",team:"",position:"",goals:0,value:0}),d(!1),M.success(`Spieler "${s.name}" erfolgreich hinzugefügt!`)}catch(r){console.error("Player submission error:",r),M.error(r.message||"Fehler beim Hinzufügen des Spielers")}finally{i(!1)}},p=s.name&&s.team&&s.position&&s.value!=="";return e.jsxs("div",{className:"p-4",children:[e.jsxs("div",{className:"mb-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-text-primary mb-2",children:"Neuen Spieler hinzufügen"}),e.jsx("p",{className:"text-text-muted text-sm",children:"Fügen Sie einen neuen Spieler zur Datenbank hinzu."})]}),e.jsx("div",{className:"modern-card",children:e.jsxs("div",{className:"text-center py-8",children:[e.jsx("div",{className:"text-4xl mb-4",children:"👤"}),e.jsxs("h4",{className:"text-lg font-medium text-text-primary mb-2",children:[e.jsx("i",{className:"fas fa-user-plus mr-2"}),"Spieler hinzufügen"]}),e.jsx("p",{className:"text-text-muted mb-6",children:"Klicken Sie auf den Button, um einen neuen Spieler zu erfassen."}),e.jsxs("button",{onClick:()=>d(!0),className:"btn-primary",children:[e.jsx("i",{className:"fas fa-plus mr-2"}),"Neuen Spieler erfassen"]})]})}),N&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-[60] p-4",children:e.jsx("div",{className:"bg-bg-secondary rounded-lg max-w-md w-full modal-content",children:e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsx("h3",{className:"text-xl font-semibold text-text-primary",children:"Neuer Spieler"}),e.jsx("button",{onClick:()=>d(!1),className:"text-text-muted hover:text-text-primary text-2xl",disabled:a,children:"×"})]}),e.jsxs("form",{onSubmit:j,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text-primary mb-2",children:"Spielername *"}),e.jsx("input",{type:"text",value:s.name,onChange:o=>h("name",o.target.value),className:"form-input",placeholder:"z.B. Max Mustermann",required:!0,disabled:a})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text-primary mb-2",children:"Team *"}),e.jsxs("select",{value:s.team,onChange:o=>h("team",o.target.value),className:"form-input",required:!0,disabled:a,children:[e.jsx("option",{value:"",children:"Team wählen"}),L.map(o=>e.jsx("option",{value:o.value,children:q(o.value)},o.value))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text-primary mb-2",children:"Position *"}),e.jsxs("select",{value:s.position,onChange:o=>h("position",o.target.value),className:"form-input",required:!0,disabled:a,children:[e.jsx("option",{value:"",children:"Position wählen"}),Q.map(o=>e.jsx("option",{value:o.value,children:o.label},o.value))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text-primary mb-2",children:"Marktwert (Millionen €) *"}),e.jsx("input",{type:"number",min:"0",step:"0.1",value:s.value,onChange:o=>h("value",o.target.value),className:"form-input",placeholder:"0.0",disabled:a}),e.jsx("p",{className:"text-xs text-text-muted mt-1",children:"Marktwert in Millionen Euro (z.B. 1.5 für 1.5M €)"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text-primary mb-2",children:"Anzahl Tore"}),e.jsx("input",{type:"number",min:"0",value:s.goals,onChange:o=>h("goals",o.target.value),className:"form-input",placeholder:"0",disabled:a})]}),e.jsxs("div",{className:"flex gap-3 pt-4",children:[e.jsx("button",{type:"button",onClick:()=>d(!1),className:"flex-1 px-4 py-2 border border-border-light rounded-lg text-text-secondary hover:bg-bg-tertiary transition-colors",disabled:a,children:"Abbrechen"}),e.jsx("button",{type:"submit",disabled:!p||a,className:"flex-1 btn-primary disabled:opacity-50 disabled:cursor-not-allowed",children:a?e.jsxs("div",{className:"flex items-center justify-center",children:[e.jsx("div",{className:"spinner w-4 h-4 mr-2"}),"Speichern..."]}):"Speichern"})]})]})]})})}),e.jsxs("div",{className:"mt-6 modern-card",children:[e.jsx("h4",{className:"font-semibold text-text-primary mb-3",children:"Verfügbare Teams"}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-2",children:L.map(o=>e.jsxs("div",{className:"p-3 bg-bg-secondary rounded-lg text-center",children:[e.jsx("span",{className:`font-medium ${o.color==="blue"?"text-blue-600":o.color==="red"?"text-red-600":"text-gray-600"}`,children:q(o.value)}),e.jsxs("div",{className:"text-xs text-text-muted mt-1",children:["(",o.value,")"]})]},o.value))})]}),e.jsxs("div",{className:"mt-6 modern-card",children:[e.jsx("h4",{className:"font-semibold text-text-primary mb-3",children:"Verfügbare Positionen"}),e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-2",children:Q.map(o=>e.jsx("div",{className:"p-3 bg-bg-secondary rounded-lg text-center",children:e.jsx("span",{className:"font-medium text-text-primary text-sm",children:o.label})},o.value))})]}),e.jsx("div",{className:"mt-6 modern-card bg-green-50 border-green-200",children:e.jsxs("div",{className:"flex items-start",children:[e.jsx("div",{className:"text-green-600 mr-3",children:e.jsx("i",{className:"fas fa-info-circle"})}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold text-green-800 mb-1",children:"Hinweis"}),e.jsx("p",{className:"text-green-700 text-sm",children:"Nach dem Hinzufügen können Sie den Spieler in der Kader-Übersicht einsehen und verwalten."})]})]})})]})}const Y=[{value:"Preisgeld",label:"Preisgeld",icon:"🏆"},{value:"Strafe",label:"Strafe",icon:"📉"},{value:"Spielerkauf",label:"Spielerkauf",icon:"👤"},{value:"Spielerverkauf",label:"Spielerverkauf",icon:"💰"},{value:"Echtgeld-Ausgleich",label:"Echtgeld-Ausgleich",icon:"💳"},{value:"SdS Bonus",label:"Spieler des Spiels Bonus",icon:"⭐"},{value:"Sonstiges",label:"Sonstiges",icon:"📈"}];function re(){const[N,d]=D.useState(!1),[s,t]=D.useState({team:"",type:"",amount:"",info:"",date:new Date().toISOString().split("T")[0]}),[a,i]=D.useState(!1),h=(r,v)=>{t(y=>({...y,[r]:v}))},j=async r=>{r.preventDefault(),i(!0);try{const v=parseFloat(s.amount),y=await w.insert("transactions",{date:s.date,type:s.type.trim(),team:s.team.trim(),amount:v,info:s.info.trim(),match_id:null});if(y.error)throw new Error(`Transaction insert failed: ${y.error.message}`);await p(s.team.trim(),s.type.trim(),v),t({team:"",type:"",amount:"",info:"",date:new Date().toISOString().split("T")[0]}),d(!1),M.success("Transaktion erfolgreich hinzugefügt!")}catch(v){console.error("Transaction submission error:",v),M.error(v.message||"Fehler beim Hinzufügen der Transaktion")}finally{i(!1)}},p=async(r,v,y)=>{try{const k=await w.select("finances","*",{eq:{team:r}});let c=k.data&&k.data.length>0?k.data[0]:{team:r,balance:0,debt:0},T={};if(v==="Echtgeld-Ausgleich")T.debt=(c.debt||0)+y;else{let S=(c.balance||0)+y;S<0&&(S=0),T.balance=S}c.id?await w.update("finances",T,c.id):await w.insert("finances",{team:r,balance:T.balance||0,debt:T.debt||0})}catch(k){console.warn("Failed to update finances:",k)}},o=s.team&&s.type&&s.amount&&s.date;return e.jsxs("div",{className:"p-4",children:[e.jsxs("div",{className:"mb-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-text-primary mb-2",children:"Neue Transaktion hinzufügen"}),e.jsx("p",{className:"text-text-muted text-sm",children:"Erfassen Sie eine neue finanzielle Transaktion."})]}),e.jsx("div",{className:"modern-card",children:e.jsxs("div",{className:"text-center py-8",children:[e.jsx("div",{className:"text-4xl mb-4",children:"💰"}),e.jsx("h4",{className:"text-lg font-medium text-text-primary mb-2",children:"Transaktion hinzufügen"}),e.jsx("p",{className:"text-text-muted mb-6",children:"Klicken Sie auf den Button, um eine neue Transaktion zu erfassen."}),e.jsxs("button",{onClick:()=>d(!0),className:"btn-primary",children:[e.jsx("i",{className:"fas fa-plus mr-2"}),"Neue Transaktion erfassen"]})]})}),N&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-[60] p-4",children:e.jsx("div",{className:"bg-bg-secondary rounded-lg max-w-md w-full modal-content",children:e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsx("h3",{className:"text-xl font-semibold text-text-primary",children:"Neue Transaktion"}),e.jsx("button",{onClick:()=>d(!1),className:"text-text-muted hover:text-text-primary text-2xl",disabled:a,children:"×"})]}),e.jsxs("form",{onSubmit:j,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text-primary mb-2",children:"Team *"}),e.jsxs("select",{value:s.team,onChange:r=>h("team",r.target.value),className:"form-input",required:!0,disabled:a,children:[e.jsx("option",{value:"",children:"Team wählen"}),L.filter(r=>r.value!=="Ehemalige").map(r=>e.jsx("option",{value:r.value,children:q(r.value)},r.value))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text-primary mb-2",children:"Transaktionsart *"}),e.jsxs("select",{value:s.type,onChange:r=>h("type",r.target.value),className:"form-input",required:!0,disabled:a,children:[e.jsx("option",{value:"",children:"Typ wählen"}),Y.map(r=>e.jsxs("option",{value:r.value,children:[r.icon," ",r.label]},r.value))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text-primary mb-2",children:"Betrag (€) *"}),e.jsx("input",{type:"number",step:"0.01",value:s.amount,onChange:r=>h("amount",r.target.value),className:"form-input",placeholder:"0.00",required:!0,disabled:a}),e.jsx("p",{className:"text-xs text-text-muted mt-1",children:"Negative Werte für Ausgaben, positive für Einnahmen"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text-primary mb-2",children:"Beschreibung"}),e.jsx("input",{type:"text",value:s.info,onChange:r=>h("info",r.target.value),className:"form-input",placeholder:"Zusätzliche Informationen...",disabled:a})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text-primary mb-2",children:"Datum *"}),e.jsx("input",{type:"date",value:s.date,onChange:r=>h("date",r.target.value),className:"form-input",required:!0,disabled:a})]}),e.jsxs("div",{className:"flex gap-3 pt-4",children:[e.jsx("button",{type:"button",onClick:()=>d(!1),className:"flex-1 px-4 py-2 border border-border-light rounded-lg text-text-secondary hover:bg-bg-tertiary transition-colors",disabled:a,children:"Abbrechen"}),e.jsx("button",{type:"submit",disabled:!o||a,className:"flex-1 btn-primary disabled:opacity-50 disabled:cursor-not-allowed",children:a?e.jsxs("div",{className:"flex items-center justify-center",children:[e.jsx("div",{className:"spinner w-4 h-4 mr-2"}),"Speichern..."]}):"Speichern"})]})]})]})})}),e.jsxs("div",{className:"mt-6 modern-card",children:[e.jsx("h4",{className:"font-semibold text-text-primary mb-3",children:"Transaktionsarten"}),e.jsx("div",{className:"grid grid-cols-2 gap-2",children:Y.map(r=>e.jsxs("div",{className:"p-3 bg-bg-secondary rounded-lg text-center",children:[e.jsx("div",{className:"text-2xl mb-2",children:r.icon}),e.jsx("span",{className:"font-medium text-text-primary",children:r.label})]},r.value))})]}),e.jsxs("div",{className:"mt-6 modern-card",children:[e.jsx("h4",{className:"font-semibold text-text-primary mb-3",children:"Verfügbare Teams"}),e.jsx("div",{className:"grid grid-cols-2 gap-2",children:L.filter(r=>r.value!=="Ehemalige").map(r=>e.jsxs("div",{className:"p-3 bg-bg-secondary rounded-lg text-center",children:[e.jsx("span",{className:`font-medium ${r.color==="blue"?"text-blue-600":"text-red-600"}`,children:q(r.value)}),e.jsxs("div",{className:"text-xs text-text-muted mt-1",children:["(",r.value,")"]})]},r.value))})]}),e.jsx("div",{className:"mt-6 modern-card bg-blue-50 border-blue-200",children:e.jsxs("div",{className:"flex items-start",children:[e.jsx("div",{className:"text-blue-600 mr-3",children:e.jsx("i",{className:"fas fa-info-circle"})}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold text-blue-800 mb-1",children:"Hinweis"}),e.jsx("p",{className:"text-blue-700 text-sm",children:"Nach dem Hinzufügen können Sie die Transaktion in der Finanzen-Übersicht einsehen."})]})]})})]})}function ie(){var H;const[N,d]=D.useState("players"),[s,t]=D.useState(!1),[a,i]=D.useState(""),{data:h,refetch:j}=G("players","*",{order:{column:"id",ascending:!1}}),{data:p,refetch:o}=G("matches","*",{order:{column:"date",ascending:!1}}),{data:r,refetch:v}=G("bans","*",{order:{column:"id",ascending:!1}}),{data:y,refetch:k}=G("transactions","*",{order:{column:"date",ascending:!1}}),{remove:c}=V("players"),{remove:T}=V("bans"),{remove:S}=V("transactions"),E=[{id:"players",label:"Spieler löschen",icon:"fas fa-users"},{id:"matches",label:"Spiele löschen",icon:"fas fa-futbol"},{id:"bans",label:"Sperren löschen",icon:"fas fa-ban"},{id:"transactions",label:"Transaktionen löschen",icon:"fas fa-euro-sign"}],B=n=>{d(n),i("")},l=()=>{switch(N){case"players":return{total:(h==null?void 0:h.length)||0,filtered:F(h).length};case"matches":return{total:(p==null?void 0:p.length)||0,filtered:_(p).length};case"bans":return{total:(r==null?void 0:r.length)||0,filtered:R(r).length};case"transactions":return{total:(y==null?void 0:y.length)||0,filtered:z(y).length};default:return{total:0,filtered:0}}},b=async n=>{const m=(r==null?void 0:r.filter(u=>u.player_id===n.id||u.player_name===n.name))||[];let f=`Sind Sie sicher, dass Sie ${n.name} (${n.team}) löschen möchten?`;if(m.length>0&&(f+=`

Achtung: ${m.length} zugehörige Sperre(n) werden ebenfalls gelöscht.`),n.goals&&n.goals>0&&(f+=`
Der Spieler hat ${n.goals} Tor(e) erzielt.`),!!confirm(f)){t(!0);try{await c(n.id),M.success(`Spieler ${n.name} erfolgreich gelöscht`),j(),m.length>0&&v()}catch(u){M.error("Fehler beim Löschen des Spielers: "+u.message)}finally{t(!1)}}},x=async n=>{const m=(y==null?void 0:y.filter(A=>A.match_id===n.id))||[],f=`AEK ${n.goalsa||0} - ${n.goalsb||0} Real`;let u=`Sind Sie sicher, dass Sie das Spiel vom ${new Date(n.date).toLocaleDateString("de-DE")} (${f}) löschen möchten?`;if(m.length>0&&(u+=`

Achtung: ${m.length} zugehörige Transaktion(en) werden ebenfalls gelöscht.`),n.manofthematch&&(u+=`
Spieler des Spiels: ${n.manofthematch}`),!!confirm(u)){t(!0);try{const{deleteMatch:A}=await ae(async()=>{const{deleteMatch:$}=await import("./matches-Bz0wv9ua.js");return{deleteMatch:$}},__vite__mapDeps([0,1]));await A(n.id),M.success("Spiel erfolgreich gelöscht"),o(),m.length>0&&k()}catch(A){M.error("Fehler beim Löschen des Spiels: "+A.message)}finally{t(!1)}}},g=async n=>{var A;const m=n.player_name||(n.player_id&&h?(A=h.find($=>$.id===n.player_id))==null?void 0:A.name:"Unbekannter Spieler"),f=Math.max(0,(n.totalgames||0)-(n.matchesserved||0));let u=`Sind Sie sicher, dass Sie die Sperre für ${m} löschen möchten?`;if(u+=`
Sperrtyp: ${n.type}`,f>0?u+=`
Noch ${f} Spiel(e) verbleibend`:u+=`
Sperre bereits abgesessen`,n.reason&&(u+=`
Grund: ${n.reason}`),!!confirm(u)){t(!0);try{await T(n.id),M.success(`Sperre für ${m} erfolgreich gelöscht`),v()}catch($){M.error("Fehler beim Löschen der Sperre: "+$.message)}finally{t(!1)}}},C=async n=>{const m=n.match_id&&p?p.find(u=>u.id===n.match_id):null;let f=`Sind Sie sicher, dass Sie die Transaktion "${n.type}" löschen möchten?`;if(f+=`
Betrag: ${n.amount>0?"+":""}${n.amount}M € (${n.team})`,n.date&&(f+=`
Datum: ${new Date(n.date).toLocaleDateString("de-DE")}`),n.info&&(f+=`
Info: ${n.info}`),m&&(f+=`
Zugehöriges Spiel: ${new Date(m.date).toLocaleDateString("de-DE")} (AEK ${m.goalsa||0} - ${m.goalsb||0} Real)`),!!confirm(f)){t(!0);try{await S(n.id),M.success("Transaktion erfolgreich gelöscht"),k()}catch(u){M.error("Fehler beim Löschen der Transaktion: "+u.message)}finally{t(!1)}}},K=n=>{const m=L.find(f=>f.value===n);return m?m.icon:"⚫"},F=n=>a?(n||[]).filter(m=>{var f,u,A;return((f=m.name)==null?void 0:f.toLowerCase().includes(a.toLowerCase()))||((u=m.team)==null?void 0:u.toLowerCase().includes(a.toLowerCase()))||((A=m.position)==null?void 0:A.toLowerCase().includes(a.toLowerCase()))}):n||[],_=n=>a?(n||[]).filter(m=>{var f;return new Date(m.date).toLocaleDateString("de-DE").includes(a)||((f=m.manofthematch)==null?void 0:f.toLowerCase().includes(a.toLowerCase()))}):n||[],R=n=>a?(n||[]).filter(m=>{var u,A,$,W;const f=m.player_name||(m.player_id&&h?(u=h.find(te=>te.id===m.player_id))==null?void 0:u.name:"");return(f==null?void 0:f.toLowerCase().includes(a.toLowerCase()))||((A=m.type)==null?void 0:A.toLowerCase().includes(a.toLowerCase()))||(($=m.team)==null?void 0:$.toLowerCase().includes(a.toLowerCase()))||((W=m.reason)==null?void 0:W.toLowerCase().includes(a.toLowerCase()))}):n||[],z=n=>a?(n||[]).filter(m=>{var f,u,A,$;return((f=m.type)==null?void 0:f.toLowerCase().includes(a.toLowerCase()))||((u=m.team)==null?void 0:u.toLowerCase().includes(a.toLowerCase()))||((A=m.info)==null?void 0:A.toLowerCase().includes(a.toLowerCase()))||(($=m.amount)==null?void 0:$.toString().includes(a))}):n||[],P=()=>{const n=F(h);return!n||n.length===0?e.jsx("p",{className:"text-text-muted text-center py-4",children:a?"Keine Spieler gefunden":"Keine Spieler vorhanden"}):e.jsx("div",{className:"space-y-2",children:n.map(m=>e.jsxs("div",{className:"flex items-center justify-between p-3 bg-bg-tertiary rounded-lg",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("span",{className:"text-lg",children:K(m.team)}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-text-primary",children:m.name}),e.jsxs("p",{className:"text-sm text-text-muted",children:[m.team," • ",m.position,m.goals!==void 0&&e.jsxs("span",{className:"ml-2",children:["• ",m.goals," Tore"]})]})]})]}),e.jsxs("button",{onClick:()=>b(m),disabled:s,className:"btn-secondary btn-sm text-accent-red hover:bg-red-50 disabled:opacity-50",children:[e.jsx("i",{className:"fas fa-trash mr-1"}),"Löschen"]})]},m.id))})},I=()=>{const n=_(p);return!n||n.length===0?e.jsx("p",{className:"text-text-muted text-center py-4",children:a?"Keine Spiele gefunden":"Keine Spiele vorhanden"}):e.jsx("div",{className:"space-y-2",children:n.map(m=>e.jsxs("div",{className:"flex items-center justify-between p-3 bg-bg-tertiary rounded-lg",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-text-primary",children:new Date(m.date).toLocaleDateString("de-DE")}),e.jsxs("p",{className:"text-sm text-text-muted",children:["AEK ",m.goalsa||0," - ",m.goalsb||0," Real"]}),m.manofthematch&&e.jsxs("p",{className:"text-xs text-text-muted mt-1",children:[e.jsx("i",{className:"fas fa-star mr-1"}),"SdS: ",m.manofthematch]})]}),e.jsxs("button",{onClick:()=>x(m),disabled:s,className:"btn-secondary btn-sm text-accent-red hover:bg-red-50 disabled:opacity-50",children:[e.jsx("i",{className:"fas fa-trash mr-1"}),"Löschen"]})]},m.id))})},J=()=>{const n=R(r);if(!n||n.length===0)return e.jsx("p",{className:"text-text-muted text-center py-4",children:a?"Keine Sperren gefunden":"Keine Sperren vorhanden"});const m=u=>{if(u.player_name)return u.player_name;if(u.player_id&&h){const A=h.find($=>$.id===u.player_id);return A?A.name:"Unbekannter Spieler"}return"Unbekannter Spieler"},f=u=>{const A=(u.totalgames||0)-(u.matchesserved||0);return Math.max(0,A)};return e.jsx("div",{className:"space-y-2",children:n.map(u=>e.jsxs("div",{className:"flex items-center justify-between p-3 bg-bg-tertiary rounded-lg",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("span",{className:"text-lg",children:K(u.team)}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-text-primary",children:m(u)}),e.jsxs("p",{className:"text-sm text-text-muted",children:[u.type," • ",u.totalgames||0," Spiele",f(u)>0?` (${f(u)} verbleibend)`:" (abgesessen)"]}),u.reason&&e.jsxs("p",{className:"text-xs text-text-muted mt-1",children:["Grund: ",u.reason]})]})]}),e.jsxs("button",{onClick:()=>g(u),disabled:s,className:"btn-secondary btn-sm text-accent-red hover:bg-red-50 disabled:opacity-50",children:[e.jsx("i",{className:"fas fa-trash mr-1"}),"Löschen"]})]},u.id))})},X=()=>{const n=z(y);if(!n||n.length===0)return e.jsx("p",{className:"text-text-muted text-center py-4",children:a?"Keine Transaktionen gefunden":"Keine Transaktionen vorhanden"});const m=f=>{if(!f.match_id||!p)return null;const u=p.find(A=>A.id===f.match_id);return u?`Match: ${new Date(u.date).toLocaleDateString("de-DE")} (AEK ${u.goalsa||0} - ${u.goalsb||0} Real)`:null};return e.jsx("div",{className:"space-y-2",children:n.map(f=>e.jsxs("div",{className:"flex items-center justify-between p-3 bg-bg-tertiary rounded-lg",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("span",{className:"text-lg",children:K(f.team)}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h4",{className:"font-medium text-text-primary",children:f.type}),e.jsxs("p",{className:"text-sm text-text-muted",children:[e.jsxs("span",{className:f.amount>0?"text-green-600":"text-red-600",children:[f.amount>0?"+":"",f.amount,"M €"]}),f.date&&e.jsxs("span",{className:"ml-2",children:["• ",new Date(f.date).toLocaleDateString("de-DE")]})]}),f.info&&e.jsx("p",{className:"text-xs text-text-muted mt-1",children:f.info}),m(f)&&e.jsxs("p",{className:"text-xs text-blue-600 mt-1",children:[e.jsx("i",{className:"fas fa-futbol mr-1"}),m(f)]})]})]}),e.jsxs("button",{onClick:()=>C(f),disabled:s,className:"btn-secondary btn-sm text-accent-red hover:bg-red-50 disabled:opacity-50",children:[e.jsx("i",{className:"fas fa-trash mr-1"}),"Löschen"]})]},f.id))})},ee=()=>{switch(N){case"players":return P();case"matches":return I();case"bans":return J();case"transactions":return X();default:return P()}};return e.jsxs("div",{className:"p-4",children:[e.jsxs("div",{className:"mb-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-text-primary mb-2",children:"Daten löschen"}),e.jsx("p",{className:"text-text-muted text-sm",children:"Verwalten Sie die Löschung von Spielern, Spielen, Sperren und Transaktionen."})]}),e.jsx("div",{className:"grid grid-cols-2 gap-2 mb-6",children:E.map(n=>e.jsxs("button",{onClick:()=>B(n.id),className:`p-3 rounded-lg text-sm font-medium transition-colors ${N===n.id?"bg-accent-red text-white":"bg-bg-tertiary text-text-secondary hover:text-text-primary hover:bg-bg-hover"}`,children:[e.jsx("i",{className:`${n.icon} mr-2`}),n.label]},n.id))}),e.jsxs("div",{className:"mb-4",children:[e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:"text",placeholder:`${(H=E.find(n=>n.id===N))==null?void 0:H.label.replace(" löschen","")} durchsuchen...`,value:a,onChange:n=>i(n.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-accent-red focus:border-transparent text-text-primary bg-bg-secondary"}),e.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:e.jsx("i",{className:"fas fa-search text-text-muted"})}),a&&e.jsx("button",{onClick:()=>i(""),className:"absolute inset-y-0 right-0 pr-3 flex items-center text-text-muted hover:text-text-primary",children:e.jsx("i",{className:"fas fa-times"})})]}),e.jsxs("div",{className:"flex justify-between items-center mt-2",children:[a&&e.jsxs("p",{className:"text-xs text-text-muted",children:[e.jsx("i",{className:"fas fa-filter mr-1"}),"Gefiltert nach: “",a,"”"]}),e.jsx("p",{className:"text-xs text-text-muted ml-auto",children:(()=>{const n=l();return a?`${n.filtered} von ${n.total} Einträgen`:`${n.total} Einträge`})()})]})]}),e.jsxs("div",{className:"modern-card",children:[s&&e.jsx(se,{message:"Lösche..."}),!s&&ee()]}),e.jsx("div",{className:"mt-6 modern-card bg-red-50 border-red-200",children:e.jsxs("div",{className:"flex items-start",children:[e.jsx("div",{className:"text-red-600 mr-3",children:e.jsx("i",{className:"fas fa-exclamation-triangle"})}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold text-red-800 mb-1",children:"Achtung"}),e.jsx("p",{className:"text-red-700 text-sm",children:"Das Löschen von Daten ist permanent und kann nicht rückgängig gemacht werden. Bitte überprüfen Sie Ihre Auswahl sorgfältig, bevor Sie fortfahren."})]})]})})]})}function oe({onLogout:N}){const[d,s]=D.useState("matches"),t=[{id:"matches",label:"Spiele hinzufügen",icon:"fas fa-futbol"},{id:"bans",label:"Sperren hinzufügen",icon:"fas fa-ban"},{id:"players",label:"Spieler hinzufügen",icon:"fas fa-users"},{id:"transactions",label:"Transaktionen hinzufügen",icon:"fas fa-euro-sign"},{id:"delete",label:"Daten löschen",icon:"fas fa-trash"}],a=()=>{switch(d){case"matches":return e.jsx(U,{});case"bans":return e.jsx(le,{});case"players":return e.jsx(ne,{});case"transactions":return e.jsx(re,{});case"delete":return e.jsx(ie,{});default:return e.jsx(U,{})}};return e.jsxs("div",{className:"flex flex-col h-full",children:[e.jsxs("div",{className:"p-4 bg-bg-secondary border-b border-border-light flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-semibold text-text-primary mb-1",children:"Verwaltung"}),e.jsx("p",{className:"text-text-muted text-sm",children:"Hinzufügen und verwalten von Daten"})]}),e.jsxs("button",{onClick:N,className:"flex items-center px-3 py-2 bg-accent-red text-white rounded-lg hover:bg-red-600 transition-colors focus:outline-none focus:ring-2 focus:ring-red-500 focus:ring-opacity-50","aria-label":"Abmelden",children:[e.jsx("i",{className:"fas fa-sign-out-alt mr-2"}),e.jsx("span",{className:"text-sm",children:"Logout"})]})]}),e.jsx("div",{className:"bg-bg-secondary border-b border-border-light",children:e.jsx("div",{className:"flex overflow-x-auto",children:t.map(i=>e.jsxs("button",{onClick:()=>s(i.id),className:`flex-shrink-0 px-4 py-3 text-sm font-medium transition-colors whitespace-nowrap ${d===i.id?"text-primary-green border-b-2 border-primary-green bg-bg-primary":"text-text-secondary hover:text-text-primary hover:bg-bg-hover"}`,children:[e.jsx("i",{className:`${i.icon} mr-2`}),i.label]},i.id))})}),e.jsx("div",{className:"flex-1 overflow-y-auto",children:a()})]})}export{oe as default};
