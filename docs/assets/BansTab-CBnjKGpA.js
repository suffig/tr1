import{r as K,j as t,L as R}from"./index-CYy020bc.js";import{u as h,a as L}from"./useSupabase-Cftv23Fu.js";const d=[{value:"Gelb-Rote Karte",label:"Gelb-Rote Karte",duration:1},{value:"Rote Karte",label:"Rote Karte",duration:2},{value:"Verletzung",label:"Verletzung",duration:3}];function C(){const[a,g]=K.useState("all"),{data:r,loading:f,refetch:c}=h("bans","*"),{data:n,loading:b}=h("players","*"),{insert:j,update:N,remove:v}=L("bans"),y=f||b,S=async()=>{if(!n||n.length===0){alert("Keine Spieler gefunden. Bitte fügen Sie erst Spieler hinzu.");return}const e=prompt("Spielername:");if(!e)return;const s=n.find(i=>i.name.toLowerCase().includes(e.toLowerCase()));if(!s){alert("Spieler nicht gefunden. Verfügbare Spieler: "+n.map(i=>i.name).join(", "));return}const l=prompt("Grund (Gelb-Rote Karte, Rote Karte, Verletzung):","Gelb-Rote Karte");if(!l)return;const p=d.find(i=>i.value===l)||d[0];try{await j({spieler_id:s.id,art:p.value,anzahl_spiele:p.duration,beschreibung:"",datum:new Date().toISOString().split("T")[0]}),c()}catch(i){alert("Fehler beim Hinzufügen der Sperre: "+i.message)}},k=async e=>{if(!(e.anzahl_spiele<=0))try{await N({anzahl_spiele:e.anzahl_spiele-1},e.id),c()}catch(s){alert("Fehler beim Reduzieren der Sperre: "+s.message)}},z=async e=>{const s=o(e.spieler_id);if(confirm(`Sind Sie sicher, dass Sie die Sperre von ${s} löschen möchten?`))try{await v(e.id),c()}catch(l){alert("Fehler beim Löschen der Sperre: "+l.message)}},o=e=>{if(!n)return"Unbekannt";const s=n.find(l=>l.id===e);return(s==null?void 0:s.name)||"Unbekannt"},w=e=>{if(!n)return"Unbekannt";const s=n.find(l=>l.id===e);return(s==null?void 0:s.team)||"Unbekannt"},_=e=>{switch(e){case"Gelb-Rote Karte":return"bg-yellow-100 text-yellow-800 border-yellow-200";case"Rote Karte":return"bg-red-100 text-red-800 border-red-200";case"Verletzung":return"bg-orange-100 text-orange-800 border-orange-200";default:return"bg-gray-100 text-gray-800 border-gray-200"}},B=e=>{switch(e){case"Gelb-Rote Karte":return"🟨🟥";case"Rote Karte":return"🟥";case"Verletzung":return"🏥";default:return"⚠️"}},m=(r==null?void 0:r.filter(e=>a==="all"?!0:a==="active"?e.anzahl_spiele>0:a==="completed"?e.anzahl_spiele===0:e.art===a))||[],x=(r==null?void 0:r.filter(e=>e.anzahl_spiele>0))||[],u=(r==null?void 0:r.filter(e=>e.anzahl_spiele===0))||[];return y?t.jsx(R,{message:"Lade Sperren..."}):t.jsxs("div",{className:"p-4 pb-20",children:[t.jsxs("div",{className:"mb-6",children:[t.jsx("h2",{className:"text-xl font-semibold text-text-primary mb-4",children:"Sperren-Übersicht"}),t.jsx("div",{className:"flex flex-wrap gap-2 mb-4",children:[{key:"all",label:"Alle",count:(r==null?void 0:r.length)||0},{key:"active",label:"Aktiv",count:x.length},{key:"completed",label:"Beendet",count:u.length},...d.map(e=>({key:e.value,label:e.label,count:(r==null?void 0:r.filter(s=>s.art===e.value).length)||0}))].map(e=>t.jsxs("button",{onClick:()=>g(e.key),className:`px-3 py-2 rounded-lg text-sm font-medium transition-all ${a===e.key?"bg-primary-green text-white":"bg-bg-secondary text-text-muted hover:bg-bg-tertiary border border-border-light"}`,children:[e.label," (",e.count,")"]},e.key))})]}),t.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 mb-6",children:[t.jsxs("div",{className:"modern-card text-center",children:[t.jsx("div",{className:"text-2xl font-bold text-accent-red",children:x.length}),t.jsx("div",{className:"text-sm text-text-muted",children:"Aktive Sperren"})]}),t.jsxs("div",{className:"modern-card text-center",children:[t.jsx("div",{className:"text-2xl font-bold text-primary-green",children:u.length}),t.jsx("div",{className:"text-sm text-text-muted",children:"Beendete Sperren"})]}),t.jsxs("div",{className:"modern-card text-center",children:[t.jsx("div",{className:"text-2xl font-bold text-accent-orange",children:(r==null?void 0:r.length)||0}),t.jsx("div",{className:"text-sm text-text-muted",children:"Gesamt Sperren"})]}),t.jsxs("div",{className:"modern-card text-center",children:[t.jsx("div",{className:"text-2xl font-bold text-accent-blue",children:d.length}),t.jsx("div",{className:"text-sm text-text-muted",children:"Sperr-Arten"})]})]}),m.length>0?t.jsx("div",{className:"space-y-4",children:m.map(e=>t.jsx("div",{className:"modern-card",children:t.jsxs("div",{className:"flex items-start justify-between",children:[t.jsxs("div",{className:"flex items-start space-x-4",children:[t.jsx("div",{className:"text-2xl",children:B(e.art)}),t.jsxs("div",{className:"flex-1",children:[t.jsxs("div",{className:"flex items-center space-x-2 mb-2",children:[t.jsx("h3",{className:"font-semibold text-text-primary",children:o(e.spieler_id)}),t.jsxs("span",{className:"text-sm text-text-muted",children:["(",w(e.spieler_id),")"]})]}),t.jsxs("div",{className:"flex items-center space-x-2 mb-2",children:[t.jsx("span",{className:`inline-block px-2 py-1 rounded text-xs font-medium border ${_(e.art)}`,children:e.art}),e.anzahl_spiele>0?t.jsxs("span",{className:"inline-block px-2 py-1 rounded text-xs font-medium bg-red-100 text-red-800 border border-red-200",children:[e.anzahl_spiele," Spiel",e.anzahl_spiele!==1?"e":""," verbleibend"]}):t.jsx("span",{className:"inline-block px-2 py-1 rounded text-xs font-medium bg-green-100 text-green-800 border border-green-200",children:"Beendet"})]}),e.beschreibung&&t.jsx("p",{className:"text-sm text-text-muted",children:e.beschreibung}),e.datum&&t.jsxs("p",{className:"text-xs text-text-muted mt-2",children:["Erstellt: ",new Date(e.datum).toLocaleDateString("de-DE")]})]})]}),t.jsxs("div",{className:"flex items-center space-x-2",children:[e.anzahl_spiele>0&&t.jsx("button",{onClick:()=>k(e),className:"text-text-muted hover:text-primary-green transition-colors p-1",title:"Sperre reduzieren",children:t.jsx("i",{className:"fas fa-minus text-sm"})}),t.jsx("button",{onClick:()=>z(e),className:"text-text-muted hover:text-accent-red transition-colors p-1",title:"Sperre löschen",children:t.jsx("i",{className:"fas fa-trash text-sm"})})]})]})},e.id))}):t.jsxs("div",{className:"text-center py-12",children:[t.jsx("div",{className:"text-4xl mb-4",children:"🚫"}),t.jsx("h3",{className:"text-lg font-medium text-text-primary mb-2",children:a==="all"?"Keine Sperren gefunden":`Keine ${a==="active"?"aktiven":a==="completed"?"beendeten":a} Sperren`}),t.jsx("p",{className:"text-text-muted",children:a==="all"?"Es wurden noch keine Sperren erstellt.":"Versuche einen anderen Filter oder erstelle neue Sperren."})]}),t.jsx("div",{className:"mt-6",children:t.jsxs("button",{onClick:S,className:"w-full btn-primary",children:[t.jsx("i",{className:"fas fa-plus mr-2"}),"Neue Sperre hinzufügen"]})})]})}export{C as default};
