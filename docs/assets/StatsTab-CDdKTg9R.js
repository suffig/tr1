import{r as V,j as e,L as $}from"./index-Cyu-QkLb.js";import{u as N}from"./useSupabase-UlJNLpe-.js";class z{constructor(a,c,l,t){this.matches=a||[],this.players=c||[],this.bans=l||[],this.spielerDesSpiels=t||[],this.aekPlayers=(c||[]).filter(r=>r.team==="AEK"),this.realPlayers=(c||[]).filter(r=>r.team==="Real")}calculateTeamRecords(){const a={wins:0,losses:0},c={wins:0,losses:0};return this.matches.forEach(l=>{const t=l.goalsa||0,r=l.goalsb||0;t>r?(a.wins++,c.losses++):r>t&&(c.wins++,a.losses++)}),{aek:a,real:c}}calculateRecentForm(a=5){const c=this.matches.slice(-a),l=[],t=[];return c.forEach(r=>{const n=r.goalsa||0,d=r.goalsb||0;n>d?(l.push("W"),t.push("L")):d>n?(l.push("L"),t.push("W")):(l.push("D"),t.push("D"))}),{aek:l,real:t}}calculatePlayerStats(){return this.players.map(a=>{const c=this.countPlayerGoalsFromMatches(a.name,a.team),l=this.countPlayerMatches(a.name,a.team),t=this.bans.filter(d=>d.player_id===a.id),r=this.spielerDesSpiels.find(d=>d.name===a.name&&d.team===a.team),n=r&&r.count||0;return{...a,goals:c,matchesPlayed:l,sdsCount:n,goalsPerGame:l>0?(c/l).toFixed(2):"0.00",totalBans:t.length,disciplinaryScore:this.calculateDisciplinaryScore(t)}}).sort((a,c)=>(c.goals||0)-(a.goals||0))}countPlayerGoalsFromMatches(a,c){let l=0;return this.matches.forEach(t=>{c==="AEK"&&t.goalslista&&(Array.isArray(t.goalslista)?t.goalslista:typeof t.goalslista=="string"?JSON.parse(t.goalslista):[]).forEach(n=>{const d=typeof n=="string"?n:n.player,m=typeof n=="string"?1:n.count||1;d===a&&(l+=m)}),c==="Real"&&t.goalslistb&&(Array.isArray(t.goalslistb)?t.goalslistb:typeof t.goalslistb=="string"?JSON.parse(t.goalslistb):[]).forEach(n=>{const d=typeof n=="string"?n:n.player,m=typeof n=="string"?1:n.count||1;d===a&&(l+=m)})}),l}countPlayerMatches(a,c){return this.matches.length}calculateDisciplinaryScore(a){let c=0;return a.forEach(l=>{switch(l.type){case"Gelb-Rote Karte":c+=3;break;case"Rote Karte":c+=5;break;case"Verletzung":c+=1;break;default:c+=1}}),c}calculateAdvancedStats(){const a=this.matches.length,c=this.matches.reduce((l,t)=>l+(t.goalsa||0)+(t.goalsb||0),0);return{avgGoalsPerMatch:a>0?(c/a).toFixed(2):"0.00",totalMatches:a,totalGoals:c,aekTotalGoals:this.matches.reduce((l,t)=>l+(t.goalsa||0),0),realTotalGoals:this.matches.reduce((l,t)=>l+(t.goalsb||0),0),highestScoringMatch:a>0?Math.max(...this.matches.map(l=>(l.goalsa||0)+(l.goalsb||0))):0,cleanSheets:{aek:this.matches.filter(l=>l.goalsb===0).length,real:this.matches.filter(l=>l.goalsa===0).length}}}calculatePerformanceTrends(){const a={};return this.matches.forEach(c=>{const l=new Date(c.date),t=`${l.getFullYear()}-${String(l.getMonth()+1).padStart(2,"0")}`;a[t]||(a[t]={month:t,aekWins:0,realWins:0,totalGoals:0,matchCount:0});const r=c.goalsa||0,n=c.goalsb||0;a[t].totalGoals+=r+n,a[t].matchCount++,r>n?a[t].aekWins++:n>r&&a[t].realWins++}),a}}function _(){const[p,a]=V.useState("overview"),{data:c,loading:l}=N("matches","*"),{data:t,loading:r}=N("players","*"),{data:n,loading:d}=N("spieler_des_spiels","*"),{data:m,loading:G}=N("bans","*"),P=l||r||d||G,x=new z(c,t,m,n),j=x.calculateTeamRecords(),v=x.calculateRecentForm(5),u=x.calculatePlayerStats(),o=x.calculateAdvancedStats(),M=x.calculatePerformanceTrends(),h=(c==null?void 0:c.length)||0,C=(t==null?void 0:t.length)||0,y=(t==null?void 0:t.filter(s=>s.team==="AEK"))||[],S=(t==null?void 0:t.filter(s=>s.team==="Real"))||[],w=y.reduce((s,i)=>s+(i.value||0),0),k=S.reduce((s,i)=>s+(i.value||0),0),F=w+k,b=j.aek.wins,f=j.real.wins,T=s=>s.map((i,D)=>e.jsx("span",{className:`inline-block w-6 h-6 text-xs font-bold rounded-full text-center leading-6 mx-0.5 ${i==="W"?"bg-green-500 text-white":i==="L"?"bg-red-500 text-white":"bg-gray-400 text-white"}`,children:i},D)),g=s=>`${(s/1e6).toFixed(1)}M €`,A=[{id:"overview",label:"Übersicht",icon:"📊"},{id:"players",label:"Spieler",icon:"👥"},{id:"teams",label:"Teams",icon:"🏆"},{id:"trends",label:"Trends",icon:"📈"}];if(P)return e.jsx($,{message:"Lade Statistiken..."});const E=()=>e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[e.jsxs("div",{className:"modern-card text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-primary",children:h}),e.jsx("div",{className:"text-sm text-text-muted",children:"Spiele"})]}),e.jsxs("div",{className:"modern-card text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-primary",children:o.totalGoals}),e.jsx("div",{className:"text-sm text-text-muted",children:"Tore"})]}),e.jsxs("div",{className:"modern-card text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-primary",children:C}),e.jsx("div",{className:"text-sm text-text-muted",children:"Spieler"})]}),e.jsxs("div",{className:"modern-card text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-primary",children:o.avgGoalsPerMatch}),e.jsx("div",{className:"text-sm text-text-muted",children:"⌀ Tore/Spiel"})]})]}),e.jsxs("div",{className:"grid md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"modern-card border-l-4 border-blue-400",children:[e.jsx("h3",{className:"font-bold text-lg mb-4 text-blue-600",children:"AEK Athen"}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Siege:"}),e.jsx("span",{className:"font-semibold text-green-600",children:b})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Niederlagen:"}),e.jsx("span",{className:"font-semibold text-red-600",children:j.aek.losses})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Marktwert:"}),e.jsx("span",{className:"font-semibold",children:g(w)})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Zu Null:"}),e.jsx("span",{className:"font-semibold",children:o.cleanSheets.aek})]}),e.jsxs("div",{className:"mt-3",children:[e.jsx("div",{className:"text-sm text-text-muted mb-1",children:"Form (letzte 5):"}),e.jsx("div",{className:"flex",children:T(v.aek)})]})]})]}),e.jsxs("div",{className:"modern-card border-l-4 border-red-400",children:[e.jsx("h3",{className:"font-bold text-lg mb-4 text-red-600",children:"Real Madrid"}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Siege:"}),e.jsx("span",{className:"font-semibold text-green-600",children:f})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Niederlagen:"}),e.jsx("span",{className:"font-semibold text-red-600",children:j.real.losses})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Marktwert:"}),e.jsx("span",{className:"font-semibold",children:g(k)})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Zu Null:"}),e.jsx("span",{className:"font-semibold",children:o.cleanSheets.real})]}),e.jsxs("div",{className:"mt-3",children:[e.jsx("div",{className:"text-sm text-text-muted mb-1",children:"Form (letzte 5):"}),e.jsx("div",{className:"flex",children:T(v.real)})]})]})]})]}),e.jsxs("div",{className:"modern-card",children:[e.jsx("h3",{className:"font-bold text-lg mb-4",children:"🏆 Top-Torschützen"}),e.jsx("div",{className:"space-y-2",children:u.slice(0,5).map((s,i)=>e.jsxs("div",{className:"flex items-center justify-between py-2 border-b border-border-light last:border-b-0",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("span",{className:`w-6 h-6 rounded-full flex items-center justify-center text-xs font-bold ${i===0?"bg-yellow-500 text-white":i===1?"bg-gray-400 text-white":i===2?"bg-orange-600 text-white":"bg-gray-200 text-gray-600"}`,children:i+1}),e.jsxs("div",{children:[e.jsx("div",{className:"font-medium",children:s.name}),e.jsx("div",{className:"text-sm text-text-muted",children:s.team})]})]}),e.jsxs("div",{className:"text-right",children:[e.jsxs("div",{className:"font-bold",children:[s.goals," Tore"]}),e.jsxs("div",{className:"text-sm text-text-muted",children:[s.goalsPerGame," ⌀"]})]})]},s.id))})]}),e.jsxs("div",{className:"modern-card",children:[e.jsx("h3",{className:"font-bold text-lg mb-4",children:"⭐ Top-Spieler des Spiels"}),e.jsx("div",{className:"space-y-2",children:u.filter(s=>s.sdsCount>0).sort((s,i)=>i.sdsCount-s.sdsCount).slice(0,5).map((s,i)=>e.jsxs("div",{className:"flex items-center justify-between py-2 border-b border-border-light last:border-b-0",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("span",{className:`w-6 h-6 rounded-full flex items-center justify-center text-xs font-bold ${i===0?"bg-yellow-500 text-white":i===1?"bg-gray-400 text-white":i===2?"bg-orange-600 text-white":"bg-gray-200 text-gray-600"}`,children:i+1}),e.jsxs("div",{children:[e.jsx("div",{className:"font-medium",children:s.name}),e.jsx("div",{className:"text-sm text-text-muted",children:s.team})]})]}),e.jsxs("div",{className:"text-right",children:[e.jsxs("div",{className:"font-bold",children:[s.sdsCount,"x SdS"]}),e.jsxs("div",{className:"text-sm text-text-muted",children:[s.matchesPlayed>0?(s.sdsCount/s.matchesPlayed*100).toFixed(1):"0.0","% Quote"]})]})]},s.id))}),u.filter(s=>s.sdsCount>0).length===0&&e.jsx("div",{className:"text-center text-text-muted py-4",children:"Noch keine Spieler des Spiels Auszeichnungen vergeben"})]})]}),R=()=>e.jsxs("div",{className:"modern-card",children:[e.jsx("h3",{className:"font-bold text-lg mb-4",children:"📊 Spielerstatistiken"}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full text-sm",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"border-b border-border-light",children:[e.jsx("th",{className:"text-left py-2",children:"Spieler"}),e.jsx("th",{className:"text-left py-2",children:"Team"}),e.jsx("th",{className:"text-center py-2",children:"Tore"}),e.jsx("th",{className:"text-center py-2",children:"⌀/Spiel"}),e.jsx("th",{className:"text-center py-2",children:"SdS"}),e.jsx("th",{className:"text-center py-2",children:"Sperren"}),e.jsx("th",{className:"text-right py-2",children:"Marktwert"})]})}),e.jsx("tbody",{children:u.map((s,i)=>e.jsxs("tr",{className:"border-b border-border-light hover:bg-bg-secondary",children:[e.jsx("td",{className:"py-2 font-medium",children:s.name}),e.jsx("td",{className:"py-2",children:e.jsx("span",{className:`px-2 py-1 rounded text-xs font-medium ${s.team==="AEK"?"bg-blue-100 text-blue-800":"bg-red-100 text-red-800"}`,children:s.team})}),e.jsx("td",{className:"py-2 text-center font-bold",children:s.goals}),e.jsx("td",{className:"py-2 text-center",children:s.goalsPerGame}),e.jsx("td",{className:"py-2 text-center",children:s.sdsCount}),e.jsx("td",{className:"py-2 text-center",children:s.totalBans}),e.jsx("td",{className:"py-2 text-right",children:g(s.value)})]},s.id))})]})})]}),W=()=>e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"modern-card",children:[e.jsx("h3",{className:"font-bold text-lg mb-4",children:"⚖️ Team-Vergleich"}),e.jsxs("div",{className:"grid md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"space-y-3",children:[e.jsx("h4",{className:"font-semibold text-blue-600",children:"AEK Athen"}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Spieler:"}),e.jsx("span",{className:"font-medium",children:y.length})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Tore gesamt:"}),e.jsx("span",{className:"font-medium",children:o.aekTotalGoals})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Siege:"}),e.jsx("span",{className:"font-medium",children:b})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Siegquote:"}),e.jsxs("span",{className:"font-medium",children:[h>0?(b/h*100).toFixed(1):0,"%"]})]})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("h4",{className:"font-semibold text-red-600",children:"Real Madrid"}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Spieler:"}),e.jsx("span",{className:"font-medium",children:S.length})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Tore gesamt:"}),e.jsx("span",{className:"font-medium",children:o.realTotalGoals})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Siege:"}),e.jsx("span",{className:"font-medium",children:f})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Siegquote:"}),e.jsxs("span",{className:"font-medium",children:[h>0?(f/h*100).toFixed(1):0,"%"]})]})]})]})]})]}),e.jsxs("div",{className:"modern-card",children:[e.jsx("h3",{className:"font-bold text-lg mb-4",children:"📈 Erweiterte Statistiken"}),e.jsxs("div",{className:"grid md:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"text-center p-4 bg-bg-secondary rounded-lg",children:[e.jsx("div",{className:"text-2xl font-bold text-primary",children:o.highestScoringMatch}),e.jsx("div",{className:"text-sm text-text-muted",children:"Tore in einem Spiel"})]}),e.jsxs("div",{className:"text-center p-4 bg-bg-secondary rounded-lg",children:[e.jsx("div",{className:"text-2xl font-bold text-primary",children:g(F)}),e.jsx("div",{className:"text-sm text-text-muted",children:"Gesamtmarktwert"})]}),e.jsxs("div",{className:"text-center p-4 bg-bg-secondary rounded-lg",children:[e.jsx("div",{className:"text-2xl font-bold text-primary",children:Math.abs(b-f)}),e.jsx("div",{className:"text-sm text-text-muted",children:"Siegesdifferenz"})]})]})]})]}),K=()=>e.jsxs("div",{className:"modern-card",children:[e.jsx("h3",{className:"font-bold text-lg mb-4",children:"📈 Performance-Trends"}),e.jsx("div",{className:"space-y-4",children:Object.values(M).reverse().map(s=>e.jsxs("div",{className:"flex items-center justify-between py-3 border-b border-border-light last:border-b-0",children:[e.jsx("div",{className:"font-medium",children:s.month}),e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsxs("div",{className:"text-sm",children:[e.jsxs("span",{className:"text-blue-600 font-medium",children:["AEK: ",s.aekWins]}),e.jsx("span",{className:"mx-2",children:"vs"}),e.jsxs("span",{className:"text-red-600 font-medium",children:["Real: ",s.realWins]})]}),e.jsxs("div",{className:"text-sm text-text-muted",children:[s.matchCount," Spiele, ",s.totalGoals," Tore"]}),e.jsxs("div",{className:"text-sm font-medium",children:["⌀ ",(s.totalGoals/s.matchCount).toFixed(1)," Tore/Spiel"]})]})]},s.month))})]}),L=()=>{switch(p){case"players":return R();case"teams":return W();case"trends":return K();default:return E()}};return e.jsxs("div",{className:"p-4 pb-20",children:[e.jsxs("div",{className:"mb-6",children:[e.jsx("h2",{className:"text-2xl font-bold text-text-primary mb-2",children:"📊 Statistiken"}),e.jsx("p",{className:"text-text-muted",children:"Umfassende Analyse von Spielen, Spielern und Teams"})]}),e.jsx("div",{className:"flex overflow-x-auto space-x-2 mb-6 pb-2",children:A.map(s=>e.jsxs("button",{onClick:()=>a(s.id),className:`flex items-center space-x-2 px-4 py-2 rounded-lg whitespace-nowrap transition-colors ${p===s.id?"bg-primary text-white":"bg-bg-secondary text-text-muted hover:bg-bg-tertiary"}`,children:[e.jsx("span",{children:s.icon}),e.jsx("span",{className:"font-medium",children:s.label})]},s.id))}),L()]})}export{_ as default};
