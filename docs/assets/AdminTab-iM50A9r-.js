const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/matches-Bz0wv9ua.js","assets/dataManager-B859Fmxm.js"])))=>i.map(i=>d[i]);
import{s as C,u as L,r as D,j as e,z as $,a as H,L as ee,_ as re}from"./index-DBNSDjRg.js";import{B as q}from"./banTypes-DuNOJEIt.js";class U{static async submitMatch(d){const{date:s,teama:t="AEK",teamb:l="Real",goalsa:o,goalsb:u,goalslista:w=[],goalslistb:y=[],ownGoalsA:x=0,ownGoalsB:a=0,yellowa:S=0,reda:N=0,yellowb:T=0,redb:i=0,manofthematch:k,editId:v=null}=d;try{const{prizeaek:g,prizereal:K,winner:r,loser:c}=this.calculatePrizeMoney(o,u,S,N,T,i);v&&await this.deleteMatchTransactions(v);const m=[...w],b=[...y];x>0&&b.push({count:x,player:"Eigentore_AEK"}),a>0&&m.push({count:a,player:"Eigentore_Real"});const A={date:s,teama:t,teamb:l,goalsa:parseInt(o)||0,goalsb:parseInt(u)||0,goalslista:w,goalslistb:y,yellowa:parseInt(S)||0,reda:parseInt(N)||0,yellowb:parseInt(T)||0,redb:parseInt(i)||0,manofthematch:k||null,prizeaek:g,prizereal:K},E=await C.insert("matches",A);if(E.error)throw new Error(`Match insert failed: ${E.error.message}`);const z=E.data.id,F=new Date().toISOString().slice(0,10);if(m.length>0){const _=m.filter(R=>typeof R=="object"&&R.player?!R.player.startsWith("Eigentore_"):!R.startsWith("Eigentore_"));await this.updatePlayersGoals(_,"AEK")}if(b.length>0){const _=b.filter(R=>typeof R=="object"&&R.player?!R.player.startsWith("Eigentore_"):!R.startsWith("Eigentore_"));await this.updatePlayersGoals(_,"Real")}return k&&await this.updatePlayerOfTheMatchStats(k),await this.processFinancialTransactions({matchId:z,date:F,prizeaek:g,prizereal:K,manofthematch:k,winner:r,loser:c}),await this.decrementBansAfterMatch(),{success:!0,matchId:z,message:`Match ${t} vs ${l} (${o}:${u}) erfolgreich hinzugefügt`}}catch(g){throw console.error("Error in submitMatch:",g),new Error(`Fehler beim Speichern des Matches: ${g.message}`)}}static calculatePrizeMoney(d,s,t,l,o,u){let w=0,y=0,x=null,a=null;return d>s?(x="AEK",a="Real"):d<s&&(x="Real",a="AEK"),x&&a&&(x==="AEK"?(w=1e6-s*5e4-t*2e4-l*5e4,y=-(5e5+d*5e4+o*2e4+u*5e4)):(y=1e6-d*5e4-o*2e4-u*5e4,w=-(5e5+s*5e4+t*2e4+l*5e4))),{prizeaek:w,prizereal:y,winner:x,loser:a}}static async updatePlayersGoals(d,s){const t={};if(d.length>0&&typeof d[0]=="object"&&d[0].player!==void 0)d.forEach(l=>{l.player&&!l.player.startsWith("Eigentore_")&&(t[l.player]=(t[l.player]||0)+(l.count||1))});else for(const l of d)!l||!l.trim()||l.startsWith("Eigentore_")||(t[l]=(t[l]||0)+1);for(const[l,o]of Object.entries(t))try{const u=await C.select("players","id, goals",{eq:{name:l,team:s}});if(u.data&&u.data.length>0){const w=u.data[0],y=(w.goals||0)+o;await C.update("players",{goals:y},w.id)}}catch(u){console.warn(`Failed to update goals for player ${l}:`,u)}}static async updatePlayerOfTheMatchStats(d){try{const s=await C.select("players","team",{eq:{name:d}});if(!s.data||s.data.length===0){console.warn(`Player ${d} not found for SdS stats`);return}const t=s.data[0].team,l=await C.select("spieler_des_spiels","*",{eq:{name:d,team:t}});if(l.data&&l.data.length>0){const o=l.data[0];await C.update("spieler_des_spiels",{count:o.count+1},o.id)}else await C.insert("spieler_des_spiels",{name:d,team:t,count:1})}catch(s){console.warn(`Failed to update SdS stats for ${d}:`,s)}}static async processFinancialTransactions({matchId:d,date:s,prizeaek:t,prizereal:l,manofthematch:o,winner:u,loser:w}){const y=await this.getTeamFinance("AEK"),x=await this.getTeamFinance("Real");let a=y.balance||0,S=x.balance||0;const N=o?await this.getSdSBonus(o,"AEK"):0,T=o?await this.getSdSBonus(o,"Real"):0;N>0&&(a+=N,await this.insertTransaction({date:s,type:"SdS Bonus",team:"AEK",amount:N,match_id:d,info:"SdS Bonus"}),await this.updateTeamBalance("AEK",a)),T>0&&(S+=T,await this.insertTransaction({date:s,type:"SdS Bonus",team:"Real",amount:T,match_id:d,info:"SdS Bonus"}),await this.updateTeamBalance("Real",S)),t!==0&&(a+=t,a<0&&(a=0),await this.insertTransaction({date:s,type:"Preisgeld",team:"AEK",amount:t,match_id:d,info:"Preisgeld"}),await this.updateTeamBalance("AEK",a)),l!==0&&(S+=l,S<0&&(S=0),await this.insertTransaction({date:s,type:"Preisgeld",team:"Real",amount:l,match_id:d,info:"Preisgeld"}),await this.updateTeamBalance("Real",S)),u&&w&&await this.processEchtgeldAusgleich({date:s,matchId:d,winner:u,loser:w,aekBalance:a,realBalance:S,prizeaek:t,prizereal:l,sdsBonusAek:N>0?1:0,sdsBonusReal:T>0?1:0,manofthematch:o})}static async getTeamFinance(d){const s=await C.select("finances","*",{eq:{team:d}});return s.data&&s.data.length>0?s.data[0]:{balance:0,debt:0}}static async getSdSBonus(d,s){const t=await C.select("players","team",{eq:{name:d}});return t.data&&t.data.length>0&&t.data[0].team===s?1e5:0}static async insertTransaction(d){return await C.insert("transactions",d)}static async updateTeamBalance(d,s){const t=await C.select("finances","id",{eq:{team:d}});return t.data&&t.data.length>0?await C.update("finances",{balance:s},t.data[0].id):await C.insert("finances",{team:d,balance:s,debt:0})}static async processEchtgeldAusgleich({date:d,matchId:s,winner:t,loser:l,aekBalance:o,realBalance:u,prizeaek:w,prizereal:y,sdsBonusAek:x,sdsBonusReal:a,manofthematch:S}){const N=await this.getTeamFinance("AEK"),T=await this.getTeamFinance("Real"),i={AEK:N.debt||0,Real:T.debt||0},k=(F,_,R)=>{let P=F;R&&(P+=1e5);let O=(Math.abs(_)-P)/1e5;return O<0&&(O=0),5+Math.round(O)},v=k(o,w,x),g=k(u,y,a),K=l==="AEK"?v:g,r=i[t],c=i[l],m=Math.min(r,K*1),b=Math.max(0,r-m),A=K*1-m,E=c+Math.max(0,A),z=await C.select("finances","id",{eq:{team:t}});if(z.data&&z.data.length>0&&await C.update("finances",{debt:b},z.data[0].id),A>0){await this.insertTransaction({date:d,type:"Echtgeld-Ausgleich",team:l,amount:Math.max(0,A),match_id:s,info:"Echtgeld-Ausgleich"});const F=await C.select("finances","id",{eq:{team:l}});F.data&&F.data.length>0&&await C.update("finances",{debt:E},F.data[0].id)}m>0&&await this.insertTransaction({date:d,type:"Echtgeld-Ausgleich (getilgt)",team:t,amount:-m,match_id:s,info:"Echtgeld-Ausgleich (getilgt)"})}static async deleteMatchTransactions(d){const s=await C.select("transactions","*",{eq:{match_id:d}});if(s.data)for(const t of s.data)await C.delete("transactions",t.id);await C.delete("matches",d)}static async decrementBansAfterMatch(){try{const d=await C.select("bans","*");if(!d.data)return;for(const s of d.data)if(s.matchesserved<s.totalgames){const t=s.matchesserved+1;await C.update("bans",{matchesserved:t},s.id)}}catch(d){console.warn("Failed to decrement bans:",d)}}}function ne(){const{data:f}=L("players","*"),[d,s]=D.useState(!1),[t,l]=D.useState({teama:"AEK",teamb:"Real",date:new Date().toISOString().split("T")[0],goalsa:0,goalsb:0,goalslista:[],goalslistb:[],ownGoalsA:0,ownGoalsB:0,yellowa:0,reda:0,yellowb:0,redb:0,prizeaek:0,prizereal:0,manofthematch:"",motmTeamFilter:"all"}),[o,u]=D.useState(!1),w=(r,c,m)=>r.reduce((A,E)=>A+E.count,0)+m,y=r=>{l(c=>{const m={...c,...r};m.goalsa=w(m.goalslista,m.ownGoalsA,m.ownGoalsB),m.goalsb=w(m.goalslistb,m.ownGoalsB,m.ownGoalsA);const{prizeaek:b,prizereal:A}=U.calculatePrizeMoney(m.goalsa,m.goalsb,m.yellowa,m.reda,m.yellowb,m.redb);return m.prizeaek=b,m.prizereal=A,m})},x=(r,c)=>{y({[r]:c})},a=async r=>{r.preventDefault(),u(!0);try{const c=await U.submitMatch({date:t.date,teama:t.teama.trim(),teamb:t.teamb.trim(),goalsa:t.goalsa,goalsb:t.goalsb,goalslista:t.goalslista,goalslistb:t.goalslistb,ownGoalsA:t.ownGoalsA,ownGoalsB:t.ownGoalsB,yellowa:parseInt(t.yellowa)||0,reda:parseInt(t.reda)||0,yellowb:parseInt(t.yellowb)||0,redb:parseInt(t.redb)||0,manofthematch:t.manofthematch||null});l({teama:"AEK",teamb:"Real",date:new Date().toISOString().split("T")[0],goalsa:0,goalsb:0,goalslista:[],goalslistb:[],ownGoalsA:0,ownGoalsB:0,yellowa:0,reda:0,yellowb:0,redb:0,prizeaek:0,prizereal:0,manofthematch:"",motmTeamFilter:"all"}),s(!1),$.success(c.message)}catch(c){console.error("Match submission error:",c),$.error(c.message||"Fehler beim Hinzufügen des Spiels")}finally{u(!1)}},S=()=>!(!t.date||t.goalsa===t.goalsb||!t.manofthematch||t.manofthematch.trim()===""),N=r=>f?f.filter(c=>c.team===r):[],T=()=>f?t.motmTeamFilter==="all"?f:f.filter(r=>r.team===t.motmTeamFilter):[],i=(r,c)=>{const m=r==="AEK"?"goalslista":"goalslistb";y({[m]:t[m].map(b=>b.player===c?{...b,count:b.count+1}:b).concat(t[m].find(b=>b.player===c)?[]:[{player:c,count:1}])})},k=(r,c)=>{const m=r==="AEK"?"goalslista":"goalslistb";y({[m]:t[m].map(b=>b.player===c?{...b,count:Math.max(0,b.count-1)}:b).filter(b=>b.count>0)})},v=(r,c)=>{const m=r==="AEK"?"ownGoalsA":"ownGoalsB",b=Math.max(0,t[m]+c);y({[m]:b})},g=(r,c)=>{if(!c)return;const m=r==="AEK"?"goalslista":"goalslistb",b=t[m].find(A=>A.player===c);y(b?{[m]:t[m].map(A=>A.player===c?{...A,count:A.count+1}:A)}:{[m]:[...t[m],{player:c,count:1}]})},K=(r,c)=>{const m=r==="AEK"?"goalslista":"goalslistb";y({[m]:t[m].filter(b=>b.player!==c)})};return e.jsxs("div",{className:"p-4",children:[e.jsxs("div",{className:"mb-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-text-primary mb-2",children:"Neues Spiel hinzufügen"}),e.jsx("p",{className:"text-text-muted text-sm",children:"Fügen Sie ein neues Spiel zur Datenbank hinzu."})]}),e.jsx("div",{className:"modern-card",children:e.jsxs("div",{className:"text-center py-8",children:[e.jsx("div",{className:"text-4xl mb-4",children:"⚽"}),e.jsx("h4",{className:"text-lg font-medium text-text-primary mb-2",children:"Spiel hinzufügen"}),e.jsx("p",{className:"text-text-muted mb-6",children:"Klicken Sie auf den Button, um ein neues Spiel zu erfassen."}),e.jsxs("button",{onClick:()=>s(!0),className:"btn-primary",children:[e.jsx("i",{className:"fas fa-plus mr-2"}),"Neues Spiel erfassen"]})]})}),d&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-[60] p-2 sm:p-4",children:e.jsx("div",{className:"bg-bg-secondary rounded-lg w-full max-w-lg modal-content",children:e.jsxs("div",{className:"p-4 sm:p-6",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsx("h3",{className:"text-xl font-semibold text-text-primary",children:"Neues Spiel"}),e.jsx("button",{onClick:()=>s(!1),className:"text-text-muted hover:text-text-primary text-2xl",disabled:o,children:"×"})]}),e.jsxs("form",{onSubmit:a,className:"space-y-4",children:[e.jsx("div",{className:"bg-gray-50 rounded-lg p-4 border",children:e.jsxs("div",{className:"text-center",children:[e.jsx("h4",{className:"text-lg font-semibold text-gray-700 mb-2",children:"⚽ Spielpaarung"}),e.jsxs("div",{className:"flex items-center justify-center space-x-4",children:[e.jsx("div",{className:"bg-blue-100 text-blue-800 px-4 py-2 rounded-lg font-medium",children:"AEK Athen"}),e.jsx("div",{className:"text-gray-500 font-bold text-xl",children:"vs"}),e.jsx("div",{className:"bg-red-100 text-red-800 px-4 py-2 rounded-lg font-medium",children:"Real Madrid"})]})]})}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text-primary mb-2",children:"Datum *"}),e.jsx("input",{type:"date",value:t.date,onChange:r=>x("date",r.target.value),className:"form-input",required:!0,disabled:o})]}),e.jsxs("div",{className:"border-t pt-4",children:[e.jsx("h4",{className:"text-sm font-medium text-text-primary mb-3",children:"⚽ Live Torwertung"}),e.jsxs("div",{className:"bg-gray-50 rounded-lg p-4 mb-4 text-center",children:[e.jsxs("div",{className:"text-2xl font-bold text-gray-700",children:[t.goalsa," : ",t.goalsb]}),e.jsxs("div",{className:"text-sm text-gray-500 mt-1",children:["AEK Athen ",t.goalsa," - ",t.goalsb," Real Madrid"]})]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4 sm:gap-6",children:[e.jsxs("div",{className:"space-y-3",children:[e.jsx("div",{className:"text-center",children:e.jsx("h5",{className:"text-sm font-medium text-blue-600 mb-3",children:"⚽ AEK Athen Torschützen"})}),e.jsx("div",{className:"space-y-2",children:t.goalslista.map((r,c)=>e.jsxs("div",{className:"flex items-center justify-between bg-blue-50 rounded-lg p-2",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"text-sm font-medium text-gray-700",children:r.player}),e.jsxs("div",{className:"text-xs text-gray-500",children:[r.count," Tor",r.count!==1?"e":""]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("button",{type:"button",onClick:()=>k("AEK",r.player),className:"w-8 h-8 bg-red-500 hover:bg-red-600 text-white rounded-full flex items-center justify-center text-sm font-bold transition-colors",disabled:o,children:"−"}),e.jsx("span",{className:"w-8 text-center font-bold text-lg text-gray-700",children:r.count}),e.jsx("button",{type:"button",onClick:()=>i("AEK",r.player),className:"w-8 h-8 bg-green-500 hover:bg-green-600 text-white rounded-full flex items-center justify-center text-sm font-bold transition-colors",disabled:o,children:"+"}),e.jsx("button",{type:"button",onClick:()=>K("AEK",r.player),className:"w-8 h-8 bg-gray-500 hover:bg-gray-600 text-white rounded-full flex items-center justify-center text-xs font-bold transition-colors",disabled:o,title:"Torschütze entfernen",children:"✕"})]})]},`aek-${r.player}-${c}`))}),e.jsx("div",{className:"border-t pt-2",children:e.jsxs("select",{onChange:r=>{r.target.value&&(g("AEK",r.target.value),r.target.value="")},className:"w-full form-input bg-blue-100 border-blue-300 text-blue-800",disabled:o,children:[e.jsx("option",{value:"",children:"+ Torschütze hinzufügen"}),N("AEK").map(r=>e.jsxs("option",{value:r.name,children:[r.name," (",r.position,")"]},r.id))]})}),e.jsxs("div",{className:"flex items-center justify-between bg-orange-50 rounded-lg p-2 border border-orange-200",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"text-sm font-medium text-gray-700",children:"Eigentore"}),e.jsx("div",{className:"text-xs text-gray-500",children:"Zählen für Real Madrid"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("button",{type:"button",onClick:()=>v("AEK",-1),className:"w-8 h-8 bg-red-500 hover:bg-red-600 text-white rounded-full flex items-center justify-center text-sm font-bold transition-colors",disabled:o||t.ownGoalsA===0,children:"−"}),e.jsx("span",{className:"w-8 text-center font-bold text-lg text-gray-700",children:t.ownGoalsA}),e.jsx("button",{type:"button",onClick:()=>v("AEK",1),className:"w-8 h-8 bg-green-500 hover:bg-green-600 text-white rounded-full flex items-center justify-center text-sm font-bold transition-colors",disabled:o,children:"+"})]})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("div",{className:"text-center",children:e.jsx("h5",{className:"text-sm font-medium text-red-600 mb-3",children:"⚽ Real Madrid Torschützen"})}),e.jsx("div",{className:"space-y-2",children:t.goalslistb.map((r,c)=>e.jsxs("div",{className:"flex items-center justify-between bg-red-50 rounded-lg p-2",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"text-sm font-medium text-gray-700",children:r.player}),e.jsxs("div",{className:"text-xs text-gray-500",children:[r.count," Tor",r.count!==1?"e":""]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("button",{type:"button",onClick:()=>k("Real",r.player),className:"w-8 h-8 bg-red-500 hover:bg-red-600 text-white rounded-full flex items-center justify-center text-sm font-bold transition-colors",disabled:o,children:"−"}),e.jsx("span",{className:"w-8 text-center font-bold text-lg text-gray-700",children:r.count}),e.jsx("button",{type:"button",onClick:()=>i("Real",r.player),className:"w-8 h-8 bg-green-500 hover:bg-green-600 text-white rounded-full flex items-center justify-center text-sm font-bold transition-colors",disabled:o,children:"+"}),e.jsx("button",{type:"button",onClick:()=>K("Real",r.player),className:"w-8 h-8 bg-gray-500 hover:bg-gray-600 text-white rounded-full flex items-center justify-center text-xs font-bold transition-colors",disabled:o,title:"Torschütze entfernen",children:"✕"})]})]},`real-${r.player}-${c}`))}),e.jsx("div",{className:"border-t pt-2",children:e.jsxs("select",{onChange:r=>{r.target.value&&(g("Real",r.target.value),r.target.value="")},className:"w-full form-input bg-red-100 border-red-300 text-red-800",disabled:o,children:[e.jsx("option",{value:"",children:"+ Torschütze hinzufügen"}),N("Real").map(r=>e.jsxs("option",{value:r.name,children:[r.name," (",r.position,")"]},r.id))]})}),e.jsxs("div",{className:"flex items-center justify-between bg-orange-50 rounded-lg p-2 border border-orange-200",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"text-sm font-medium text-gray-700",children:"Eigentore"}),e.jsx("div",{className:"text-xs text-gray-500",children:"Zählen für AEK Athen"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("button",{type:"button",onClick:()=>v("Real",-1),className:"w-8 h-8 bg-red-500 hover:bg-red-600 text-white rounded-full flex items-center justify-center text-sm font-bold transition-colors",disabled:o||t.ownGoalsB===0,children:"−"}),e.jsx("span",{className:"w-8 text-center font-bold text-lg text-gray-700",children:t.ownGoalsB}),e.jsx("button",{type:"button",onClick:()=>v("Real",1),className:"w-8 h-8 bg-green-500 hover:bg-green-600 text-white rounded-full flex items-center justify-center text-sm font-bold transition-colors",disabled:o,children:"+"})]})]})]})]})]}),e.jsxs("div",{className:"border-t pt-4",children:[e.jsx("h4",{className:"text-sm font-medium text-text-primary mb-3",children:"🟨🟥 Karten"}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-3",children:[e.jsx("p",{className:"text-xs text-blue-600 font-medium",children:"Heimteam"}),e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs text-text-muted mb-1",children:"🟨 Gelbe Karten"}),e.jsx("input",{type:"number",min:"0",value:t.yellowa,onChange:r=>x("yellowa",r.target.value),className:"form-input",disabled:o})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs text-text-muted mb-1",children:"🟥 Rote Karten"}),e.jsx("input",{type:"number",min:"0",value:t.reda,onChange:r=>x("reda",r.target.value),className:"form-input",disabled:o})]})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("p",{className:"text-xs text-red-600 font-medium",children:"Gastteam"}),e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs text-text-muted mb-1",children:"🟨 Gelbe Karten"}),e.jsx("input",{type:"number",min:"0",value:t.yellowb,onChange:r=>x("yellowb",r.target.value),className:"form-input",disabled:o})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs text-text-muted mb-1",children:"🟥 Rote Karten"}),e.jsx("input",{type:"number",min:"0",value:t.redb,onChange:r=>x("redb",r.target.value),className:"form-input",disabled:o})]})]})]})]})]}),e.jsxs("div",{className:"border-t pt-4",children:[e.jsx("h4",{className:"text-sm font-medium text-text-primary mb-3",children:"⭐ Spieler des Spiels"}),e.jsxs("div",{className:"mb-3",children:[e.jsx("label",{className:"block text-xs text-text-muted mb-2",children:"Team Filter:"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{type:"button",onClick:()=>x("motmTeamFilter","all"),className:`px-3 py-1 rounded-lg text-xs font-medium transition-colors ${t.motmTeamFilter==="all"?"bg-gray-600 text-white":"bg-gray-200 text-gray-700 hover:bg-gray-300"}`,disabled:o,children:"Alle"}),e.jsx("button",{type:"button",onClick:()=>x("motmTeamFilter","AEK"),className:`px-3 py-1 rounded-lg text-xs font-medium transition-colors ${t.motmTeamFilter==="AEK"?"bg-blue-600 text-white":"bg-blue-100 text-blue-700 hover:bg-blue-200"}`,disabled:o,children:"AEK"}),e.jsx("button",{type:"button",onClick:()=>x("motmTeamFilter","Real"),className:`px-3 py-1 rounded-lg text-xs font-medium transition-colors ${t.motmTeamFilter==="Real"?"bg-red-600 text-white":"bg-red-100 text-red-700 hover:bg-red-200"}`,disabled:o,children:"Real"})]})]}),e.jsxs("select",{value:t.manofthematch,onChange:r=>x("manofthematch",r.target.value),className:"form-input",disabled:o,children:[e.jsx("option",{value:"",children:"Keinen Spieler auswählen"}),T().map(r=>e.jsxs("option",{value:r.name,children:[r.name," (",r.team," - ",r.position,")"]},r.id))]}),!f||f.length===0&&e.jsx("p",{className:"text-xs text-text-muted mt-1",children:"Keine Spieler verfügbar. Bitte fügen Sie erst Spieler hinzu."})]}),e.jsxs("div",{className:"border-t pt-4",children:[e.jsx("h4",{className:"text-sm font-medium text-text-primary mb-3",children:"💰 Preisgelder (automatisch berechnet)"}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text-primary mb-2",children:"Preisgeld AEK (€)"}),e.jsx("input",{type:"number",value:t.prizeaek,className:"form-input bg-gray-100",placeholder:"Automatisch berechnet",disabled:!0,readOnly:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text-primary mb-2",children:"Preisgeld Real (€)"}),e.jsx("input",{type:"number",value:t.prizereal,className:"form-input bg-gray-100",placeholder:"Automatisch berechnet",disabled:!0,readOnly:!0})]})]}),e.jsx("p",{className:"text-xs text-text-muted mt-2",children:"Basierend auf Ergebnis und Karten: Gewinner 1M€ - (Verlierer-Tore × 50k€) - (Karten × 20k€/50k€)"})]}),t.goalsa===t.goalsb&&(t.goalsa>0||t.goalsb>0)&&e.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-3",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"text-red-600 mr-2",children:"⚠️"}),e.jsxs("div",{children:[e.jsx("h5",{className:"font-medium text-red-800",children:"Unentschieden nicht erlaubt"}),e.jsx("p",{className:"text-sm text-red-700",children:"Ein Team muss gewinnen. Unentschieden sind in dieser App nicht möglich."})]})]})}),!t.manofthematch&&(t.goalsa>0||t.goalsb>0)&&e.jsx("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-3",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"text-yellow-600 mr-2",children:"⭐"}),e.jsxs("div",{children:[e.jsx("h5",{className:"font-medium text-yellow-800",children:"Spieler des Spiels erforderlich"}),e.jsx("p",{className:"text-sm text-yellow-700",children:"Bitte wählen Sie einen Spieler des Spiels aus, bevor Sie das Match speichern."})]})]})}),e.jsxs("div",{className:"flex gap-3 pt-4",children:[e.jsx("button",{type:"button",onClick:()=>s(!1),className:"flex-1 px-4 py-2 border border-border-light rounded-lg text-text-secondary hover:bg-bg-tertiary transition-colors",disabled:o,children:"Abbrechen"}),e.jsx("button",{type:"submit",disabled:!S()||o,className:"flex-1 btn-primary disabled:opacity-50 disabled:cursor-not-allowed",children:o?e.jsxs("div",{className:"flex items-center justify-center",children:[e.jsx("div",{className:"spinner w-4 h-4 mr-2"}),"Speichern..."]}):"Speichern"})]})]})]})})}),e.jsx("div",{className:"mt-6 modern-card bg-blue-50 border-blue-200",children:e.jsxs("div",{className:"flex items-start",children:[e.jsx("div",{className:"text-blue-600 mr-3",children:e.jsx("i",{className:"fas fa-info-circle"})}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold text-blue-800 mb-1",children:"Wichtige Hinweise"}),e.jsxs("ul",{className:"text-blue-700 text-sm space-y-1",children:[e.jsxs("li",{children:["• ",e.jsx("strong",{children:"Kein Unentschieden:"})," Ein Team muss immer gewinnen - Unentschieden sind nicht erlaubt"]}),e.jsxs("li",{children:["• ",e.jsx("strong",{children:"Spieler des Spiels Pflicht:"})," Für jedes Spiel muss ein Spieler des Spiels ausgewählt werden"]}),e.jsx("li",{children:"• Nach dem Hinzufügen können Sie das Spiel in der Spiele-Übersicht einsehen und bearbeiten"})]})]})]})})]})}const G=[{value:"AEK",label:"AEK Athen",color:"blue",icon:"🔵"},{value:"Real",label:"Real Madrid",color:"red",icon:"🔴"},{value:"Ehemalige",label:"Ehemalige",color:"gray",icon:"⚫"}],I=f=>{const d=G.find(s=>s.value===f);return d?`${d.icon} ${d.label}`:f};function ie(){const{data:f}=L("players","*"),[d,s]=D.useState(!1),[t,l]=D.useState(""),[o,u]=D.useState({player_id:"",type:"",reason:"",customDuration:1}),[w,y]=D.useState(!1),x=(i,k)=>{u(v=>({...v,[i]:k})),i==="team"&&u(v=>({...v,player_id:""}))},a=()=>!f||!t?[]:f.filter(i=>i.team===t),S=async i=>{var k;i.preventDefault(),y(!0);try{const v=f==null?void 0:f.find(b=>b.id===parseInt(o.player_id)),g=q.find(b=>b.value===o.type);if(!v)throw new Error("Spieler nicht gefunden");if(!g)throw new Error("Sperrart nicht gefunden");const r=(k=(await C.select("bans","*",{eq:{player_id:v.id}})).data)==null?void 0:k.find(b=>(b.matchesserved||0)<(b.totalgames||0));if(r)throw new Error(`Spieler "${v.name}" ist bereits gesperrt (${r.totalgames-r.matchesserved} Spiele verbleibend)`);const c=g.fixedDuration?g.duration:o.customDuration,m=await C.insert("bans",{player_id:v.id,team:v.team,type:g.value,totalgames:c,matchesserved:0,reason:o.reason||g.value});if(m.error)throw new Error(`Ban insert failed: ${m.error.message}`);u({player_id:"",type:"",reason:"",customDuration:1}),l(""),s(!1),$.success(`Sperre für "${v.name}" erfolgreich hinzugefügt!`)}catch(v){console.error("Ban submission error:",v),$.error(v.message||"Fehler beim Hinzufügen der Sperre")}finally{y(!1)}},N=t&&o.player_id&&o.type,T=q.find(i=>i.value===o.type);return e.jsxs("div",{className:"p-4",children:[e.jsxs("div",{className:"mb-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-text-primary mb-2",children:"Neue Sperre hinzufügen"}),e.jsx("p",{className:"text-text-muted text-sm",children:"Erstellen Sie eine neue Spielersperre in der Datenbank."})]}),e.jsx("div",{className:"modern-card",children:e.jsxs("div",{className:"text-center py-8",children:[e.jsx("div",{className:"text-4xl mb-4",children:"🚫"}),e.jsx("h4",{className:"text-lg font-medium text-text-primary mb-2",children:"Sperre hinzufügen"}),e.jsx("p",{className:"text-text-muted mb-6",children:"Klicken Sie auf den Button, um eine neue Spielersperre zu erfassen."}),e.jsxs("button",{onClick:()=>s(!0),className:"btn-primary",children:[e.jsx("i",{className:"fas fa-plus mr-2"}),"Neue Sperre erfassen"]})]})}),d&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-[60] p-4",children:e.jsx("div",{className:"bg-bg-secondary rounded-lg max-w-md w-full modal-content",children:e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsx("h3",{className:"text-xl font-semibold text-text-primary",children:"Neue Sperre"}),e.jsx("button",{onClick:()=>s(!1),className:"text-text-muted hover:text-text-primary text-2xl",disabled:w,children:"×"})]}),e.jsxs("form",{onSubmit:S,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text-primary mb-2",children:"Team *"}),e.jsxs("select",{value:t,onChange:i=>{l(i.target.value),u(k=>({...k,player_id:""}))},className:"form-input",required:!0,disabled:w,children:[e.jsx("option",{value:"",children:"Team wählen"}),G.filter(i=>i.value!=="Ehemalige").map(i=>e.jsx("option",{value:i.value,children:I(i.value)},i.value))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text-primary mb-2",children:"Spieler *"}),e.jsxs("select",{value:o.player_id,onChange:i=>x("player_id",i.target.value),className:"form-input",required:!0,disabled:w||!t,children:[e.jsx("option",{value:"",children:t?"Spieler wählen":"Bitte zuerst Team wählen"}),a().map(i=>e.jsxs("option",{value:i.id,children:[i.name," (",i.position,")"]},i.id))]}),t&&a().length===0&&e.jsx("p",{className:"text-xs text-text-muted mt-1",children:"Keine Spieler im gewählten Team verfügbar."})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text-primary mb-2",children:"Sperrart *"}),e.jsxs("select",{value:o.type,onChange:i=>x("type",i.target.value),className:"form-input",required:!0,disabled:w,children:[e.jsx("option",{value:"",children:"Sperrart wählen"}),q.map(i=>e.jsxs("option",{value:i.value,children:[i.icon," ",i.label,i.fixedDuration?` (${i.duration} Spiel${i.duration!==1?"e":""})`:` (1-${i.maxDuration} Spiele)`]},i.value))]})]}),T&&!T.fixedDuration&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text-primary mb-2",children:"Anzahl Spiele *"}),e.jsx("select",{value:o.customDuration,onChange:i=>x("customDuration",parseInt(i.target.value)),className:"form-input",required:!0,disabled:w,children:Array.from({length:T.maxDuration},(i,k)=>k+1).map(i=>e.jsxs("option",{value:i,children:[i," Spiel",i!==1?"e":""]},i))}),e.jsxs("p",{className:"text-xs text-text-muted mt-1",children:["Wählen Sie zwischen ",T.minDuration," und ",T.maxDuration," Spielen"]})]}),T&&T.fixedDuration&&e.jsx("div",{className:"p-3 bg-blue-50 rounded-lg border border-blue-200",children:e.jsxs("p",{className:"text-sm text-blue-800",children:[e.jsx("i",{className:"fas fa-info-circle mr-2"}),"Gelb-Rote Karten haben immer eine feste Sperre von 1 Spiel."]})}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text-primary mb-2",children:"Zusätzlicher Grund (optional)"}),e.jsx("input",{type:"text",value:o.reason,onChange:i=>x("reason",i.target.value),className:"form-input",placeholder:"Weitere Details zur Sperre...",disabled:w})]}),e.jsxs("div",{className:"flex gap-3 pt-4",children:[e.jsx("button",{type:"button",onClick:()=>s(!1),className:"flex-1 px-4 py-2 border border-border-light rounded-lg text-text-secondary hover:bg-bg-tertiary transition-colors",disabled:w,children:"Abbrechen"}),e.jsx("button",{type:"submit",disabled:!N||w||!f||f.length===0,className:"flex-1 btn-primary disabled:opacity-50 disabled:cursor-not-allowed",children:w?e.jsxs("div",{className:"flex items-center justify-center",children:[e.jsx("div",{className:"spinner w-4 h-4 mr-2"}),"Speichern..."]}):"Speichern"})]})]})]})})}),e.jsxs("div",{className:"mt-6 modern-card",children:[e.jsx("h4",{className:"font-semibold text-text-primary mb-3",children:"Verfügbare Sperrarten"}),e.jsx("div",{className:"space-y-2",children:q.map(i=>e.jsxs("div",{className:"flex justify-between items-center p-3 bg-bg-secondary rounded-lg",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx("span",{className:"text-xl mr-2",children:i.icon}),e.jsx("span",{className:"font-medium text-text-primary",children:i.label})]}),e.jsx("span",{className:"text-sm text-text-muted",children:i.fixedDuration?`${i.duration} Spiel${i.duration!==1?"e":""} (fest)`:`1-${i.maxDuration} Spiele (variabel)`})]},i.value))})]}),e.jsx("div",{className:"mt-6 modern-card bg-yellow-50 border-yellow-200",children:e.jsxs("div",{className:"flex items-start",children:[e.jsx("div",{className:"text-yellow-600 mr-3",children:e.jsx("i",{className:"fas fa-info-circle"})}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold text-yellow-800 mb-1",children:"Hinweis"}),e.jsx("p",{className:"text-yellow-700 text-sm",children:"Nach dem Hinzufügen können Sie die Sperre in der Sperren-Übersicht einsehen und verwalten."})]})]})})]})}const Q=[{value:"TH",label:"Torwart (TH)"},{value:"IV",label:"Innenverteidiger (IV)"},{value:"AV",label:"Außenverteidiger (AV)"},{value:"ZM",label:"Zentrales Mittelfeld (ZM)"},{value:"OM",label:"Offensives Mittelfeld (OM)"},{value:"ST",label:"Stürmer (ST)"}];function ce(){const[f,d]=D.useState(!1),[s,t]=D.useState({name:"",team:"",position:"",goals:0,value:0}),[l,o]=D.useState(!1),u=(x,a)=>{t(S=>({...S,[x]:a}))},w=async x=>{x.preventDefault(),o(!0);try{const a=await C.select("players","*",{eq:{name:s.name.trim(),team:s.team.trim()}});if(a.data&&a.data.length>0)throw new Error(`Spieler "${s.name}" existiert bereits im Team "${s.team}"`);const S=await C.insert("players",{name:s.name.trim(),team:s.team.trim(),position:s.position.trim().toUpperCase(),goals:parseInt(s.goals)||0,value:parseFloat(s.value)||0});if(S.error)throw new Error(`Player insert failed: ${S.error.message}`);t({name:"",team:"",position:"",goals:0,value:0}),d(!1),$.success(`Spieler "${s.name}" erfolgreich hinzugefügt!`)}catch(a){console.error("Player submission error:",a),$.error(a.message||"Fehler beim Hinzufügen des Spielers")}finally{o(!1)}},y=s.name&&s.team&&s.position&&s.value!=="";return e.jsxs("div",{className:"p-4",children:[e.jsxs("div",{className:"mb-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-text-primary mb-2",children:"Neuen Spieler hinzufügen"}),e.jsx("p",{className:"text-text-muted text-sm",children:"Fügen Sie einen neuen Spieler zur Datenbank hinzu."})]}),e.jsx("div",{className:"modern-card",children:e.jsxs("div",{className:"text-center py-8",children:[e.jsx("div",{className:"text-4xl mb-4",children:"👤"}),e.jsxs("h4",{className:"text-lg font-medium text-text-primary mb-2",children:[e.jsx("i",{className:"fas fa-user-plus mr-2"}),"Spieler hinzufügen"]}),e.jsx("p",{className:"text-text-muted mb-6",children:"Klicken Sie auf den Button, um einen neuen Spieler zu erfassen."}),e.jsxs("button",{onClick:()=>d(!0),className:"btn-primary",children:[e.jsx("i",{className:"fas fa-plus mr-2"}),"Neuen Spieler erfassen"]})]})}),f&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-[60] p-4",children:e.jsx("div",{className:"bg-bg-secondary rounded-lg max-w-md w-full modal-content",children:e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsx("h3",{className:"text-xl font-semibold text-text-primary",children:"Neuer Spieler"}),e.jsx("button",{onClick:()=>d(!1),className:"text-text-muted hover:text-text-primary text-2xl",disabled:l,children:"×"})]}),e.jsxs("form",{onSubmit:w,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text-primary mb-2",children:"Spielername *"}),e.jsx("input",{type:"text",value:s.name,onChange:x=>u("name",x.target.value),className:"form-input",placeholder:"z.B. Max Mustermann",required:!0,disabled:l})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text-primary mb-2",children:"Team *"}),e.jsxs("select",{value:s.team,onChange:x=>u("team",x.target.value),className:"form-input",required:!0,disabled:l,children:[e.jsx("option",{value:"",children:"Team wählen"}),G.map(x=>e.jsx("option",{value:x.value,children:I(x.value)},x.value))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text-primary mb-2",children:"Position *"}),e.jsxs("select",{value:s.position,onChange:x=>u("position",x.target.value),className:"form-input",required:!0,disabled:l,children:[e.jsx("option",{value:"",children:"Position wählen"}),Q.map(x=>e.jsx("option",{value:x.value,children:x.label},x.value))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text-primary mb-2",children:"Marktwert (Millionen €) *"}),e.jsx("input",{type:"number",min:"0",step:"0.1",value:s.value,onChange:x=>u("value",x.target.value),className:"form-input",placeholder:"0.0",disabled:l}),e.jsx("p",{className:"text-xs text-text-muted mt-1",children:"Marktwert in Millionen Euro (z.B. 1.5 für 1.5M €)"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text-primary mb-2",children:"Anzahl Tore"}),e.jsx("input",{type:"number",min:"0",value:s.goals,onChange:x=>u("goals",x.target.value),className:"form-input",placeholder:"0",disabled:l})]}),e.jsxs("div",{className:"flex gap-3 pt-4",children:[e.jsx("button",{type:"button",onClick:()=>d(!1),className:"flex-1 px-4 py-2 border border-border-light rounded-lg text-text-secondary hover:bg-bg-tertiary transition-colors",disabled:l,children:"Abbrechen"}),e.jsx("button",{type:"submit",disabled:!y||l,className:"flex-1 btn-primary disabled:opacity-50 disabled:cursor-not-allowed",children:l?e.jsxs("div",{className:"flex items-center justify-center",children:[e.jsx("div",{className:"spinner w-4 h-4 mr-2"}),"Speichern..."]}):"Speichern"})]})]})]})})}),e.jsxs("div",{className:"mt-6 modern-card",children:[e.jsx("h4",{className:"font-semibold text-text-primary mb-3",children:"Verfügbare Teams"}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-2",children:G.map(x=>e.jsxs("div",{className:"p-3 bg-bg-secondary rounded-lg text-center",children:[e.jsx("span",{className:`font-medium ${x.color==="blue"?"text-blue-600":x.color==="red"?"text-red-600":"text-gray-600"}`,children:I(x.value)}),e.jsxs("div",{className:"text-xs text-text-muted mt-1",children:["(",x.value,")"]})]},x.value))})]}),e.jsxs("div",{className:"mt-6 modern-card",children:[e.jsx("h4",{className:"font-semibold text-text-primary mb-3",children:"Verfügbare Positionen"}),e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-2",children:Q.map(x=>e.jsx("div",{className:"p-3 bg-bg-secondary rounded-lg text-center",children:e.jsx("span",{className:"font-medium text-text-primary text-sm",children:x.label})},x.value))})]}),e.jsx("div",{className:"mt-6 modern-card bg-green-50 border-green-200",children:e.jsxs("div",{className:"flex items-start",children:[e.jsx("div",{className:"text-green-600 mr-3",children:e.jsx("i",{className:"fas fa-info-circle"})}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold text-green-800 mb-1",children:"Hinweis"}),e.jsx("p",{className:"text-green-700 text-sm",children:"Nach dem Hinzufügen können Sie den Spieler in der Kader-Übersicht einsehen und verwalten."})]})]})})]})}const J=[{value:"Preisgeld",label:"Preisgeld",icon:"🏆"},{value:"Strafe",label:"Strafe",icon:"📉"},{value:"Spielerkauf",label:"Spielerkauf",icon:"👤"},{value:"Spielerverkauf",label:"Spielerverkauf",icon:"💰"},{value:"Echtgeld-Ausgleich",label:"Echtgeld-Ausgleich",icon:"💳"},{value:"SdS Bonus",label:"Spieler des Spiels Bonus",icon:"⭐"},{value:"Sonstiges",label:"Sonstiges",icon:"📈"}];function de(){const[f,d]=D.useState(!1),[s,t]=D.useState({team:"",type:"",amount:"",info:"",date:new Date().toISOString().split("T")[0]}),[l,o]=D.useState(!1),u=(a,S)=>{t(N=>({...N,[a]:S}))},w=async a=>{a.preventDefault(),o(!0);try{const S=parseFloat(s.amount),N=await C.insert("transactions",{date:s.date,type:s.type.trim(),team:s.team.trim(),amount:S,info:s.info.trim(),match_id:null});if(N.error)throw new Error(`Transaction insert failed: ${N.error.message}`);await y(s.team.trim(),s.type.trim(),S),t({team:"",type:"",amount:"",info:"",date:new Date().toISOString().split("T")[0]}),d(!1),$.success("Transaktion erfolgreich hinzugefügt!")}catch(S){console.error("Transaction submission error:",S),$.error(S.message||"Fehler beim Hinzufügen der Transaktion")}finally{o(!1)}},y=async(a,S,N)=>{try{const T=await C.select("finances","*",{eq:{team:a}});let i=T.data&&T.data.length>0?T.data[0]:{team:a,balance:0,debt:0},k={};if(S==="Echtgeld-Ausgleich")k.debt=(i.debt||0)+N;else{let v=(i.balance||0)+N;v<0&&(v=0),k.balance=v}i.id?await C.update("finances",k,i.id):await C.insert("finances",{team:a,balance:k.balance||0,debt:k.debt||0})}catch(T){console.warn("Failed to update finances:",T)}},x=s.team&&s.type&&s.amount&&s.date;return e.jsxs("div",{className:"p-4",children:[e.jsxs("div",{className:"mb-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-text-primary mb-2",children:"Neue Transaktion hinzufügen"}),e.jsx("p",{className:"text-text-muted text-sm",children:"Erfassen Sie eine neue finanzielle Transaktion."})]}),e.jsx("div",{className:"modern-card",children:e.jsxs("div",{className:"text-center py-8",children:[e.jsx("div",{className:"text-4xl mb-4",children:"💰"}),e.jsx("h4",{className:"text-lg font-medium text-text-primary mb-2",children:"Transaktion hinzufügen"}),e.jsx("p",{className:"text-text-muted mb-6",children:"Klicken Sie auf den Button, um eine neue Transaktion zu erfassen."}),e.jsxs("button",{onClick:()=>d(!0),className:"btn-primary",children:[e.jsx("i",{className:"fas fa-plus mr-2"}),"Neue Transaktion erfassen"]})]})}),f&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-[60] p-4",children:e.jsx("div",{className:"bg-bg-secondary rounded-lg max-w-md w-full modal-content",children:e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsx("h3",{className:"text-xl font-semibold text-text-primary",children:"Neue Transaktion"}),e.jsx("button",{onClick:()=>d(!1),className:"text-text-muted hover:text-text-primary text-2xl",disabled:l,children:"×"})]}),e.jsxs("form",{onSubmit:w,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text-primary mb-2",children:"Team *"}),e.jsxs("select",{value:s.team,onChange:a=>u("team",a.target.value),className:"form-input",required:!0,disabled:l,children:[e.jsx("option",{value:"",children:"Team wählen"}),G.filter(a=>a.value!=="Ehemalige").map(a=>e.jsx("option",{value:a.value,children:I(a.value)},a.value))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text-primary mb-2",children:"Transaktionsart *"}),e.jsxs("select",{value:s.type,onChange:a=>u("type",a.target.value),className:"form-input",required:!0,disabled:l,children:[e.jsx("option",{value:"",children:"Typ wählen"}),J.map(a=>e.jsxs("option",{value:a.value,children:[a.icon," ",a.label]},a.value))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text-primary mb-2",children:"Betrag (€) *"}),e.jsx("input",{type:"number",step:"0.01",value:s.amount,onChange:a=>u("amount",a.target.value),className:"form-input",placeholder:"0.00",required:!0,disabled:l}),e.jsx("p",{className:"text-xs text-text-muted mt-1",children:"Negative Werte für Ausgaben, positive für Einnahmen"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text-primary mb-2",children:"Beschreibung"}),e.jsx("input",{type:"text",value:s.info,onChange:a=>u("info",a.target.value),className:"form-input",placeholder:"Zusätzliche Informationen...",disabled:l})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text-primary mb-2",children:"Datum *"}),e.jsx("input",{type:"date",value:s.date,onChange:a=>u("date",a.target.value),className:"form-input",required:!0,disabled:l})]}),e.jsxs("div",{className:"flex gap-3 pt-4",children:[e.jsx("button",{type:"button",onClick:()=>d(!1),className:"flex-1 px-4 py-2 border border-border-light rounded-lg text-text-secondary hover:bg-bg-tertiary transition-colors",disabled:l,children:"Abbrechen"}),e.jsx("button",{type:"submit",disabled:!x||l,className:"flex-1 btn-primary disabled:opacity-50 disabled:cursor-not-allowed",children:l?e.jsxs("div",{className:"flex items-center justify-center",children:[e.jsx("div",{className:"spinner w-4 h-4 mr-2"}),"Speichern..."]}):"Speichern"})]})]})]})})}),e.jsxs("div",{className:"mt-6 modern-card",children:[e.jsx("h4",{className:"font-semibold text-text-primary mb-3",children:"Transaktionsarten"}),e.jsx("div",{className:"grid grid-cols-2 gap-2",children:J.map(a=>e.jsxs("div",{className:"p-3 bg-bg-secondary rounded-lg text-center",children:[e.jsx("div",{className:"text-2xl mb-2",children:a.icon}),e.jsx("span",{className:"font-medium text-text-primary",children:a.label})]},a.value))})]}),e.jsxs("div",{className:"mt-6 modern-card",children:[e.jsx("h4",{className:"font-semibold text-text-primary mb-3",children:"Verfügbare Teams"}),e.jsx("div",{className:"grid grid-cols-2 gap-2",children:G.filter(a=>a.value!=="Ehemalige").map(a=>e.jsxs("div",{className:"p-3 bg-bg-secondary rounded-lg text-center",children:[e.jsx("span",{className:`font-medium ${a.color==="blue"?"text-blue-600":"text-red-600"}`,children:I(a.value)}),e.jsxs("div",{className:"text-xs text-text-muted mt-1",children:["(",a.value,")"]})]},a.value))})]}),e.jsx("div",{className:"mt-6 modern-card bg-blue-50 border-blue-200",children:e.jsxs("div",{className:"flex items-start",children:[e.jsx("div",{className:"text-blue-600 mr-3",children:e.jsx("i",{className:"fas fa-info-circle"})}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold text-blue-800 mb-1",children:"Hinweis"}),e.jsx("p",{className:"text-blue-700 text-sm",children:"Nach dem Hinzufügen können Sie die Transaktion in der Finanzen-Übersicht einsehen."})]})]})})]})}function oe(){var Z;const[f,d]=D.useState("players"),[s,t]=D.useState(!1),[l,o]=D.useState(""),{data:u,refetch:w}=L("players","*",{order:{column:"id",ascending:!1}}),{data:y,refetch:x}=L("matches","*",{order:{column:"date",ascending:!1}}),{data:a,refetch:S}=L("bans","*",{order:{column:"id",ascending:!1}}),{data:N,refetch:T}=L("transactions","*",{order:{column:"date",ascending:!1}}),{remove:i}=H("players"),{remove:k}=H("bans"),{remove:v}=H("transactions"),g=[{id:"players",label:"Spieler löschen",icon:"fas fa-users"},{id:"matches",label:"Spiele löschen",icon:"fas fa-futbol"},{id:"bans",label:"Sperren löschen",icon:"fas fa-ban"},{id:"transactions",label:"Transaktionen löschen",icon:"fas fa-euro-sign"}],K=n=>{d(n),o("")},r=()=>{switch(f){case"players":return{total:(u==null?void 0:u.length)||0,filtered:z(u).length};case"matches":return{total:(y==null?void 0:y.length)||0,filtered:F(y).length};case"bans":return{total:(a==null?void 0:a.length)||0,filtered:_(a).length};case"transactions":return{total:(N==null?void 0:N.length)||0,filtered:R(N).length};default:return{total:0,filtered:0}}},c=async n=>{const h=(a==null?void 0:a.filter(p=>p.player_id===n.id||p.player_name===n.name))||[];let j=`Sind Sie sicher, dass Sie ${n.name} (${n.team}) löschen möchten?`;if(h.length>0&&(j+=`

Achtung: ${h.length} zugehörige Sperre(n) werden ebenfalls gelöscht.`),n.goals&&n.goals>0&&(j+=`
Der Spieler hat ${n.goals} Tor(e) erzielt.`),!!confirm(j)){t(!0);try{await i(n.id),$.success(`Spieler ${n.name} erfolgreich gelöscht`),w(),h.length>0&&S()}catch(p){$.error("Fehler beim Löschen des Spielers: "+p.message)}finally{t(!1)}}},m=async n=>{const h=(N==null?void 0:N.filter(M=>M.match_id===n.id))||[],j=`AEK ${n.goalsa||0} - ${n.goalsb||0} Real`;let p=`Sind Sie sicher, dass Sie das Spiel vom ${new Date(n.date).toLocaleDateString("de-DE")} (${j}) löschen möchten?`;if(h.length>0&&(p+=`

Achtung: ${h.length} zugehörige Transaktion(en) werden ebenfalls gelöscht.`),n.manofthematch&&(p+=`
Spieler des Spiels: ${n.manofthematch}`),!!confirm(p)){t(!0);try{const{deleteMatch:M}=await re(async()=>{const{deleteMatch:B}=await import("./matches-Bz0wv9ua.js");return{deleteMatch:B}},__vite__mapDeps([0,1]));await M(n.id),$.success("Spiel erfolgreich gelöscht"),x(),h.length>0&&T()}catch(M){$.error("Fehler beim Löschen des Spiels: "+M.message)}finally{t(!1)}}},b=async n=>{var M;const h=n.player_name||(n.player_id&&u?(M=u.find(B=>B.id===n.player_id))==null?void 0:M.name:"Unbekannter Spieler"),j=Math.max(0,(n.totalgames||0)-(n.matchesserved||0));let p=`Sind Sie sicher, dass Sie die Sperre für ${h} löschen möchten?`;if(p+=`
Sperrtyp: ${n.type}`,j>0?p+=`
Noch ${j} Spiel(e) verbleibend`:p+=`
Sperre bereits abgesessen`,n.reason&&(p+=`
Grund: ${n.reason}`),!!confirm(p)){t(!0);try{await k(n.id),$.success(`Sperre für ${h} erfolgreich gelöscht`),S()}catch(B){$.error("Fehler beim Löschen der Sperre: "+B.message)}finally{t(!1)}}},A=async n=>{const h=n.match_id&&y?y.find(p=>p.id===n.match_id):null;let j=`Sind Sie sicher, dass Sie die Transaktion "${n.type}" löschen möchten?`;if(j+=`
Betrag: ${n.amount>0?"+":""}${n.amount}M € (${n.team})`,n.date&&(j+=`
Datum: ${new Date(n.date).toLocaleDateString("de-DE")}`),n.info&&(j+=`
Info: ${n.info}`),h&&(j+=`
Zugehöriges Spiel: ${new Date(h.date).toLocaleDateString("de-DE")} (AEK ${h.goalsa||0} - ${h.goalsb||0} Real)`),!!confirm(j)){t(!0);try{await v(n.id),$.success("Transaktion erfolgreich gelöscht"),T()}catch(p){$.error("Fehler beim Löschen der Transaktion: "+p.message)}finally{t(!1)}}},E=n=>{const h=G.find(j=>j.value===n);return h?h.icon:"⚫"},z=n=>l?(n||[]).filter(h=>{var j,p,M;return((j=h.name)==null?void 0:j.toLowerCase().includes(l.toLowerCase()))||((p=h.team)==null?void 0:p.toLowerCase().includes(l.toLowerCase()))||((M=h.position)==null?void 0:M.toLowerCase().includes(l.toLowerCase()))}):n||[],F=n=>l?(n||[]).filter(h=>{var j;return new Date(h.date).toLocaleDateString("de-DE").includes(l)||((j=h.manofthematch)==null?void 0:j.toLowerCase().includes(l.toLowerCase()))}):n||[],_=n=>l?(n||[]).filter(h=>{var p,M,B,W;const j=h.player_name||(h.player_id&&u?(p=u.find(le=>le.id===h.player_id))==null?void 0:p.name:"");return(j==null?void 0:j.toLowerCase().includes(l.toLowerCase()))||((M=h.type)==null?void 0:M.toLowerCase().includes(l.toLowerCase()))||((B=h.team)==null?void 0:B.toLowerCase().includes(l.toLowerCase()))||((W=h.reason)==null?void 0:W.toLowerCase().includes(l.toLowerCase()))}):n||[],R=n=>l?(n||[]).filter(h=>{var j,p,M,B;return((j=h.type)==null?void 0:j.toLowerCase().includes(l.toLowerCase()))||((p=h.team)==null?void 0:p.toLowerCase().includes(l.toLowerCase()))||((M=h.info)==null?void 0:M.toLowerCase().includes(l.toLowerCase()))||((B=h.amount)==null?void 0:B.toString().includes(l))}):n||[],P=()=>{const n=z(u);return!n||n.length===0?e.jsx("p",{className:"text-text-muted text-center py-4",children:l?"Keine Spieler gefunden":"Keine Spieler vorhanden"}):e.jsx("div",{className:"space-y-2",children:n.map(h=>e.jsxs("div",{className:"flex items-center justify-between p-3 bg-bg-tertiary rounded-lg",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("span",{className:"text-lg",children:E(h.team)}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-text-primary",children:h.name}),e.jsxs("p",{className:"text-sm text-text-muted",children:[h.team," • ",h.position,h.goals!==void 0&&e.jsxs("span",{className:"ml-2",children:["• ",h.goals," Tore"]})]})]})]}),e.jsxs("button",{onClick:()=>c(h),disabled:s,className:"btn-secondary btn-sm text-accent-red hover:bg-red-50 disabled:opacity-50",children:[e.jsx("i",{className:"fas fa-trash mr-1"}),"Löschen"]})]},h.id))})},O=()=>{const n=F(y);return!n||n.length===0?e.jsx("p",{className:"text-text-muted text-center py-4",children:l?"Keine Spiele gefunden":"Keine Spiele vorhanden"}):e.jsx("div",{className:"space-y-2",children:n.map(h=>e.jsxs("div",{className:"flex items-center justify-between p-3 bg-bg-tertiary rounded-lg",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-text-primary",children:new Date(h.date).toLocaleDateString("de-DE")}),e.jsxs("p",{className:"text-sm text-text-muted",children:["AEK ",h.goalsa||0," - ",h.goalsb||0," Real"]}),h.manofthematch&&e.jsxs("p",{className:"text-xs text-text-muted mt-1",children:[e.jsx("i",{className:"fas fa-star mr-1"}),"SdS: ",h.manofthematch]})]}),e.jsxs("button",{onClick:()=>m(h),disabled:s,className:"btn-secondary btn-sm text-accent-red hover:bg-red-50 disabled:opacity-50",children:[e.jsx("i",{className:"fas fa-trash mr-1"}),"Löschen"]})]},h.id))})},te=()=>{const n=_(a);if(!n||n.length===0)return e.jsx("p",{className:"text-text-muted text-center py-4",children:l?"Keine Sperren gefunden":"Keine Sperren vorhanden"});const h=p=>{if(p.player_name)return p.player_name;if(p.player_id&&u){const M=u.find(B=>B.id===p.player_id);return M?M.name:"Unbekannter Spieler"}return"Unbekannter Spieler"},j=p=>{const M=(p.totalgames||0)-(p.matchesserved||0);return Math.max(0,M)};return e.jsx("div",{className:"space-y-2",children:n.map(p=>e.jsxs("div",{className:"flex items-center justify-between p-3 bg-bg-tertiary rounded-lg",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("span",{className:"text-lg",children:E(p.team)}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-text-primary",children:h(p)}),e.jsxs("p",{className:"text-sm text-text-muted",children:[p.type," • ",p.totalgames||0," Spiele",j(p)>0?` (${j(p)} verbleibend)`:" (abgesessen)"]}),p.reason&&e.jsxs("p",{className:"text-xs text-text-muted mt-1",children:["Grund: ",p.reason]})]})]}),e.jsxs("button",{onClick:()=>b(p),disabled:s,className:"btn-secondary btn-sm text-accent-red hover:bg-red-50 disabled:opacity-50",children:[e.jsx("i",{className:"fas fa-trash mr-1"}),"Löschen"]})]},p.id))})},se=()=>{const n=R(N);if(!n||n.length===0)return e.jsx("p",{className:"text-text-muted text-center py-4",children:l?"Keine Transaktionen gefunden":"Keine Transaktionen vorhanden"});const h=j=>{if(!j.match_id||!y)return null;const p=y.find(M=>M.id===j.match_id);return p?`Match: ${new Date(p.date).toLocaleDateString("de-DE")} (AEK ${p.goalsa||0} - ${p.goalsb||0} Real)`:null};return e.jsx("div",{className:"space-y-2",children:n.map(j=>e.jsxs("div",{className:"flex items-center justify-between p-3 bg-bg-tertiary rounded-lg",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("span",{className:"text-lg",children:E(j.team)}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h4",{className:"font-medium text-text-primary",children:j.type}),e.jsxs("p",{className:"text-sm text-text-muted",children:[e.jsxs("span",{className:j.amount>0?"text-green-600":"text-red-600",children:[j.amount>0?"+":"",j.amount,"M €"]}),j.date&&e.jsxs("span",{className:"ml-2",children:["• ",new Date(j.date).toLocaleDateString("de-DE")]})]}),j.info&&e.jsx("p",{className:"text-xs text-text-muted mt-1",children:j.info}),h(j)&&e.jsxs("p",{className:"text-xs text-blue-600 mt-1",children:[e.jsx("i",{className:"fas fa-futbol mr-1"}),h(j)]})]})]}),e.jsxs("button",{onClick:()=>A(j),disabled:s,className:"btn-secondary btn-sm text-accent-red hover:bg-red-50 disabled:opacity-50",children:[e.jsx("i",{className:"fas fa-trash mr-1"}),"Löschen"]})]},j.id))})},ae=()=>{switch(f){case"players":return P();case"matches":return O();case"bans":return te();case"transactions":return se();default:return P()}};return e.jsxs("div",{className:"p-4",children:[e.jsxs("div",{className:"mb-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-text-primary mb-2",children:"Daten löschen"}),e.jsx("p",{className:"text-text-muted text-sm",children:"Verwalten Sie die Löschung von Spielern, Spielen, Sperren und Transaktionen."})]}),e.jsx("div",{className:"grid grid-cols-2 gap-2 mb-6",children:g.map(n=>e.jsxs("button",{onClick:()=>K(n.id),className:`p-3 rounded-lg text-sm font-medium transition-colors ${f===n.id?"bg-accent-red text-white":"bg-bg-tertiary text-text-secondary hover:text-text-primary hover:bg-bg-hover"}`,children:[e.jsx("i",{className:`${n.icon} mr-2`}),n.label]},n.id))}),e.jsxs("div",{className:"mb-4",children:[e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:"text",placeholder:`${(Z=g.find(n=>n.id===f))==null?void 0:Z.label.replace(" löschen","")} durchsuchen...`,value:l,onChange:n=>o(n.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-accent-red focus:border-transparent text-text-primary bg-bg-secondary"}),e.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:e.jsx("i",{className:"fas fa-search text-text-muted"})}),l&&e.jsx("button",{onClick:()=>o(""),className:"absolute inset-y-0 right-0 pr-3 flex items-center text-text-muted hover:text-text-primary",children:e.jsx("i",{className:"fas fa-times"})})]}),e.jsxs("div",{className:"flex justify-between items-center mt-2",children:[l&&e.jsxs("p",{className:"text-xs text-text-muted",children:[e.jsx("i",{className:"fas fa-filter mr-1"}),"Gefiltert nach: “",l,"”"]}),e.jsx("p",{className:"text-xs text-text-muted ml-auto",children:(()=>{const n=r();return l?`${n.filtered} von ${n.total} Einträgen`:`${n.total} Einträge`})()})]})]}),e.jsxs("div",{className:"modern-card",children:[s&&e.jsx(ee,{message:"Lösche..."}),!s&&ae()]}),e.jsx("div",{className:"mt-6 modern-card bg-red-50 border-red-200",children:e.jsxs("div",{className:"flex items-start",children:[e.jsx("div",{className:"text-red-600 mr-3",children:e.jsx("i",{className:"fas fa-exclamation-triangle"})}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold text-red-800 mb-1",children:"Achtung"}),e.jsx("p",{className:"text-red-700 text-sm",children:"Das Löschen von Daten ist permanent und kann nicht rückgängig gemacht werden. Bitte überprüfen Sie Ihre Auswahl sorgfältig, bevor Sie fortfahren."})]})]})})]})}function me({data:f=[],searchFields:d=[],filterOptions:s=[],onResults:t,placeholder:l="Suchen...",showCount:o=!0}){const[u,w]=D.useState(""),[y,x]=D.useState({}),[a,S]=D.useState(""),[N,T]=D.useState("asc"),i=D.useRef(null),k=D.useMemo(()=>{let c=[...f];if(u.trim()){const m=u.toLowerCase().trim();c=c.filter(b=>d.some(A=>{const E=V(b,A);return E&&E.toString().toLowerCase().includes(m)}))}return Object.entries(y).forEach(([m,b])=>{if(b&&b!=="all"){const A=s.find(E=>E.key===m);A&&A.filterFn?c=c.filter(E=>A.filterFn(E,b)):c=c.filter(E=>V(E,m)===b)}}),a&&c.sort((m,b)=>{const A=V(m,a),E=V(b,a);let z=0;return typeof A=="number"&&typeof E=="number"?z=A-E:A instanceof Date&&E instanceof Date?z=A.getTime()-E.getTime():z=String(A).localeCompare(String(E)),N==="desc"?-z:z}),c},[f,u,y,a,N,d,s]);D.useEffect(()=>{t&&JSON.stringify(k)!==i.current&&(i.current=JSON.stringify(k),t(k))},[k,t]);const v=(c,m)=>{x(b=>({...b,[c]:m}))},g=c=>{a===c?T(N==="asc"?"desc":"asc"):(S(c),T("asc"))},K=()=>{w(""),x({}),S(""),T("asc")},r=u||Object.values(y).some(c=>c&&c!=="all")||a;return e.jsxs("div",{className:"bg-bg-primary border border-border-light rounded-lg shadow-sm mb-4",children:[e.jsx("div",{className:"p-4 border-b border-border-light",children:e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center",children:e.jsx("span",{className:"text-text-secondary","aria-hidden":"true",children:"🔍"})}),e.jsx("input",{type:"text",value:u,onChange:c=>w(c.target.value),placeholder:`${l} (Strg+K für globale Suche)`,className:"w-full pl-10 pr-20 py-2 bg-bg-secondary border border-border-light rounded-lg text-text-primary placeholder-text-secondary focus:outline-none focus:ring-2 focus:ring-primary-green focus:border-transparent"}),e.jsxs("div",{className:"absolute inset-y-0 right-0 flex items-center gap-1 pr-3",children:[e.jsx("button",{onClick:()=>{const c=new CustomEvent("global-search-toggle");window.dispatchEvent(c)},className:"text-text-secondary hover:text-primary-green transition-colors p-1 rounded",title:"Globale Suche öffnen (Strg+K)",children:e.jsx("span",{"aria-hidden":"true",children:"🌐"})}),u&&e.jsx("button",{onClick:()=>w(""),className:"text-text-secondary hover:text-text-primary transition-colors p-1 rounded",title:"Suchfeld leeren",children:e.jsx("span",{"aria-hidden":"true",children:"✕"})})]})]})}),(s.length>0||a)&&e.jsx("div",{className:"p-4 border-b border-border-light",children:e.jsxs("div",{className:"flex flex-wrap gap-2 items-center",children:[s.map(c=>e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("label",{className:"text-sm font-medium text-text-primary",children:[c.label,":"]}),e.jsxs("select",{value:y[c.key]||"",onChange:m=>v(c.key,m.target.value),className:"px-3 py-1 bg-bg-secondary border border-border-light rounded text-sm text-text-primary focus:outline-none focus:ring-2 focus:ring-primary-green",children:[e.jsx("option",{value:"",children:"Alle"}),c.options.map(m=>e.jsx("option",{value:m.value,children:m.label},m.value))]})]},c.key)),d.length>0&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("label",{className:"text-sm font-medium text-text-primary",children:"Sortieren:"}),e.jsxs("select",{value:a,onChange:c=>S(c.target.value),className:"px-3 py-1 bg-bg-secondary border border-border-light rounded text-sm text-text-primary focus:outline-none focus:ring-2 focus:ring-primary-green",children:[e.jsx("option",{value:"",children:"Standard"}),d.map(c=>e.jsx("option",{value:c,children:Y(c)},c))]}),a&&e.jsx("button",{onClick:()=>g(a),className:"px-2 py-1 bg-bg-secondary border border-border-light rounded text-sm text-text-primary hover:bg-bg-tertiary transition-colors duration-200",title:`Sortierung: ${N==="asc"?"Aufsteigend":"Absteigend"}`,children:N==="asc"?"↑":"↓"})]}),r&&e.jsx("button",{onClick:K,className:"px-3 py-1 bg-red-100 text-red-800 border border-red-200 rounded text-sm hover:bg-red-200 transition-colors duration-200",children:"Filter zurücksetzen"})]})}),o&&e.jsx("div",{className:"px-4 py-2 bg-bg-secondary border-b border-border-light",children:e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsx("span",{className:"text-text-secondary",children:k.length===f.length?`${f.length} Einträge`:`${k.length} von ${f.length} Einträgen`}),r&&e.jsxs("div",{className:"flex items-center gap-2",children:[u&&e.jsxs("span",{className:"bg-primary-green bg-opacity-10 text-primary-green px-2 py-1 rounded text-xs",children:['🔍 "',u,'"']}),Object.entries(y).filter(([,c])=>c&&c!=="all").map(([c,m])=>{const b=s.find(E=>E.key===c),A=b==null?void 0:b.options.find(E=>E.value===m);return e.jsxs("span",{className:"bg-blue-100 text-blue-800 px-2 py-1 rounded text-xs",children:[b==null?void 0:b.label,": ",(A==null?void 0:A.label)||m]},c)}),a&&e.jsxs("span",{className:"bg-yellow-100 text-yellow-800 px-2 py-1 rounded text-xs",children:["📊 ",Y(a)," ",N==="asc"?"↑":"↓"]})]})]})})]})}function V(f,d){return!f||!d?"":d.split(".").reduce((s,t)=>s&&s[t]!==void 0?s[t]:"",f)}function Y(f){return{name:"Name",team:"Team",position:"Position",value:"Wert",date:"Datum",goalsa:"AEK Tore",goalsb:"Real Tore",type:"Typ",amount:"Betrag",description:"Beschreibung",totalgames:"Gesamt Spiele",matchesserved:"Gespielte Spiele"}[f]||f.charAt(0).toUpperCase()+f.slice(1)}function X(){const[f,d]=D.useState("players"),[s,t]=D.useState([]),{data:l,loading:o}=L("players","*"),{data:u,loading:w}=L("matches","*",{order:{column:"date",ascending:!1}}),{data:y,loading:x}=L("transactions","*",{order:{column:"date",ascending:!1}}),{data:a,loading:S}=L("bans","*",{order:{column:"id",ascending:!1}}),N=o||w||x||S,T=[{id:"players",label:"Spieler",icon:"fas fa-users",data:l||[],searchFields:["name","position","team","value"],filterOptions:[{key:"team",label:"Team",options:[{value:"AEK",label:"AEK Athen"},{value:"Real",label:"Real Madrid"},{value:"Ehemalige",label:"Ehemalige"}]},{key:"position",label:"Position",options:[{value:"TH",label:"Torwart"},{value:"IV",label:"Innenverteidiger"},{value:"LV",label:"Linksverteidiger"},{value:"RV",label:"Rechtsverteidiger"},{value:"ZDM",label:"Defensives Mittelfeld"},{value:"ZM",label:"Zentrales Mittelfeld"},{value:"ZOM",label:"Offensives Mittelfeld"},{value:"LM",label:"Linkes Mittelfeld"},{value:"RM",label:"Rechtes Mittelfeld"},{value:"LF",label:"Linker Flügel"},{value:"RF",label:"Rechter Flügel"},{value:"ST",label:"Stürmer"}]}]},{id:"matches",label:"Spiele",icon:"fas fa-futbol",data:u||[],searchFields:["date","goalsa","goalsb"],filterOptions:[]},{id:"transactions",label:"Transaktionen",icon:"fas fa-euro-sign",data:y||[],searchFields:["type","description","amount","date"],filterOptions:[{key:"type",label:"Typ",options:[{value:"transfer",label:"Transfer"},{value:"preis",label:"Preisgeld"},{value:"strafe",label:"Strafe"},{value:"sonstige",label:"Sonstige"}],filterFn:(v,g)=>{var c,m;const K=((c=v.type)==null?void 0:c.toLowerCase())||"",r=((m=v.description)==null?void 0:m.toLowerCase())||"";switch(g){case"transfer":return K.includes("transfer")||r.includes("transfer");case"preis":return K.includes("preis")||r.includes("preis")||v.amount>0;case"strafe":return K.includes("strafe")||r.includes("strafe");case"sonstige":return!K.includes("transfer")&&!K.includes("preis")&&!K.includes("strafe");default:return!0}}}]},{id:"bans",label:"Sperren",icon:"fas fa-ban",data:a||[],searchFields:["player_name","team","type","reason"],filterOptions:[{key:"team",label:"Team",options:[{value:"AEK",label:"AEK Athen"},{value:"Real",label:"Real Madrid"}]},{key:"type",label:"Typ",options:[{value:"Gelbe Karte",label:"Gelbe Karte"},{value:"Gelb-Rote Karte",label:"Gelb-Rote Karte"},{value:"Rote Karte",label:"Rote Karte"},{value:"Verletzung",label:"Verletzung"}]}]}],i=T.find(v=>v.id===f),k=()=>{const v=s.length>0?s:i.data;return v.length===0?e.jsxs("div",{className:"p-6 text-center text-text-secondary",children:[e.jsx("i",{className:`${i.icon} text-4xl mb-2`}),e.jsxs("p",{children:["Keine ",i.label.toLowerCase()," gefunden"]})]}):e.jsx("div",{className:"divide-y divide-border-light",children:v.map(g=>e.jsxs("div",{className:"p-4 hover:bg-bg-secondary transition-colors",children:[f==="players"&&e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"font-medium text-text-primary",children:g.name}),e.jsxs("p",{className:"text-sm text-text-secondary",children:[g.position," • ",g.team," • ",g.value||0,"M €"]}),(g.goals||0)>0&&e.jsxs("p",{className:"text-xs text-primary-green",children:["⚽ ",g.goals||0," Tore"]})]}),e.jsx("div",{className:"text-right",children:e.jsxs("div",{className:"text-lg font-bold text-primary-green",children:[g.value||0,"M €"]})})]}),f==="matches"&&e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"font-medium text-text-primary",children:new Date(g.date).toLocaleDateString("de-DE")}),e.jsxs("p",{className:"text-sm text-text-secondary",children:["AEK ",g.goalsa||0," - ",g.goalsb||0," Real"]})]}),e.jsx("div",{className:"text-right",children:e.jsxs("div",{className:"text-lg font-bold text-primary-green",children:[(g.goalsa||0)+(g.goalsb||0)," Tore"]})})]}),f==="transactions"&&e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"font-medium text-text-primary",children:g.type||"Transaktion"}),e.jsx("p",{className:"text-sm text-text-secondary",children:g.description||"Keine Beschreibung"}),e.jsx("p",{className:"text-xs text-text-secondary",children:new Date(g.date).toLocaleDateString("de-DE")})]}),e.jsx("div",{className:"text-right",children:e.jsxs("div",{className:`text-lg font-bold ${(g.amount||0)>=0?"text-green-600":"text-red-600"}`,children:[(g.amount||0)>0?"+":"",g.amount||0,"€"]})})]}),f==="bans"&&e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"font-medium text-text-primary",children:g.player_name}),e.jsxs("p",{className:"text-sm text-text-secondary",children:[g.team," • ",g.type]}),g.reason&&e.jsx("p",{className:"text-xs text-text-secondary",children:g.reason})]}),e.jsx("div",{className:"text-right",children:e.jsxs("div",{className:"text-sm text-accent-red",children:[g.duration||1," Spiel",(g.duration||1)!==1?"e":""]})})]})]},g.id))})};return N?e.jsx(ee,{message:"Lade Daten..."}):e.jsxs("div",{className:"p-4 space-y-4",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-text-primary mb-1",children:"🔍 Globale Suche"}),e.jsx("p",{className:"text-text-muted text-sm",children:"Durchsuche alle Daten zentral an einem Ort"})]}),e.jsx("div",{className:"flex overflow-x-auto space-x-2 pb-2",children:T.map(v=>e.jsxs("button",{onClick:()=>{d(v.id),t([])},className:`flex items-center space-x-2 px-4 py-2 rounded-lg whitespace-nowrap transition-colors ${f===v.id?"bg-primary-green text-white":"bg-bg-secondary text-text-muted hover:bg-bg-tertiary"}`,children:[e.jsx("i",{className:v.icon}),e.jsx("span",{className:"font-medium",children:v.label}),e.jsxs("span",{className:"text-xs opacity-75",children:["(",v.data.length,")"]})]},v.id))}),e.jsx(me,{data:i.data,searchFields:i.searchFields,filterOptions:i.filterOptions,onResults:t,placeholder:`${i.label} durchsuchen...`}),e.jsxs("div",{className:"modern-card",children:[e.jsx("div",{className:"p-4 border-b border-border-light",children:e.jsxs("h4",{className:"font-medium text-text-primary",children:[s.length>0?"Suchergebnisse":`Alle ${i.label}`,e.jsxs("span",{className:"text-text-secondary ml-2",children:["(",s.length>0?s.length:i.data.length,")"]})]})}),k()]})]})}function he({onLogout:f}){const[d,s]=D.useState("search"),t=[{id:"search",label:"Globale Suche",icon:"fas fa-search"},{id:"matches",label:"Spiele hinzufügen",icon:"fas fa-futbol"},{id:"bans",label:"Sperren hinzufügen",icon:"fas fa-ban"},{id:"players",label:"Spieler hinzufügen",icon:"fas fa-users"},{id:"transactions",label:"Transaktionen hinzufügen",icon:"fas fa-euro-sign"},{id:"delete",label:"Daten löschen",icon:"fas fa-trash"}],l=()=>{switch(d){case"search":return e.jsx(X,{});case"matches":return e.jsx(ne,{});case"bans":return e.jsx(ie,{});case"players":return e.jsx(ce,{});case"transactions":return e.jsx(de,{});case"delete":return e.jsx(oe,{});default:return e.jsx(X,{})}};return e.jsxs("div",{className:"flex flex-col h-full",children:[e.jsxs("div",{className:"p-4 bg-bg-secondary border-b border-border-light flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-semibold text-text-primary mb-1",children:"Verwaltung"}),e.jsx("p",{className:"text-text-muted text-sm",children:"Hinzufügen und verwalten von Daten"})]}),e.jsxs("button",{onClick:f,className:"flex items-center px-3 py-2 bg-accent-red text-white rounded-lg hover:bg-red-600 transition-colors focus:outline-none focus:ring-2 focus:ring-red-500 focus:ring-opacity-50","aria-label":"Abmelden",children:[e.jsx("i",{className:"fas fa-sign-out-alt mr-2"}),e.jsx("span",{className:"text-sm",children:"Logout"})]})]}),e.jsx("div",{className:"bg-bg-secondary border-b border-border-light",children:e.jsx("div",{className:"flex overflow-x-auto",children:t.map(o=>e.jsxs("button",{onClick:()=>s(o.id),className:`flex-shrink-0 px-4 py-3 text-sm font-medium transition-colors whitespace-nowrap ${d===o.id?"text-primary-green border-b-2 border-primary-green bg-bg-primary":"text-text-secondary hover:text-text-primary hover:bg-bg-hover"}`,children:[e.jsx("i",{className:`${o.icon} mr-2`}),o.label]},o.id))})}),e.jsx("div",{className:"flex-1 overflow-y-auto",children:l()})]})}export{he as default};
