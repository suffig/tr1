import{r as x,j as e,L as S,z as l}from"./index-Rev3OGod.js";import{u as k,a as _}from"./useSupabase-CtffukN8.js";function C(){const[u,m]=x.useState(!1),[i,o]=x.useState(null),[s,r]=x.useState({player_name:"",team:"AEK",matches_remaining:1,reason:""}),{data:a,loading:p,error:b,refetch:c}=k("bans","*",{order:{column:"created_at",ascending:!1}}),{insert:f,update:j,remove:g,loading:n}=_("bans"),h=()=>{r({player_name:"",team:"AEK",matches_remaining:1,reason:""}),o(null),m(!1)},N=async t=>{t.preventDefault();try{i?(await j(s,i.id),l.success("Sperre erfolgreich aktualisiert!")):(await f(s),l.success("Sperre erfolgreich hinzugefügt!")),h(),c()}catch(d){console.error("Error saving ban:",d),l.error(`Fehler beim ${i?"Aktualisieren":"Hinzufügen"} der Sperre`)}},y=t=>{r({player_name:t.player_name,team:t.team,matches_remaining:t.matches_remaining,reason:t.reason||""}),o(t),m(!0)},v=async t=>{if(confirm("Sind Sie sicher, dass Sie diese Sperre löschen möchten?"))try{await g(t),l.success("Sperre erfolgreich gelöscht!"),c()}catch(d){console.error("Error deleting ban:",d),l.error("Fehler beim Löschen der Sperre")}};return p?e.jsx(S,{message:"Lade Sperren..."}):b?e.jsxs("div",{className:"text-center py-8",children:[e.jsx("div",{className:"text-accent-red mb-4",children:e.jsx("i",{className:"fas fa-exclamation-triangle text-2xl"})}),e.jsx("p",{className:"text-text-muted mb-4",children:"Fehler beim Laden der Sperren"}),e.jsx("button",{onClick:c,className:"btn-primary",children:"Erneut versuchen"})]}):e.jsxs("div",{className:"p-4 pb-20",children:[e.jsxs("div",{className:"mb-6 flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-semibold text-text-primary mb-2",children:"Sperren"}),e.jsxs("p",{className:"text-text-muted",children:[(a==null?void 0:a.length)||0," aktive Sperren"]})]}),e.jsxs("button",{onClick:()=>m(!0),className:"btn-primary flex items-center",disabled:n,children:[e.jsx("i",{className:"fas fa-plus mr-2"}),"Neue Sperre"]})]}),u&&e.jsxs("div",{className:"modern-card mb-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-text-primary mb-4",children:i?"Sperre bearbeiten":"Neue Sperre hinzufügen"}),e.jsxs("form",{onSubmit:N,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text-primary mb-2",children:"Spielername"}),e.jsx("input",{type:"text",value:s.player_name,onChange:t=>r({...s,player_name:t.target.value}),className:"form-input",placeholder:"Name des gesperrten Spielers",required:!0})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text-primary mb-2",children:"Team"}),e.jsxs("select",{value:s.team,onChange:t=>r({...s,team:t.target.value}),className:"form-input",children:[e.jsx("option",{value:"AEK",children:"AEK"}),e.jsx("option",{value:"Real",children:"Real"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text-primary mb-2",children:"Verbleibende Spiele"}),e.jsx("input",{type:"number",value:s.matches_remaining,onChange:t=>r({...s,matches_remaining:parseInt(t.target.value)||1}),className:"form-input",min:"1",required:!0})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text-primary mb-2",children:"Grund der Sperre"}),e.jsx("input",{type:"text",value:s.reason,onChange:t=>r({...s,reason:t.target.value}),className:"form-input",placeholder:"z.B. Gelb-Rot, Unsportlichkeit, etc.",required:!0})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{type:"submit",disabled:n,className:"btn-primary disabled:opacity-50",children:n?"Speichert...":i?"Aktualisieren":"Hinzufügen"}),e.jsx("button",{type:"button",onClick:h,className:"btn-secondary",children:"Abbrechen"})]})]})]}),a&&a.length>0?e.jsx("div",{className:"space-y-4",children:a.map(t=>e.jsxs("div",{className:"modern-card",children:[e.jsxs("div",{className:"flex justify-between items-start mb-3",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"font-semibold text-text-primary",children:t.player_name}),e.jsxs("p",{className:"text-sm text-text-muted",children:[t.team," • ",t.reason]})]}),e.jsxs("div",{className:"text-right",children:[e.jsxs("div",{className:`text-lg font-bold ${t.matches_remaining>2?"text-accent-red":t.matches_remaining>1?"text-accent-orange":"text-primary-green"}`,children:[t.matches_remaining," Spiel",t.matches_remaining!==1?"e":""]}),e.jsx("p",{className:"text-xs text-text-muted",children:"verbleibend"})]})]}),e.jsxs("div",{className:"flex gap-2 mt-3 pt-3 border-t",children:[e.jsxs("button",{onClick:()=>y(t),className:"text-primary-blue hover:text-primary-blue-dark text-sm font-medium",disabled:n,children:[e.jsx("i",{className:"fas fa-edit mr-1"}),"Bearbeiten"]}),e.jsxs("button",{onClick:()=>v(t.id),className:"text-accent-red hover:text-red-700 text-sm font-medium",disabled:n,children:[e.jsx("i",{className:"fas fa-trash mr-1"}),"Löschen"]})]})]},t.id))}):e.jsxs("div",{className:"text-center py-12",children:[e.jsx("div",{className:"text-text-muted mb-4",children:e.jsx("i",{className:"fas fa-ban text-4xl opacity-50"})}),e.jsx("h3",{className:"text-lg font-medium text-text-primary mb-2",children:"Keine Sperren gefunden"}),e.jsx("p",{className:"text-text-muted mb-4",children:"Aktuell sind keine Spieler gesperrt."}),e.jsx("button",{onClick:()=>m(!0),className:"btn-primary",children:"Erste Sperre hinzufügen"})]})]})}export{C as default};
