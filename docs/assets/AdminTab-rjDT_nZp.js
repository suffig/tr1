const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/matches-Bz0wv9ua.js","assets/dataManager-B859Fmxm.js"])))=>i.map(i=>d[i]);
import{s as g,r as E,j as e,z as A,L as O,_ as V}from"./index-DPDuxxUo.js";import{u as K,a as $}from"./useSupabase-DuoYmRVY.js";import{B as R}from"./banTypes-DuNOJEIt.js";class P{static async submitMatch(i){const{date:s,teama:t="AEK",teamb:c="Real",goalsa:n,goalsb:x,goalslista:b=[],goalslistb:f=[],ownGoalsA:d=0,ownGoalsB:l=0,yellowa:p=0,reda:w=0,yellowb:y=0,redb:r=0,manofthematch:N,editId:j=null}=i;try{const{prizeaek:S,prizereal:D,winner:a,loser:u}=this.calculatePrizeMoney(n,x,p,w,y,r);j&&await this.deleteMatchTransactions(j);const m=[...b],h=[...f];d>0&&h.push({count:d,player:"Eigentore_AEK"}),l>0&&m.push({count:l,player:"Eigentore_Real"});const k={date:s,teama:t,teamb:c,goalsa:parseInt(n)||0,goalsb:parseInt(x)||0,goalslista:b,goalslistb:f,yellowa:parseInt(p)||0,reda:parseInt(w)||0,yellowb:parseInt(y)||0,redb:parseInt(r)||0,manofthematch:N||null,prizeaek:S,prizereal:D},B=await g.insert("matches",k);if(B.error)throw new Error(`Match insert failed: ${B.error.message}`);const C=B.data.id,o=new Date().toISOString().slice(0,10);if(m.length>0){const T=m.filter(z=>typeof z=="object"&&z.player?!z.player.startsWith("Eigentore_"):!z.startsWith("Eigentore_"));await this.updatePlayersGoals(T,"AEK")}if(h.length>0){const T=h.filter(z=>typeof z=="object"&&z.player?!z.player.startsWith("Eigentore_"):!z.startsWith("Eigentore_"));await this.updatePlayersGoals(T,"Real")}return N&&await this.updatePlayerOfTheMatchStats(N),await this.processFinancialTransactions({matchId:C,date:o,prizeaek:S,prizereal:D,manofthematch:N,winner:a,loser:u}),await this.decrementBansAfterMatch(),{success:!0,matchId:C,message:`Match ${t} vs ${c} (${n}:${x}) erfolgreich hinzugefügt`}}catch(S){throw console.error("Error in submitMatch:",S),new Error(`Fehler beim Speichern des Matches: ${S.message}`)}}static calculatePrizeMoney(i,s,t,c,n,x){let b=0,f=0,d=null,l=null;return i>s?(d="AEK",l="Real"):i<s&&(d="Real",l="AEK"),d&&l&&(d==="AEK"?(b=1e6-s*5e4-t*2e4-c*5e4,f=-(5e5+i*5e4+n*2e4+x*5e4)):(f=1e6-i*5e4-n*2e4-x*5e4,b=-(5e5+s*5e4+t*2e4+c*5e4))),{prizeaek:b,prizereal:f,winner:d,loser:l}}static async updatePlayersGoals(i,s){const t={};if(i.length>0&&typeof i[0]=="object"&&i[0].player!==void 0)i.forEach(c=>{c.player&&!c.player.startsWith("Eigentore_")&&(t[c.player]=(t[c.player]||0)+(c.count||1))});else for(const c of i)!c||!c.trim()||c.startsWith("Eigentore_")||(t[c]=(t[c]||0)+1);for(const[c,n]of Object.entries(t))try{const x=await g.select("players","id, goals",{eq:{name:c,team:s}});if(x.data&&x.data.length>0){const b=x.data[0],f=(b.goals||0)+n;await g.update("players",{goals:f},b.id)}}catch(x){console.warn(`Failed to update goals for player ${c}:`,x)}}static async updatePlayerOfTheMatchStats(i){try{const s=await g.select("players","team",{eq:{name:i}});if(!s.data||s.data.length===0){console.warn(`Player ${i} not found for SdS stats`);return}const t=s.data[0].team,c=await g.select("spieler_des_spiels","*",{eq:{name:i,team:t}});if(c.data&&c.data.length>0){const n=c.data[0];await g.update("spieler_des_spiels",{count:n.count+1},n.id)}else await g.insert("spieler_des_spiels",{name:i,team:t,count:1})}catch(s){console.warn(`Failed to update SdS stats for ${i}:`,s)}}static async processFinancialTransactions({matchId:i,date:s,prizeaek:t,prizereal:c,manofthematch:n,winner:x,loser:b}){const f=await this.getTeamFinance("AEK"),d=await this.getTeamFinance("Real");let l=f.balance||0,p=d.balance||0;const w=n?await this.getSdSBonus(n,"AEK"):0,y=n?await this.getSdSBonus(n,"Real"):0;w>0&&(l+=w,await this.insertTransaction({date:s,type:"SdS Bonus",team:"AEK",amount:w,match_id:i,info:"SdS Bonus"}),await this.updateTeamBalance("AEK",l)),y>0&&(p+=y,await this.insertTransaction({date:s,type:"SdS Bonus",team:"Real",amount:y,match_id:i,info:"SdS Bonus"}),await this.updateTeamBalance("Real",p)),t!==0&&(l+=t,l<0&&(l=0),await this.insertTransaction({date:s,type:"Preisgeld",team:"AEK",amount:t,match_id:i,info:"Preisgeld"}),await this.updateTeamBalance("AEK",l)),c!==0&&(p+=c,p<0&&(p=0),await this.insertTransaction({date:s,type:"Preisgeld",team:"Real",amount:c,match_id:i,info:"Preisgeld"}),await this.updateTeamBalance("Real",p)),x&&b&&await this.processEchtgeldAusgleich({date:s,matchId:i,winner:x,loser:b,aekBalance:l,realBalance:p,prizeaek:t,prizereal:c,sdsBonusAek:w>0?1:0,sdsBonusReal:y>0?1:0,manofthematch:n})}static async getTeamFinance(i){const s=await g.select("finances","*",{eq:{team:i}});return s.data&&s.data.length>0?s.data[0]:{balance:0,debt:0}}static async getSdSBonus(i,s){const t=await g.select("players","team",{eq:{name:i}});return t.data&&t.data.length>0&&t.data[0].team===s?1e5:0}static async insertTransaction(i){return await g.insert("transactions",i)}static async updateTeamBalance(i,s){const t=await g.select("finances","id",{eq:{team:i}});return t.data&&t.data.length>0?await g.update("finances",{balance:s},t.data[0].id):await g.insert("finances",{team:i,balance:s,debt:0})}static async processEchtgeldAusgleich({date:i,matchId:s,winner:t,loser:c,aekBalance:n,realBalance:x,prizeaek:b,prizereal:f,sdsBonusAek:d,sdsBonusReal:l,manofthematch:p}){const w=await this.getTeamFinance("AEK"),y=await this.getTeamFinance("Real"),r={AEK:w.debt||0,Real:y.debt||0},N=(o,T,z)=>{let G=o;z&&(G+=1e5);let _=(Math.abs(T)-G)/1e5;return _<0&&(_=0),5+Math.round(_)},j=N(n,b,d),S=N(x,f,l),D=c==="AEK"?j:S,a=r[t],u=r[c],m=Math.min(a,D*1),h=Math.max(0,a-m),k=D*1-m,B=u+Math.max(0,k),C=await g.select("finances","id",{eq:{team:t}});if(C.data&&C.data.length>0&&await g.update("finances",{debt:h},C.data[0].id),k>0){await this.insertTransaction({date:i,type:"Echtgeld-Ausgleich",team:c,amount:Math.max(0,k),match_id:s,info:"Echtgeld-Ausgleich"});const o=await g.select("finances","id",{eq:{team:c}});o.data&&o.data.length>0&&await g.update("finances",{debt:B},o.data[0].id)}m>0&&await this.insertTransaction({date:i,type:"Echtgeld-Ausgleich (getilgt)",team:t,amount:-m,match_id:s,info:"Echtgeld-Ausgleich (getilgt)"})}static async deleteMatchTransactions(i){const s=await g.select("transactions","*",{eq:{match_id:i}});if(s.data)for(const t of s.data)await g.delete("transactions",t.id);await g.delete("matches",i)}static async decrementBansAfterMatch(){try{const i=await g.select("bans","*");if(!i.data)return;for(const s of i.data)if(s.matchesserved<s.totalgames){const t=s.matchesserved+1;await g.update("bans",{matchesserved:t},s.id)}}catch(i){console.warn("Failed to decrement bans:",i)}}}function I(){const{data:v}=K("players","*"),[i,s]=E.useState(!1),[t,c]=E.useState({teama:"AEK",teamb:"Real",date:new Date().toISOString().split("T")[0],goalsa:0,goalsb:0,goalslista:[],goalslistb:[],ownGoalsA:0,ownGoalsB:0,yellowa:0,reda:0,yellowb:0,redb:0,prizeaek:0,prizereal:0,manofthematch:"",motmTeamFilter:"all"}),[n,x]=E.useState(!1),b=(a,u,m)=>a.reduce((k,B)=>k+B.count,0)+m,f=a=>{c(u=>{const m={...u,...a};m.goalsa=b(m.goalslista,m.ownGoalsA,m.ownGoalsB),m.goalsb=b(m.goalslistb,m.ownGoalsB,m.ownGoalsA);const{prizeaek:h,prizereal:k}=P.calculatePrizeMoney(m.goalsa,m.goalsb,m.yellowa,m.reda,m.yellowb,m.redb);return m.prizeaek=h,m.prizereal=k,m})},d=(a,u)=>{f({[a]:u})},l=async a=>{a.preventDefault(),x(!0);try{const u=[],m=[],h=await P.submitMatch({date:t.date,teama:t.teama.trim(),teamb:t.teamb.trim(),goalsa:t.goalsa,goalsb:t.goalsb,goalslista:t.goalslista,goalslistb:t.goalslistb,ownGoalsA:t.ownGoalsA,ownGoalsB:t.ownGoalsB,yellowa:parseInt(t.yellowa)||0,reda:parseInt(t.reda)||0,yellowb:parseInt(t.yellowb)||0,redb:parseInt(t.redb)||0,manofthematch:t.manofthematch||null});c({teama:"AEK",teamb:"Real",date:new Date().toISOString().split("T")[0],goalsa:0,goalsb:0,goalslista:[],goalslistb:[],ownGoalsA:0,ownGoalsB:0,yellowa:0,reda:0,yellowb:0,redb:0,prizeaek:0,prizereal:0,manofthematch:"",motmTeamFilter:"all"}),s(!1),A.success(h.message)}catch(u){console.error("Match submission error:",u),A.error(u.message||"Fehler beim Hinzufügen des Spiels")}finally{x(!1)}},p=t.date,w=a=>v?v.filter(u=>u.team===a):[],y=()=>v?t.motmTeamFilter==="all"?v:v.filter(a=>a.team===t.motmTeamFilter):[],r=(a,u)=>{const m=a==="AEK"?"goalslista":"goalslistb";f({[m]:t[m].map(h=>h.player===u?{...h,count:h.count+1}:h).concat(t[m].find(h=>h.player===u)?[]:[{player:u,count:1}])})},N=(a,u)=>{const m=a==="AEK"?"goalslista":"goalslistb";f({[m]:t[m].map(h=>h.player===u?{...h,count:Math.max(0,h.count-1)}:h).filter(h=>h.count>0)})},j=(a,u)=>{const m=a==="AEK"?"ownGoalsA":"ownGoalsB",h=Math.max(0,t[m]+u);f({[m]:h})},S=(a,u)=>{if(!u)return;const m=a==="AEK"?"goalslista":"goalslistb",h=t[m].find(k=>k.player===u);f(h?{[m]:t[m].map(k=>k.player===u?{...k,count:k.count+1}:k)}:{[m]:[...t[m],{player:u,count:1}]})},D=(a,u)=>{const m=a==="AEK"?"goalslista":"goalslistb";f({[m]:t[m].filter(h=>h.player!==u)})};return e.jsxs("div",{className:"p-4",children:[e.jsxs("div",{className:"mb-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-text-primary mb-2",children:"Neues Spiel hinzufügen"}),e.jsx("p",{className:"text-text-muted text-sm",children:"Fügen Sie ein neues Spiel zur Datenbank hinzu."})]}),e.jsx("div",{className:"modern-card",children:e.jsxs("div",{className:"text-center py-8",children:[e.jsx("div",{className:"text-4xl mb-4",children:"⚽"}),e.jsx("h4",{className:"text-lg font-medium text-text-primary mb-2",children:"Spiel hinzufügen"}),e.jsx("p",{className:"text-text-muted mb-6",children:"Klicken Sie auf den Button, um ein neues Spiel zu erfassen."}),e.jsxs("button",{onClick:()=>s(!0),className:"btn-primary",children:[e.jsx("i",{className:"fas fa-plus mr-2"}),"Neues Spiel erfassen"]})]})}),i&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-[60] p-2 sm:p-4",children:e.jsx("div",{className:"bg-bg-secondary rounded-lg w-full max-w-lg modal-content",children:e.jsxs("div",{className:"p-4 sm:p-6",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsx("h3",{className:"text-xl font-semibold text-text-primary",children:"Neues Spiel"}),e.jsx("button",{onClick:()=>s(!1),className:"text-text-muted hover:text-text-primary text-2xl",disabled:n,children:"×"})]}),e.jsxs("form",{onSubmit:l,className:"space-y-4",children:[e.jsx("div",{className:"bg-gray-50 rounded-lg p-4 border",children:e.jsxs("div",{className:"text-center",children:[e.jsx("h4",{className:"text-lg font-semibold text-gray-700 mb-2",children:"⚽ Spielpaarung"}),e.jsxs("div",{className:"flex items-center justify-center space-x-4",children:[e.jsx("div",{className:"bg-blue-100 text-blue-800 px-4 py-2 rounded-lg font-medium",children:"AEK Athen"}),e.jsx("div",{className:"text-gray-500 font-bold text-xl",children:"vs"}),e.jsx("div",{className:"bg-red-100 text-red-800 px-4 py-2 rounded-lg font-medium",children:"Real Madrid"})]})]})}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text-primary mb-2",children:"Datum *"}),e.jsx("input",{type:"date",value:t.date,onChange:a=>d("date",a.target.value),className:"form-input",required:!0,disabled:n})]}),e.jsxs("div",{className:"border-t pt-4",children:[e.jsx("h4",{className:"text-sm font-medium text-text-primary mb-3",children:"⚽ Live Torwertung"}),e.jsxs("div",{className:"bg-gray-50 rounded-lg p-4 mb-4 text-center",children:[e.jsxs("div",{className:"text-2xl font-bold text-gray-700",children:[t.goalsa," : ",t.goalsb]}),e.jsxs("div",{className:"text-sm text-gray-500 mt-1",children:["AEK Athen ",t.goalsa," - ",t.goalsb," Real Madrid"]})]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4 sm:gap-6",children:[e.jsxs("div",{className:"space-y-3",children:[e.jsx("div",{className:"text-center",children:e.jsx("h5",{className:"text-sm font-medium text-blue-600 mb-3",children:"⚽ AEK Athen Torschützen"})}),e.jsx("div",{className:"space-y-2",children:t.goalslista.map((a,u)=>e.jsxs("div",{className:"flex items-center justify-between bg-blue-50 rounded-lg p-2",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"text-sm font-medium text-gray-700",children:a.player}),e.jsxs("div",{className:"text-xs text-gray-500",children:[a.count," Tor",a.count!==1?"e":""]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("button",{type:"button",onClick:()=>N("AEK",a.player),className:"w-8 h-8 bg-red-500 hover:bg-red-600 text-white rounded-full flex items-center justify-center text-sm font-bold transition-colors",disabled:n,children:"−"}),e.jsx("span",{className:"w-8 text-center font-bold text-lg text-gray-700",children:a.count}),e.jsx("button",{type:"button",onClick:()=>r("AEK",a.player),className:"w-8 h-8 bg-green-500 hover:bg-green-600 text-white rounded-full flex items-center justify-center text-sm font-bold transition-colors",disabled:n,children:"+"}),e.jsx("button",{type:"button",onClick:()=>D("AEK",a.player),className:"w-8 h-8 bg-gray-500 hover:bg-gray-600 text-white rounded-full flex items-center justify-center text-xs font-bold transition-colors",disabled:n,title:"Torschütze entfernen",children:"✕"})]})]},`aek-${a.player}-${u}`))}),e.jsx("div",{className:"border-t pt-2",children:e.jsxs("select",{onChange:a=>{a.target.value&&(S("AEK",a.target.value),a.target.value="")},className:"w-full form-input bg-blue-100 border-blue-300 text-blue-800",disabled:n,children:[e.jsx("option",{value:"",children:"+ Torschütze hinzufügen"}),w("AEK").map(a=>e.jsxs("option",{value:a.name,children:[a.name," (",a.position,")"]},a.id))]})}),e.jsxs("div",{className:"flex items-center justify-between bg-orange-50 rounded-lg p-2 border border-orange-200",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"text-sm font-medium text-gray-700",children:"Eigentore"}),e.jsx("div",{className:"text-xs text-gray-500",children:"Zählen für Real Madrid"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("button",{type:"button",onClick:()=>j("AEK",-1),className:"w-8 h-8 bg-red-500 hover:bg-red-600 text-white rounded-full flex items-center justify-center text-sm font-bold transition-colors",disabled:n||t.ownGoalsA===0,children:"−"}),e.jsx("span",{className:"w-8 text-center font-bold text-lg text-gray-700",children:t.ownGoalsA}),e.jsx("button",{type:"button",onClick:()=>j("AEK",1),className:"w-8 h-8 bg-green-500 hover:bg-green-600 text-white rounded-full flex items-center justify-center text-sm font-bold transition-colors",disabled:n,children:"+"})]})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("div",{className:"text-center",children:e.jsx("h5",{className:"text-sm font-medium text-red-600 mb-3",children:"⚽ Real Madrid Torschützen"})}),e.jsx("div",{className:"space-y-2",children:t.goalslistb.map((a,u)=>e.jsxs("div",{className:"flex items-center justify-between bg-red-50 rounded-lg p-2",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"text-sm font-medium text-gray-700",children:a.player}),e.jsxs("div",{className:"text-xs text-gray-500",children:[a.count," Tor",a.count!==1?"e":""]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("button",{type:"button",onClick:()=>N("Real",a.player),className:"w-8 h-8 bg-red-500 hover:bg-red-600 text-white rounded-full flex items-center justify-center text-sm font-bold transition-colors",disabled:n,children:"−"}),e.jsx("span",{className:"w-8 text-center font-bold text-lg text-gray-700",children:a.count}),e.jsx("button",{type:"button",onClick:()=>r("Real",a.player),className:"w-8 h-8 bg-green-500 hover:bg-green-600 text-white rounded-full flex items-center justify-center text-sm font-bold transition-colors",disabled:n,children:"+"}),e.jsx("button",{type:"button",onClick:()=>D("Real",a.player),className:"w-8 h-8 bg-gray-500 hover:bg-gray-600 text-white rounded-full flex items-center justify-center text-xs font-bold transition-colors",disabled:n,title:"Torschütze entfernen",children:"✕"})]})]},`real-${a.player}-${u}`))}),e.jsx("div",{className:"border-t pt-2",children:e.jsxs("select",{onChange:a=>{a.target.value&&(S("Real",a.target.value),a.target.value="")},className:"w-full form-input bg-red-100 border-red-300 text-red-800",disabled:n,children:[e.jsx("option",{value:"",children:"+ Torschütze hinzufügen"}),w("Real").map(a=>e.jsxs("option",{value:a.name,children:[a.name," (",a.position,")"]},a.id))]})}),e.jsxs("div",{className:"flex items-center justify-between bg-orange-50 rounded-lg p-2 border border-orange-200",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"text-sm font-medium text-gray-700",children:"Eigentore"}),e.jsx("div",{className:"text-xs text-gray-500",children:"Zählen für AEK Athen"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("button",{type:"button",onClick:()=>j("Real",-1),className:"w-8 h-8 bg-red-500 hover:bg-red-600 text-white rounded-full flex items-center justify-center text-sm font-bold transition-colors",disabled:n||t.ownGoalsB===0,children:"−"}),e.jsx("span",{className:"w-8 text-center font-bold text-lg text-gray-700",children:t.ownGoalsB}),e.jsx("button",{type:"button",onClick:()=>j("Real",1),className:"w-8 h-8 bg-green-500 hover:bg-green-600 text-white rounded-full flex items-center justify-center text-sm font-bold transition-colors",disabled:n,children:"+"})]})]})]})]})]}),e.jsxs("div",{className:"border-t pt-4",children:[e.jsx("h4",{className:"text-sm font-medium text-text-primary mb-3",children:"🟨🟥 Karten"}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-3",children:[e.jsx("p",{className:"text-xs text-blue-600 font-medium",children:"Heimteam"}),e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs text-text-muted mb-1",children:"🟨 Gelbe Karten"}),e.jsx("input",{type:"number",min:"0",value:t.yellowa,onChange:a=>d("yellowa",a.target.value),className:"form-input",disabled:n})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs text-text-muted mb-1",children:"🟥 Rote Karten"}),e.jsx("input",{type:"number",min:"0",value:t.reda,onChange:a=>d("reda",a.target.value),className:"form-input",disabled:n})]})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("p",{className:"text-xs text-red-600 font-medium",children:"Gastteam"}),e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs text-text-muted mb-1",children:"🟨 Gelbe Karten"}),e.jsx("input",{type:"number",min:"0",value:t.yellowb,onChange:a=>d("yellowb",a.target.value),className:"form-input",disabled:n})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs text-text-muted mb-1",children:"🟥 Rote Karten"}),e.jsx("input",{type:"number",min:"0",value:t.redb,onChange:a=>d("redb",a.target.value),className:"form-input",disabled:n})]})]})]})]})]}),e.jsxs("div",{className:"border-t pt-4",children:[e.jsx("h4",{className:"text-sm font-medium text-text-primary mb-3",children:"⭐ Spieler des Spiels"}),e.jsxs("div",{className:"mb-3",children:[e.jsx("label",{className:"block text-xs text-text-muted mb-2",children:"Team Filter:"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{type:"button",onClick:()=>d("motmTeamFilter","all"),className:`px-3 py-1 rounded-lg text-xs font-medium transition-colors ${t.motmTeamFilter==="all"?"bg-gray-600 text-white":"bg-gray-200 text-gray-700 hover:bg-gray-300"}`,disabled:n,children:"Alle"}),e.jsx("button",{type:"button",onClick:()=>d("motmTeamFilter","AEK"),className:`px-3 py-1 rounded-lg text-xs font-medium transition-colors ${t.motmTeamFilter==="AEK"?"bg-blue-600 text-white":"bg-blue-100 text-blue-700 hover:bg-blue-200"}`,disabled:n,children:"AEK"}),e.jsx("button",{type:"button",onClick:()=>d("motmTeamFilter","Real"),className:`px-3 py-1 rounded-lg text-xs font-medium transition-colors ${t.motmTeamFilter==="Real"?"bg-red-600 text-white":"bg-red-100 text-red-700 hover:bg-red-200"}`,disabled:n,children:"Real"})]})]}),e.jsxs("select",{value:t.manofthematch,onChange:a=>d("manofthematch",a.target.value),className:"form-input",disabled:n,children:[e.jsx("option",{value:"",children:"Keinen Spieler auswählen"}),y().map(a=>e.jsxs("option",{value:a.name,children:[a.name," (",a.team," - ",a.position,")"]},a.id))]}),!v||v.length===0&&e.jsx("p",{className:"text-xs text-text-muted mt-1",children:"Keine Spieler verfügbar. Bitte fügen Sie erst Spieler hinzu."})]}),e.jsxs("div",{className:"border-t pt-4",children:[e.jsx("h4",{className:"text-sm font-medium text-text-primary mb-3",children:"💰 Preisgelder (automatisch berechnet)"}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text-primary mb-2",children:"Preisgeld AEK (€)"}),e.jsx("input",{type:"number",value:t.prizeaek,className:"form-input bg-gray-100",placeholder:"Automatisch berechnet",disabled:!0,readOnly:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text-primary mb-2",children:"Preisgeld Real (€)"}),e.jsx("input",{type:"number",value:t.prizereal,className:"form-input bg-gray-100",placeholder:"Automatisch berechnet",disabled:!0,readOnly:!0})]})]}),e.jsx("p",{className:"text-xs text-text-muted mt-2",children:"Basierend auf Ergebnis und Karten: Gewinner 1M€ - (Verlierer-Tore × 50k€) - (Karten × 20k€/50k€)"})]}),e.jsxs("div",{className:"flex gap-3 pt-4",children:[e.jsx("button",{type:"button",onClick:()=>s(!1),className:"flex-1 px-4 py-2 border border-border-light rounded-lg text-text-secondary hover:bg-bg-tertiary transition-colors",disabled:n,children:"Abbrechen"}),e.jsx("button",{type:"submit",disabled:!p||n,className:"flex-1 btn-primary disabled:opacity-50 disabled:cursor-not-allowed",children:n?e.jsxs("div",{className:"flex items-center justify-center",children:[e.jsx("div",{className:"spinner w-4 h-4 mr-2"}),"Speichern..."]}):"Speichern"})]})]})]})})}),e.jsx("div",{className:"mt-6 modern-card bg-blue-50 border-blue-200",children:e.jsxs("div",{className:"flex items-start",children:[e.jsx("div",{className:"text-blue-600 mr-3",children:e.jsx("i",{className:"fas fa-info-circle"})}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold text-blue-800 mb-1",children:"Hinweis"}),e.jsx("p",{className:"text-blue-700 text-sm",children:"Nach dem Hinzufügen können Sie das Spiel in der Spiele-Übersicht einsehen und bearbeiten."})]})]})})]})}const M=[{value:"AEK",label:"AEK Athen",color:"blue",icon:"🔵"},{value:"Real",label:"Real Madrid",color:"red",icon:"🔴"},{value:"Ehemalige",label:"Ehemalige",color:"gray",icon:"⚫"}],F=v=>{const i=M.find(s=>s.value===v);return i?`${i.icon} ${i.label}`:v};function H(){const{data:v}=K("players","*"),[i,s]=E.useState(!1),[t,c]=E.useState(""),[n,x]=E.useState({player_id:"",type:"",reason:"",customDuration:1}),[b,f]=E.useState(!1),d=(r,N)=>{x(j=>({...j,[r]:N})),r==="team"&&x(j=>({...j,player_id:""}))},l=()=>!v||!t?[]:v.filter(r=>r.team===t),p=async r=>{var N;r.preventDefault(),f(!0);try{const j=v==null?void 0:v.find(h=>h.id===parseInt(n.player_id)),S=R.find(h=>h.value===n.type);if(!j)throw new Error("Spieler nicht gefunden");if(!S)throw new Error("Sperrart nicht gefunden");const a=(N=(await g.select("bans","*",{eq:{player_id:j.id}})).data)==null?void 0:N.find(h=>(h.matchesserved||0)<(h.totalgames||0));if(a)throw new Error(`Spieler "${j.name}" ist bereits gesperrt (${a.totalgames-a.matchesserved} Spiele verbleibend)`);const u=S.fixedDuration?S.duration:n.customDuration,m=await g.insert("bans",{player_id:j.id,team:j.team,type:S.value,totalgames:u,matchesserved:0,reason:n.reason||S.value});if(m.error)throw new Error(`Ban insert failed: ${m.error.message}`);x({player_id:"",type:"",reason:"",customDuration:1}),c(""),s(!1),A.success(`Sperre für "${j.name}" erfolgreich hinzugefügt!`)}catch(j){console.error("Ban submission error:",j),A.error(j.message||"Fehler beim Hinzufügen der Sperre")}finally{f(!1)}},w=t&&n.player_id&&n.type,y=R.find(r=>r.value===n.type);return e.jsxs("div",{className:"p-4",children:[e.jsxs("div",{className:"mb-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-text-primary mb-2",children:"Neue Sperre hinzufügen"}),e.jsx("p",{className:"text-text-muted text-sm",children:"Erstellen Sie eine neue Spielersperre in der Datenbank."})]}),e.jsx("div",{className:"modern-card",children:e.jsxs("div",{className:"text-center py-8",children:[e.jsx("div",{className:"text-4xl mb-4",children:"🚫"}),e.jsx("h4",{className:"text-lg font-medium text-text-primary mb-2",children:"Sperre hinzufügen"}),e.jsx("p",{className:"text-text-muted mb-6",children:"Klicken Sie auf den Button, um eine neue Spielersperre zu erfassen."}),e.jsxs("button",{onClick:()=>s(!0),className:"btn-primary",children:[e.jsx("i",{className:"fas fa-plus mr-2"}),"Neue Sperre erfassen"]})]})}),i&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-[60] p-4",children:e.jsx("div",{className:"bg-bg-secondary rounded-lg max-w-md w-full modal-content",children:e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsx("h3",{className:"text-xl font-semibold text-text-primary",children:"Neue Sperre"}),e.jsx("button",{onClick:()=>s(!1),className:"text-text-muted hover:text-text-primary text-2xl",disabled:b,children:"×"})]}),e.jsxs("form",{onSubmit:p,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text-primary mb-2",children:"Team *"}),e.jsxs("select",{value:t,onChange:r=>{c(r.target.value),x(N=>({...N,player_id:""}))},className:"form-input",required:!0,disabled:b,children:[e.jsx("option",{value:"",children:"Team wählen"}),M.filter(r=>r.value!=="Ehemalige").map(r=>e.jsx("option",{value:r.value,children:F(r.value)},r.value))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text-primary mb-2",children:"Spieler *"}),e.jsxs("select",{value:n.player_id,onChange:r=>d("player_id",r.target.value),className:"form-input",required:!0,disabled:b||!t,children:[e.jsx("option",{value:"",children:t?"Spieler wählen":"Bitte zuerst Team wählen"}),l().map(r=>e.jsxs("option",{value:r.id,children:[r.name," (",r.position,")"]},r.id))]}),t&&l().length===0&&e.jsx("p",{className:"text-xs text-text-muted mt-1",children:"Keine Spieler im gewählten Team verfügbar."})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text-primary mb-2",children:"Sperrart *"}),e.jsxs("select",{value:n.type,onChange:r=>d("type",r.target.value),className:"form-input",required:!0,disabled:b,children:[e.jsx("option",{value:"",children:"Sperrart wählen"}),R.map(r=>e.jsxs("option",{value:r.value,children:[r.icon," ",r.label,r.fixedDuration?` (${r.duration} Spiel${r.duration!==1?"e":""})`:` (1-${r.maxDuration} Spiele)`]},r.value))]})]}),y&&!y.fixedDuration&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text-primary mb-2",children:"Anzahl Spiele *"}),e.jsx("select",{value:n.customDuration,onChange:r=>d("customDuration",parseInt(r.target.value)),className:"form-input",required:!0,disabled:b,children:Array.from({length:y.maxDuration},(r,N)=>N+1).map(r=>e.jsxs("option",{value:r,children:[r," Spiel",r!==1?"e":""]},r))}),e.jsxs("p",{className:"text-xs text-text-muted mt-1",children:["Wählen Sie zwischen ",y.minDuration," und ",y.maxDuration," Spielen"]})]}),y&&y.fixedDuration&&e.jsx("div",{className:"p-3 bg-blue-50 rounded-lg border border-blue-200",children:e.jsxs("p",{className:"text-sm text-blue-800",children:[e.jsx("i",{className:"fas fa-info-circle mr-2"}),"Gelb-Rote Karten haben immer eine feste Sperre von 1 Spiel."]})}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text-primary mb-2",children:"Zusätzlicher Grund (optional)"}),e.jsx("input",{type:"text",value:n.reason,onChange:r=>d("reason",r.target.value),className:"form-input",placeholder:"Weitere Details zur Sperre...",disabled:b})]}),e.jsxs("div",{className:"flex gap-3 pt-4",children:[e.jsx("button",{type:"button",onClick:()=>s(!1),className:"flex-1 px-4 py-2 border border-border-light rounded-lg text-text-secondary hover:bg-bg-tertiary transition-colors",disabled:b,children:"Abbrechen"}),e.jsx("button",{type:"submit",disabled:!w||b||!v||v.length===0,className:"flex-1 btn-primary disabled:opacity-50 disabled:cursor-not-allowed",children:b?e.jsxs("div",{className:"flex items-center justify-center",children:[e.jsx("div",{className:"spinner w-4 h-4 mr-2"}),"Speichern..."]}):"Speichern"})]})]})]})})}),e.jsxs("div",{className:"mt-6 modern-card",children:[e.jsx("h4",{className:"font-semibold text-text-primary mb-3",children:"Verfügbare Sperrarten"}),e.jsx("div",{className:"space-y-2",children:R.map(r=>e.jsxs("div",{className:"flex justify-between items-center p-3 bg-bg-secondary rounded-lg",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx("span",{className:"text-xl mr-2",children:r.icon}),e.jsx("span",{className:"font-medium text-text-primary",children:r.label})]}),e.jsx("span",{className:"text-sm text-text-muted",children:r.fixedDuration?`${r.duration} Spiel${r.duration!==1?"e":""} (fest)`:`1-${r.maxDuration} Spiele (variabel)`})]},r.value))})]}),e.jsx("div",{className:"mt-6 modern-card bg-yellow-50 border-yellow-200",children:e.jsxs("div",{className:"flex items-start",children:[e.jsx("div",{className:"text-yellow-600 mr-3",children:e.jsx("i",{className:"fas fa-info-circle"})}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold text-yellow-800 mb-1",children:"Hinweis"}),e.jsx("p",{className:"text-yellow-700 text-sm",children:"Nach dem Hinzufügen können Sie die Sperre in der Sperren-Übersicht einsehen und verwalten."})]})]})})]})}const L=[{value:"TH",label:"Torwart (TH)"},{value:"IV",label:"Innenverteidiger (IV)"},{value:"AV",label:"Außenverteidiger (AV)"},{value:"ZM",label:"Zentrales Mittelfeld (ZM)"},{value:"OM",label:"Offensives Mittelfeld (OM)"},{value:"ST",label:"Stürmer (ST)"}];function W(){const[v,i]=E.useState(!1),[s,t]=E.useState({name:"",team:"",position:"",goals:0,value:0}),[c,n]=E.useState(!1),x=(d,l)=>{t(p=>({...p,[d]:l}))},b=async d=>{d.preventDefault(),n(!0);try{const l=await g.select("players","*",{eq:{name:s.name.trim(),team:s.team.trim()}});if(l.data&&l.data.length>0)throw new Error(`Spieler "${s.name}" existiert bereits im Team "${s.team}"`);const p=await g.insert("players",{name:s.name.trim(),team:s.team.trim(),position:s.position.trim().toUpperCase(),goals:parseInt(s.goals)||0,value:parseFloat(s.value)||0});if(p.error)throw new Error(`Player insert failed: ${p.error.message}`);t({name:"",team:"",position:"",goals:0,value:0}),i(!1),A.success(`Spieler "${s.name}" erfolgreich hinzugefügt!`)}catch(l){console.error("Player submission error:",l),A.error(l.message||"Fehler beim Hinzufügen des Spielers")}finally{n(!1)}},f=s.name&&s.team&&s.position&&s.value!=="";return e.jsxs("div",{className:"p-4",children:[e.jsxs("div",{className:"mb-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-text-primary mb-2",children:"Neuen Spieler hinzufügen"}),e.jsx("p",{className:"text-text-muted text-sm",children:"Fügen Sie einen neuen Spieler zur Datenbank hinzu."})]}),e.jsx("div",{className:"modern-card",children:e.jsxs("div",{className:"text-center py-8",children:[e.jsx("div",{className:"text-4xl mb-4",children:"👤"}),e.jsxs("h4",{className:"text-lg font-medium text-text-primary mb-2",children:[e.jsx("i",{className:"fas fa-user-plus mr-2"}),"Spieler hinzufügen"]}),e.jsx("p",{className:"text-text-muted mb-6",children:"Klicken Sie auf den Button, um einen neuen Spieler zu erfassen."}),e.jsxs("button",{onClick:()=>i(!0),className:"btn-primary",children:[e.jsx("i",{className:"fas fa-plus mr-2"}),"Neuen Spieler erfassen"]})]})}),v&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-[60] p-4",children:e.jsx("div",{className:"bg-bg-secondary rounded-lg max-w-md w-full modal-content",children:e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsx("h3",{className:"text-xl font-semibold text-text-primary",children:"Neuer Spieler"}),e.jsx("button",{onClick:()=>i(!1),className:"text-text-muted hover:text-text-primary text-2xl",disabled:c,children:"×"})]}),e.jsxs("form",{onSubmit:b,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text-primary mb-2",children:"Spielername *"}),e.jsx("input",{type:"text",value:s.name,onChange:d=>x("name",d.target.value),className:"form-input",placeholder:"z.B. Max Mustermann",required:!0,disabled:c})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text-primary mb-2",children:"Team *"}),e.jsxs("select",{value:s.team,onChange:d=>x("team",d.target.value),className:"form-input",required:!0,disabled:c,children:[e.jsx("option",{value:"",children:"Team wählen"}),M.map(d=>e.jsx("option",{value:d.value,children:F(d.value)},d.value))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text-primary mb-2",children:"Position *"}),e.jsxs("select",{value:s.position,onChange:d=>x("position",d.target.value),className:"form-input",required:!0,disabled:c,children:[e.jsx("option",{value:"",children:"Position wählen"}),L.map(d=>e.jsx("option",{value:d.value,children:d.label},d.value))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text-primary mb-2",children:"Marktwert (Millionen €) *"}),e.jsx("input",{type:"number",min:"0",step:"0.1",value:s.value,onChange:d=>x("value",d.target.value),className:"form-input",placeholder:"0.0",disabled:c}),e.jsx("p",{className:"text-xs text-text-muted mt-1",children:"Marktwert in Millionen Euro (z.B. 1.5 für 1.5M €)"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text-primary mb-2",children:"Anzahl Tore"}),e.jsx("input",{type:"number",min:"0",value:s.goals,onChange:d=>x("goals",d.target.value),className:"form-input",placeholder:"0",disabled:c})]}),e.jsxs("div",{className:"flex gap-3 pt-4",children:[e.jsx("button",{type:"button",onClick:()=>i(!1),className:"flex-1 px-4 py-2 border border-border-light rounded-lg text-text-secondary hover:bg-bg-tertiary transition-colors",disabled:c,children:"Abbrechen"}),e.jsx("button",{type:"submit",disabled:!f||c,className:"flex-1 btn-primary disabled:opacity-50 disabled:cursor-not-allowed",children:c?e.jsxs("div",{className:"flex items-center justify-center",children:[e.jsx("div",{className:"spinner w-4 h-4 mr-2"}),"Speichern..."]}):"Speichern"})]})]})]})})}),e.jsxs("div",{className:"mt-6 modern-card",children:[e.jsx("h4",{className:"font-semibold text-text-primary mb-3",children:"Verfügbare Teams"}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-2",children:M.map(d=>e.jsxs("div",{className:"p-3 bg-bg-secondary rounded-lg text-center",children:[e.jsx("span",{className:`font-medium ${d.color==="blue"?"text-blue-600":d.color==="red"?"text-red-600":"text-gray-600"}`,children:F(d.value)}),e.jsxs("div",{className:"text-xs text-text-muted mt-1",children:["(",d.value,")"]})]},d.value))})]}),e.jsxs("div",{className:"mt-6 modern-card",children:[e.jsx("h4",{className:"font-semibold text-text-primary mb-3",children:"Verfügbare Positionen"}),e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-2",children:L.map(d=>e.jsx("div",{className:"p-3 bg-bg-secondary rounded-lg text-center",children:e.jsx("span",{className:"font-medium text-text-primary text-sm",children:d.label})},d.value))})]}),e.jsx("div",{className:"mt-6 modern-card bg-green-50 border-green-200",children:e.jsxs("div",{className:"flex items-start",children:[e.jsx("div",{className:"text-green-600 mr-3",children:e.jsx("i",{className:"fas fa-info-circle"})}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold text-green-800 mb-1",children:"Hinweis"}),e.jsx("p",{className:"text-green-700 text-sm",children:"Nach dem Hinzufügen können Sie den Spieler in der Kader-Übersicht einsehen und verwalten."})]})]})})]})}const q=[{value:"Preisgeld",label:"Preisgeld",icon:"🏆"},{value:"Strafe",label:"Strafe",icon:"📉"},{value:"Spielerkauf",label:"Spielerkauf",icon:"👤"},{value:"Spielerverkauf",label:"Spielerverkauf",icon:"💰"},{value:"Echtgeld-Ausgleich",label:"Echtgeld-Ausgleich",icon:"💳"},{value:"SdS Bonus",label:"Spieler des Spiels Bonus",icon:"⭐"},{value:"Sonstiges",label:"Sonstiges",icon:"📈"}];function Z(){const[v,i]=E.useState(!1),[s,t]=E.useState({team:"",type:"",amount:"",info:"",date:new Date().toISOString().split("T")[0]}),[c,n]=E.useState(!1),x=(l,p)=>{t(w=>({...w,[l]:p}))},b=async l=>{l.preventDefault(),n(!0);try{const p=parseFloat(s.amount),w=await g.insert("transactions",{date:s.date,type:s.type.trim(),team:s.team.trim(),amount:p,info:s.info.trim(),match_id:null});if(w.error)throw new Error(`Transaction insert failed: ${w.error.message}`);await f(s.team.trim(),s.type.trim(),p),t({team:"",type:"",amount:"",info:"",date:new Date().toISOString().split("T")[0]}),i(!1),A.success("Transaktion erfolgreich hinzugefügt!")}catch(p){console.error("Transaction submission error:",p),A.error(p.message||"Fehler beim Hinzufügen der Transaktion")}finally{n(!1)}},f=async(l,p,w)=>{try{const y=await g.select("finances","*",{eq:{team:l}});let r=y.data&&y.data.length>0?y.data[0]:{team:l,balance:0,debt:0},N={};if(p==="Echtgeld-Ausgleich")N.debt=(r.debt||0)+w;else{let j=(r.balance||0)+w;j<0&&(j=0),N.balance=j}r.id?await g.update("finances",N,r.id):await g.insert("finances",{team:l,balance:N.balance||0,debt:N.debt||0})}catch(y){console.warn("Failed to update finances:",y)}},d=s.team&&s.type&&s.amount&&s.date;return e.jsxs("div",{className:"p-4",children:[e.jsxs("div",{className:"mb-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-text-primary mb-2",children:"Neue Transaktion hinzufügen"}),e.jsx("p",{className:"text-text-muted text-sm",children:"Erfassen Sie eine neue finanzielle Transaktion."})]}),e.jsx("div",{className:"modern-card",children:e.jsxs("div",{className:"text-center py-8",children:[e.jsx("div",{className:"text-4xl mb-4",children:"💰"}),e.jsx("h4",{className:"text-lg font-medium text-text-primary mb-2",children:"Transaktion hinzufügen"}),e.jsx("p",{className:"text-text-muted mb-6",children:"Klicken Sie auf den Button, um eine neue Transaktion zu erfassen."}),e.jsxs("button",{onClick:()=>i(!0),className:"btn-primary",children:[e.jsx("i",{className:"fas fa-plus mr-2"}),"Neue Transaktion erfassen"]})]})}),v&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-[60] p-4",children:e.jsx("div",{className:"bg-bg-secondary rounded-lg max-w-md w-full modal-content",children:e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsx("h3",{className:"text-xl font-semibold text-text-primary",children:"Neue Transaktion"}),e.jsx("button",{onClick:()=>i(!1),className:"text-text-muted hover:text-text-primary text-2xl",disabled:c,children:"×"})]}),e.jsxs("form",{onSubmit:b,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text-primary mb-2",children:"Team *"}),e.jsxs("select",{value:s.team,onChange:l=>x("team",l.target.value),className:"form-input",required:!0,disabled:c,children:[e.jsx("option",{value:"",children:"Team wählen"}),M.filter(l=>l.value!=="Ehemalige").map(l=>e.jsx("option",{value:l.value,children:F(l.value)},l.value))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text-primary mb-2",children:"Transaktionsart *"}),e.jsxs("select",{value:s.type,onChange:l=>x("type",l.target.value),className:"form-input",required:!0,disabled:c,children:[e.jsx("option",{value:"",children:"Typ wählen"}),q.map(l=>e.jsxs("option",{value:l.value,children:[l.icon," ",l.label]},l.value))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text-primary mb-2",children:"Betrag (€) *"}),e.jsx("input",{type:"number",step:"0.01",value:s.amount,onChange:l=>x("amount",l.target.value),className:"form-input",placeholder:"0.00",required:!0,disabled:c}),e.jsx("p",{className:"text-xs text-text-muted mt-1",children:"Negative Werte für Ausgaben, positive für Einnahmen"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text-primary mb-2",children:"Beschreibung"}),e.jsx("input",{type:"text",value:s.info,onChange:l=>x("info",l.target.value),className:"form-input",placeholder:"Zusätzliche Informationen...",disabled:c})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text-primary mb-2",children:"Datum *"}),e.jsx("input",{type:"date",value:s.date,onChange:l=>x("date",l.target.value),className:"form-input",required:!0,disabled:c})]}),e.jsxs("div",{className:"flex gap-3 pt-4",children:[e.jsx("button",{type:"button",onClick:()=>i(!1),className:"flex-1 px-4 py-2 border border-border-light rounded-lg text-text-secondary hover:bg-bg-tertiary transition-colors",disabled:c,children:"Abbrechen"}),e.jsx("button",{type:"submit",disabled:!d||c,className:"flex-1 btn-primary disabled:opacity-50 disabled:cursor-not-allowed",children:c?e.jsxs("div",{className:"flex items-center justify-center",children:[e.jsx("div",{className:"spinner w-4 h-4 mr-2"}),"Speichern..."]}):"Speichern"})]})]})]})})}),e.jsxs("div",{className:"mt-6 modern-card",children:[e.jsx("h4",{className:"font-semibold text-text-primary mb-3",children:"Transaktionsarten"}),e.jsx("div",{className:"grid grid-cols-2 gap-2",children:q.map(l=>e.jsxs("div",{className:"p-3 bg-bg-secondary rounded-lg text-center",children:[e.jsx("div",{className:"text-2xl mb-2",children:l.icon}),e.jsx("span",{className:"font-medium text-text-primary",children:l.label})]},l.value))})]}),e.jsxs("div",{className:"mt-6 modern-card",children:[e.jsx("h4",{className:"font-semibold text-text-primary mb-3",children:"Verfügbare Teams"}),e.jsx("div",{className:"grid grid-cols-2 gap-2",children:M.filter(l=>l.value!=="Ehemalige").map(l=>e.jsxs("div",{className:"p-3 bg-bg-secondary rounded-lg text-center",children:[e.jsx("span",{className:`font-medium ${l.color==="blue"?"text-blue-600":"text-red-600"}`,children:F(l.value)}),e.jsxs("div",{className:"text-xs text-text-muted mt-1",children:["(",l.value,")"]})]},l.value))})]}),e.jsx("div",{className:"mt-6 modern-card bg-blue-50 border-blue-200",children:e.jsxs("div",{className:"flex items-start",children:[e.jsx("div",{className:"text-blue-600 mr-3",children:e.jsx("i",{className:"fas fa-info-circle"})}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold text-blue-800 mb-1",children:"Hinweis"}),e.jsx("p",{className:"text-blue-700 text-sm",children:"Nach dem Hinzufügen können Sie die Transaktion in der Finanzen-Übersicht einsehen."})]})]})})]})}function Y(){const[v,i]=E.useState("players"),[s,t]=E.useState(!1),{data:c,refetch:n}=K("players","*"),{data:x,refetch:b}=K("matches","*"),{data:f,refetch:d}=K("bans","*"),{data:l,refetch:p}=K("transactions","*"),{remove:w}=$("players"),{remove:y}=$("bans"),{remove:r}=$("transactions"),N=[{id:"players",label:"Spieler löschen",icon:"fas fa-users"},{id:"matches",label:"Spiele löschen",icon:"fas fa-futbol"},{id:"bans",label:"Sperren löschen",icon:"fas fa-ban"},{id:"transactions",label:"Transaktionen löschen",icon:"fas fa-euro-sign"}],j=async o=>{if(confirm(`Sind Sie sicher, dass Sie ${o.name} löschen möchten?`)){t(!0);try{await w(o.id),A.success(`Spieler ${o.name} erfolgreich gelöscht`),n()}catch(T){A.error("Fehler beim Löschen des Spielers: "+T.message)}finally{t(!1)}}},S=async o=>{if(confirm(`Sind Sie sicher, dass Sie das Spiel vom ${new Date(o.date).toLocaleDateString("de-DE")} löschen möchten?`)){t(!0);try{const{deleteMatch:T}=await V(async()=>{const{deleteMatch:z}=await import("./matches-Bz0wv9ua.js");return{deleteMatch:z}},__vite__mapDeps([0,1]));await T(o.id),A.success("Spiel erfolgreich gelöscht"),b()}catch(T){A.error("Fehler beim Löschen des Spiels: "+T.message)}finally{t(!1)}}},D=async o=>{if(confirm(`Sind Sie sicher, dass Sie die Sperre für ${o.player_name} löschen möchten?`)){t(!0);try{await y(o.id),A.success(`Sperre für ${o.player_name} erfolgreich gelöscht`),d()}catch(T){A.error("Fehler beim Löschen der Sperre: "+T.message)}finally{t(!1)}}},a=async o=>{if(confirm(`Sind Sie sicher, dass Sie die Transaktion "${o.type}" löschen möchten?`)){t(!0);try{await r(o.id),A.success("Transaktion erfolgreich gelöscht"),p()}catch(T){A.error("Fehler beim Löschen der Transaktion: "+T.message)}finally{t(!1)}}},u=o=>{const T=M.find(z=>z.value===o);return T?T.icon:"⚫"},m=()=>!c||c.length===0?e.jsx("p",{className:"text-text-muted text-center py-4",children:"Keine Spieler vorhanden"}):e.jsx("div",{className:"space-y-2",children:c.map(o=>e.jsxs("div",{className:"flex items-center justify-between p-3 bg-bg-tertiary rounded-lg",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("span",{className:"text-lg",children:u(o.team)}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-text-primary",children:o.name}),e.jsxs("p",{className:"text-sm text-text-muted",children:[o.team," • ",o.position]})]})]}),e.jsxs("button",{onClick:()=>j(o),disabled:s,className:"btn-secondary btn-sm text-accent-red hover:bg-red-50 disabled:opacity-50",children:[e.jsx("i",{className:"fas fa-trash mr-1"}),"Löschen"]})]},o.id))}),h=()=>!x||x.length===0?e.jsx("p",{className:"text-text-muted text-center py-4",children:"Keine Spiele vorhanden"}):e.jsx("div",{className:"space-y-2",children:x.map(o=>e.jsxs("div",{className:"flex items-center justify-between p-3 bg-bg-tertiary rounded-lg",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-text-primary",children:new Date(o.date).toLocaleDateString("de-DE")}),e.jsxs("p",{className:"text-sm text-text-muted",children:["AEK ",o.prizeaek," - ",o.prizereal," Real"]})]}),e.jsxs("button",{onClick:()=>S(o),disabled:s,className:"btn-secondary btn-sm text-accent-red hover:bg-red-50 disabled:opacity-50",children:[e.jsx("i",{className:"fas fa-trash mr-1"}),"Löschen"]})]},o.id))}),k=()=>!f||f.length===0?e.jsx("p",{className:"text-text-muted text-center py-4",children:"Keine Sperren vorhanden"}):e.jsx("div",{className:"space-y-2",children:f.map(o=>e.jsxs("div",{className:"flex items-center justify-between p-3 bg-bg-tertiary rounded-lg",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("span",{className:"text-lg",children:u(o.team)}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-text-primary",children:o.player_name}),e.jsxs("p",{className:"text-sm text-text-muted",children:[o.type," • ",o.duration," Spiele"]})]})]}),e.jsxs("button",{onClick:()=>D(o),disabled:s,className:"btn-secondary btn-sm text-accent-red hover:bg-red-50 disabled:opacity-50",children:[e.jsx("i",{className:"fas fa-trash mr-1"}),"Löschen"]})]},o.id))}),B=()=>!l||l.length===0?e.jsx("p",{className:"text-text-muted text-center py-4",children:"Keine Transaktionen vorhanden"}):e.jsx("div",{className:"space-y-2",children:l.map(o=>e.jsxs("div",{className:"flex items-center justify-between p-3 bg-bg-tertiary rounded-lg",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("span",{className:"text-lg",children:u(o.team)}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-text-primary",children:o.type}),e.jsxs("p",{className:"text-sm text-text-muted",children:[o.amount>0?"+":"",o.amount,"M €",o.date&&` • ${new Date(o.date).toLocaleDateString("de-DE")}`]})]})]}),e.jsxs("button",{onClick:()=>a(o),disabled:s,className:"btn-secondary btn-sm text-accent-red hover:bg-red-50 disabled:opacity-50",children:[e.jsx("i",{className:"fas fa-trash mr-1"}),"Löschen"]})]},o.id))}),C=()=>{switch(v){case"players":return m();case"matches":return h();case"bans":return k();case"transactions":return B();default:return m()}};return e.jsxs("div",{className:"p-4",children:[e.jsxs("div",{className:"mb-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-text-primary mb-2",children:"Daten löschen"}),e.jsx("p",{className:"text-text-muted text-sm",children:"Verwalten Sie die Löschung von Spielern, Spielen, Sperren und Transaktionen."})]}),e.jsx("div",{className:"grid grid-cols-2 gap-2 mb-6",children:N.map(o=>e.jsxs("button",{onClick:()=>i(o.id),className:`p-3 rounded-lg text-sm font-medium transition-colors ${v===o.id?"bg-accent-red text-white":"bg-bg-tertiary text-text-secondary hover:text-text-primary hover:bg-bg-hover"}`,children:[e.jsx("i",{className:`${o.icon} mr-2`}),o.label]},o.id))}),e.jsxs("div",{className:"modern-card",children:[s&&e.jsx(O,{message:"Lösche..."}),!s&&C()]}),e.jsx("div",{className:"mt-6 modern-card bg-red-50 border-red-200",children:e.jsxs("div",{className:"flex items-start",children:[e.jsx("div",{className:"text-red-600 mr-3",children:e.jsx("i",{className:"fas fa-exclamation-triangle"})}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold text-red-800 mb-1",children:"Achtung"}),e.jsx("p",{className:"text-red-700 text-sm",children:"Das Löschen von Daten ist permanent und kann nicht rückgängig gemacht werden. Bitte überprüfen Sie Ihre Auswahl sorgfältig, bevor Sie fortfahren."})]})]})})]})}function X({onLogout:v}){const[i,s]=E.useState("matches"),t=[{id:"matches",label:"Spiele hinzufügen",icon:"fas fa-futbol"},{id:"bans",label:"Sperren hinzufügen",icon:"fas fa-ban"},{id:"players",label:"Spieler hinzufügen",icon:"fas fa-users"},{id:"transactions",label:"Transaktionen hinzufügen",icon:"fas fa-euro-sign"},{id:"delete",label:"Daten löschen",icon:"fas fa-trash"}],c=()=>{switch(i){case"matches":return e.jsx(I,{});case"bans":return e.jsx(H,{});case"players":return e.jsx(W,{});case"transactions":return e.jsx(Z,{});case"delete":return e.jsx(Y,{});default:return e.jsx(I,{})}};return e.jsxs("div",{className:"flex flex-col h-full",children:[e.jsxs("div",{className:"p-4 bg-bg-secondary border-b border-border-light flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-semibold text-text-primary mb-1",children:"Verwaltung"}),e.jsx("p",{className:"text-text-muted text-sm",children:"Hinzufügen und verwalten von Daten"})]}),e.jsxs("button",{onClick:v,className:"flex items-center px-3 py-2 bg-accent-red text-white rounded-lg hover:bg-red-600 transition-colors focus:outline-none focus:ring-2 focus:ring-red-500 focus:ring-opacity-50","aria-label":"Abmelden",children:[e.jsx("i",{className:"fas fa-sign-out-alt mr-2"}),e.jsx("span",{className:"text-sm",children:"Logout"})]})]}),e.jsx("div",{className:"bg-bg-secondary border-b border-border-light",children:e.jsx("div",{className:"flex overflow-x-auto",children:t.map(n=>e.jsxs("button",{onClick:()=>s(n.id),className:`flex-shrink-0 px-4 py-3 text-sm font-medium transition-colors whitespace-nowrap ${i===n.id?"text-primary-green border-b-2 border-primary-green bg-bg-primary":"text-text-secondary hover:text-text-primary hover:bg-bg-hover"}`,children:[e.jsx("i",{className:`${n.icon} mr-2`}),n.label]},n.id))})}),e.jsx("div",{className:"flex-1 overflow-y-auto",children:c()})]})}export{X as default};
