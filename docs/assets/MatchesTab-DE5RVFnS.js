import{r as u,u as S,j as e,L as O}from"./index-ChjmHnwQ.js";import{E as T}from"./EnhancedSearch-CdOnGSGS.js";function _({onNavigate:C}){const[N,k]=u.useState(new Set),[d,D]=u.useState(!1),[i,y]=u.useState(""),[p,E]=u.useState([]),h=new Date;h.setDate(h.getDate()-28);const b=h.toISOString().split("T")[0],{data:g,loading:z,error:A,refetch:F}=S("matches","*",{order:{column:"date",ascending:!1}}),{data:v,loading:K}=S("players","*"),c=(()=>{if(!g)return[];let s=p.length>0?p:g;return i?s=s.filter(l=>l.date===i):!d&&p.length===0&&(s=s.filter(l=>l.date>=b)),s})(),M=z||K,x=(s,l)=>{if(!v)return{name:l||"Unbekannt",value:0};const a=v.find(t=>t.id===s||t.name===l);return{name:(a==null?void 0:a.name)||l||"Unbekannt",value:(a==null?void 0:a.value)||0,team:(a==null?void 0:a.team)||"Unbekannt"}},L=s=>{const l=new Set(N);l.has(s)?l.delete(s):l.add(s),k(l)},R=()=>{if(!c)return[];const s={};return c.forEach(l=>{const a=l.date;s[a]||(s[a]=[]),s[a].push(l)}),Object.keys(s).sort((l,a)=>new Date(a)-new Date(l)).map(l=>({date:l,matches:s[l].sort((a,t)=>t.id-a.id)}))},$=s=>{const l=[{container:"border-blue-400 bg-blue-50 dark:bg-blue-900",header:"text-blue-800 dark:text-blue-100",accent:"blue-500"},{container:"border-green-500 bg-green-50 dark:bg-green-900",header:"text-green-800 dark:text-green-100",accent:"green-500"},{container:"border-purple-500 bg-purple-50 dark:bg-purple-900",header:"text-purple-800 dark:text-purple-100",accent:"purple-500"},{container:"border-red-500 bg-red-50 dark:bg-red-900",header:"text-red-800 dark:text-red-100",accent:"red-500"},{container:"border-yellow-500 bg-yellow-50 dark:bg-yellow-900",header:"text-yellow-800 dark:text-yellow-100",accent:"yellow-500"}];return l[s%l.length]};if(M)return e.jsx(O,{message:"Lade Spiele..."});if(A)return e.jsxs("div",{className:"text-center py-8",children:[e.jsx("div",{className:"text-accent-red mb-4",children:e.jsx("i",{className:"fas fa-exclamation-triangle text-2xl"})}),e.jsx("p",{className:"text-text-muted mb-4",children:"Fehler beim Laden der Spiele"}),e.jsx("button",{onClick:F,className:"btn-primary",children:"Erneut versuchen"})]});const f=R();return e.jsxs("div",{className:"p-4 pb-20",children:[e.jsxs("div",{className:"mb-6",children:[e.jsx("div",{className:"flex justify-between items-center mb-2",children:e.jsx("h2",{className:"text-xl font-semibold text-text-primary",children:"Spiele-Ãœbersicht"})}),e.jsxs("p",{className:"text-text-muted",children:[(c==null?void 0:c.length)||0," Spiele gefunden, gruppiert nach Datum"]})]}),e.jsx(T,{data:g||[],searchFields:["date","goalsa","goalsb","sds"],filterOptions:[{key:"period",label:"Zeitraum",options:[{value:"recent",label:"Letzte 4 Wochen"},{value:"all",label:"Alle Zeit"}],filterFn:(s,l)=>l==="recent"?s.date>=b:!0},{key:"result",label:"Ergebnis",options:[{value:"aek-win",label:"AEK Sieg"},{value:"real-win",label:"Real Sieg"},{value:"draw",label:"Unentschieden"}],filterFn:(s,l)=>{const a=s.goalsa||0,t=s.goalsb||0;return l==="aek-win"?a>t:l==="real-win"?t>a:l==="draw"?a===t:!0}}],onResults:E,placeholder:"Spiele durchsuchen..."}),e.jsxs("div",{className:"mb-6 p-4 bg-gray-50 dark:bg-gray-800 rounded-lg",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 items-start sm:items-center",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("label",{htmlFor:"dateFilter",className:"block text-sm font-medium text-text-primary mb-1",children:"Filter nach Datum:"}),e.jsx("input",{id:"dateFilter",type:"date",value:i,onChange:s=>y(s.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md text-sm focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>y(""),className:"px-3 py-2 text-sm bg-gray-500 text-white rounded-md hover:bg-gray-600 transition-colors",children:"Filter zurÃ¼cksetzen"}),e.jsx("button",{onClick:()=>D(!d),className:`px-3 py-2 text-sm rounded-md transition-colors ${d?"bg-blue-500 text-white hover:bg-blue-600":"bg-gray-200 text-gray-700 hover:bg-gray-300"}`,children:d?"Nur letzte 4 Wochen":"Alle Spiele anzeigen"})]})]}),e.jsxs("div",{className:"mt-2 text-xs text-text-muted",children:[!i&&!d&&`Zeige Spiele der letzten 4 Wochen (seit ${new Date(b).toLocaleDateString("de-DE")})`,!i&&d&&"Zeige alle Spiele",i&&`Zeige Spiele vom ${new Date(i).toLocaleDateString("de-DE")}`]})]}),f&&f.length>0?e.jsx("div",{className:"space-y-4",children:f.map((s,l)=>{const a=$(l);return e.jsxs("div",{className:`border-2 ${a.container} rounded-lg shadow-lg`,children:[e.jsx("div",{className:"p-4 border-b border-opacity-20",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:`w-3 h-3 bg-${a.accent} rounded-full mr-3 flex-shrink-0`}),e.jsxs("div",{children:[e.jsx("h3",{className:`text-lg font-bold ${a.header}`,children:new Date(s.date).toLocaleDateString("de-DE",{weekday:"long",year:"numeric",month:"long",day:"numeric"})}),e.jsxs("p",{className:`text-sm opacity-75 ${a.header}`,children:[s.matches.length," Spiel",s.matches.length!==1?"e":""]})]})]}),e.jsx("div",{className:`text-xs bg-${a.accent} text-white px-3 py-1 rounded-full font-semibold`,children:"Spieltag"})]})}),e.jsx("div",{className:"p-4 space-y-3",children:s.matches.map(t=>{const w=N.has(t.id);return e.jsxs("div",{className:"bg-white bg-opacity-50 rounded-lg border border-white border-opacity-30",children:[e.jsxs("button",{onClick:()=>L(t.id),className:"w-full p-4 flex items-center justify-between cursor-pointer hover:bg-opacity-80 transition-all duration-200 rounded-lg",children:[e.jsx("div",{className:"flex items-center space-x-4",children:e.jsxs("div",{className:"text-center",children:[e.jsxs("div",{className:"text-lg font-bold text-text-primary",children:[t.teama||"AEK"," ",t.goalsa||0," : ",t.goalsb||0," ",t.teamb||"Real"]}),t.status&&e.jsx("span",{className:`inline-block px-2 py-1 rounded text-xs font-medium mt-1 ${t.status==="finished"?"bg-primary-green/10 text-primary-green":"bg-accent-orange/10 text-accent-orange"}`,children:t.status==="finished"?"Beendet":"Laufend"})]})}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-xs text-text-muted",children:"Details"}),e.jsx("span",{className:`text-lg transition-transform duration-200 ${w?"rotate-90":""}`,children:"â–¶"})]})]}),w&&e.jsx("div",{className:"px-4 pb-4 border-t border-gray-200 bg-gray-50",children:e.jsxs("div",{className:"mt-4 grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("h4",{className:"font-semibold text-text-primary flex items-center",children:"âš½ TorschÃ¼tzen"}),e.jsxs("div",{className:"space-y-2",children:[(()=>{let n=[];try{typeof t.goalslista=="string"?n=JSON.parse(t.goalslista):Array.isArray(t.goalslista)&&(n=t.goalslista)}catch(r){console.warn("Failed to parse goalslista:",r),n=[]}return n&&n.length>0?e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-blue-600 font-medium mb-1",children:"AEK:"}),n.map((r,j)=>{const o=typeof r=="object"&&r!==null,m=o?x(r.player_id,r.player):x(null,r);return e.jsxs("div",{className:"text-sm p-2 bg-blue-50 rounded border-l-4 border-blue-400",children:[e.jsxs("div",{className:"font-medium text-blue-800",children:[m.name,o&&r.count>1&&e.jsxs("span",{className:"ml-1 text-xs bg-blue-200 px-1 rounded",children:[r.count,"x"]})]}),e.jsxs("div",{className:"text-xs text-blue-600",children:["Marktwert: ",m.value,"M â‚¬"]})]},j)})]}):e.jsx("p",{className:"text-xs text-text-muted",children:"AEK: Keine Tore"})})(),(()=>{let n=[];try{typeof t.goalslistb=="string"?n=JSON.parse(t.goalslistb):Array.isArray(t.goalslistb)&&(n=t.goalslistb)}catch(r){console.warn("Failed to parse goalslistb:",r),n=[]}return n&&n.length>0?e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-red-600 font-medium mb-1",children:"Real:"}),n.map((r,j)=>{const o=typeof r=="object"&&r!==null,m=o?x(r.player_id,r.player):x(null,r);return e.jsxs("div",{className:"text-sm p-2 bg-red-50 rounded border-l-4 border-red-400",children:[e.jsxs("div",{className:"font-medium text-red-800",children:[m.name,o&&r.count>1&&e.jsxs("span",{className:"ml-1 text-xs bg-red-200 px-1 rounded",children:[r.count,"x"]})]}),e.jsxs("div",{className:"text-xs text-red-600",children:["Marktwert: ",m.value,"M â‚¬"]})]},j)})]}):e.jsx("p",{className:"text-xs text-text-muted",children:"Real: Keine Tore"})})()]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("h4",{className:"font-semibold text-text-primary flex items-center",children:"â­ Spieler des Spiels"}),e.jsx("div",{className:"space-y-1",children:t.manofthematch?e.jsxs("div",{className:"p-2 bg-yellow-50 rounded border-l-4 border-yellow-400",children:[e.jsx("div",{className:"font-medium text-yellow-800",children:t.manofthematch}),(()=>{const n=x(t.manofthematch_player_id,t.manofthematch);return e.jsxs("div",{className:"text-xs text-yellow-600",children:["Team: ",n.team," | Marktwert: ",n.value,"M â‚¬"]})})()]}):e.jsx("p",{className:"text-xs text-text-muted",children:"Kein Spieler des Spiels ausgewÃ¤hlt"})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("h4",{className:"font-semibold text-text-primary flex items-center",children:"ðŸŸ¨ðŸŸ¥ Karten"}),e.jsxs("div",{className:"space-y-1",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-blue-600 font-medium",children:"AEK:"}),e.jsxs("p",{className:"text-sm text-text-muted",children:["ðŸŸ¨ ",t.yellowa||0," Gelb"]}),e.jsxs("p",{className:"text-sm text-text-muted",children:["ðŸŸ¥ ",t.reda||0," Rot"]})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-red-600 font-medium",children:"Real:"}),e.jsxs("p",{className:"text-sm text-text-muted",children:["ðŸŸ¨ ",t.yellowb||0," Gelb"]}),e.jsxs("p",{className:"text-sm text-text-muted",children:["ðŸŸ¥ ",t.redb||0," Rot"]})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("h4",{className:"font-semibold text-text-primary flex items-center",children:"ðŸ’° Preisgelder"}),e.jsxs("div",{className:"space-y-1",children:[e.jsxs("p",{className:"text-sm text-text-muted",children:[e.jsx("span",{className:"text-blue-600",children:"AEK:"})," ",t.prizeaek?`â‚¬${t.prizeaek}`:"â‚¬0"]}),e.jsxs("p",{className:"text-sm text-text-muted",children:[e.jsx("span",{className:"text-red-600",children:"Real:"})," ",t.prizereal?`â‚¬${t.prizereal}`:"â‚¬0"]})]})]})]})})]},t.id)})})]},s.date)})}):e.jsxs("div",{className:"text-center py-12",children:[e.jsx("div",{className:"text-text-muted mb-4",children:e.jsx("i",{className:"fas fa-futbol text-4xl opacity-50"})}),e.jsx("h3",{className:"text-lg font-medium text-text-primary mb-2",children:"Keine Spiele gefunden"}),e.jsx("p",{className:"text-text-muted",children:"Es wurden noch keine Spiele hinzugefÃ¼gt."})]}),e.jsx("div",{className:"mt-6 modern-card bg-blue-50 border-blue-200",children:e.jsxs("div",{className:"flex items-start",children:[e.jsx("div",{className:"text-blue-600 mr-3",children:e.jsx("i",{className:"fas fa-info-circle"})}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold text-blue-800 mb-1",children:"Hinweis"}),e.jsx("p",{className:"text-blue-700 text-sm",children:"Klicken Sie auf ein Spiel, um detaillierte Statistiken wie TorschÃ¼tzen, Karten und Preisgelder anzuzeigen. Neue Spiele kÃ¶nnen im Verwaltungsbereich hinzugefÃ¼gt werden."})]})]})})]})}export{_ as default};
